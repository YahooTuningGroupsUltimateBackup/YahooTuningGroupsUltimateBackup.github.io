<a href="/tuning-math">back to list</a><h1>Unison vectors with Pari/GP</h1><h3><a id=18312 href="#18312">ðŸ”—</a>Graham Breed &#x3C;gbreed@gmail.com&#x3E;</h3><span>10/27/2010 12:12:14 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>What I did last night is get a Tenney-weighted LLL reduction working<br/>with Pari/GP.  Maybe we can call this TLLL reduction.</p><p>Here&apos;s the code:</p><p>/* LLL reduction of a mapping, with Tenney weighting */<br/>maplll(mapping) = qflll(weight mapping(mapping))</p><p>/* LLL reduction of a unison vector matrix, with Tenney weighting */<br/>uvlll(uvs) = qflll(weight intervals(uvs)~)~</p><p>/* Tenney weight a mapping */<br/>weight mapping(cols)={<br/>    local(size);<br/>    size=matsize(cols);<br/>    matrix(size[1],size[2],i,j,cols[i,j]/log(prime(i))*log(2))<br/>}</p><p>/* Tenney weight a matrix of intervals */<br/>weight intervals(rows)={<br/>    local(size);<br/>    size=matsize(rows);<br/>    matrix(size[1],size[2],i,j,rows[i,j]*log(prime(j))/log(2))<br/>}</p><p>My functions echo the original qflll except that uvlll works by row<br/>instead of by column because that&apos;s how I happen to hold my unison<br/>vectors.  The example I have is, I&apos;m afraid, the 17-limit 46 note one.</p><p>Here&apos;s the code for finding the unison vectors for the 46-equal mapping:</p><p>uv46 = matkerint([46, 73, 107, 129, 159, 170, 188;0,0,0,0,0,0,0])~</p><p>The TLL-reduced basis is:</p><p>lll46 = uvlll(uv46)*uv46</p><p>As ratios, they happen to be:</p><p>91/90, 153/154, 136/135, 196/195, 594/595, 121/120</p><p>One of them&apos;s bigger than the previous reduced set.  That must be<br/>because LLL isn&apos;t strictly about finding the shortest vectors.</p><p>To work out these intervals in terms of the 46&amp;31&amp;72 Portent basis:</p><p>portent = [46, 73, 107, 129, 159, 170, 188;31, 49, 72, 87, 107, 115,<br/>127;72, 114, 167, 202, 249, 266, 294]~</p><p>lll46*portent*portent[1,]~</p><p>The result is</p><p>103, -72, 103, 72, -31, 72</p><p>I&apos;m not sure what to do with that because it gives three distinct<br/>chromatic unison vector in Portent.  The periodicity block must be<br/>tunable in Portent.  You could calculate it as a redundant<br/>46&amp;103&amp;72&amp;31 I suppose.</p><p>Because this method uses LLL reduction, it may actually be an<br/>efficient way of finding an optimal basis in mapping-space with<br/>minimal scalar badness.  That assumes my guess about simple badness<br/>being dual to complexity is true.  Minimizing scalar badness directly<br/>may be more difficult because, although it&apos;s defined by a quadratic<br/>form, it isn&apos;t the &quot;Euclidean&quot; type that LLL works with.</p><p>Note: if you want a basis in Portent with minimal scalar complexity, you can do</p><p>portent * maplll(portent)</p><p>                        Graham</p></div>