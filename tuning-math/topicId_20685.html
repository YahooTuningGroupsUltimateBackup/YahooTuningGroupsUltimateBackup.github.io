<a href="/tuning-math">back to list</a><h1>Finding the preimage of a tempered interval</h1><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/26/2012 3:58:12 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>In my last posts on this subject I introduced some ideas on how to<br/>embed the affine space A^n_R in R^(n+1). I also talked about some ways<br/>to represent affine spans by using matrices in normal form.</p><p>Although I wrote originally about affine spaces over R^n, these same<br/>principles trivially apply to Z^n-torsors, which you can embed in<br/>Z^(n+1) if you&apos;d prefer to work in modules over rings instead of<br/>vector spaces. A nice middle ground is to define everything over Q, so<br/>you get fractional monzos and vals. I&apos;ll keep using R for simplicity.</p><p>For now I&apos;m going to go with these conventions:</p><p>1) Notation - affine vals will be represented as (a b c ...|, and<br/>affine monzos as |a b c ...).</p><p>2) &quot;Augmented coordinates&quot; - the &quot;copoint&quot; (a b c ...| maps to the<br/>augmented covector &lt;a b c ... ; 1|, and likewise the point |a b c ...<br/>) maps to the augmented vector |a b c ... ; 1&gt;. Note that this<br/>convention affixes &quot;1&quot; to the end of both affine vals and affine<br/>monzos, though there&apos;s other ways you could do it.</p><p>3) Normal form for monzos - a matrix of monzos will be written with<br/>the columns as monzos, and it will be in normal form if its transpose<br/>is in column-reversed Hermite form, defined as<br/>fliplr(hermiteForm(fliplr(matrix))).</p><p>4) Normal form for vals - a matrix of vals will be written with the<br/>rows as vals, and it will be in normal form if the matrix obtained by<br/>removing the rightmost column and appending it to the left of the<br/>matrix is in Hermite form.</p><p>A useful application of all this is to find the JI preimage of some<br/>tempered interval, where the tempered interval could be the period,<br/>the generator, or something else. To do this, we&apos;ll first take<br/>advantage of the fact that matrices containing augmented vectors are<br/>also just augmented matrices in the usual linear algebra sense.</p><p>First, assume you have a mapping matrix:</p><p>[1 1 0 -3]<br/>[0 1 4 10]</p><p>And say you want to find the preimage of the tempered interval |x y&gt;,<br/>which is an element in the column space of the above matrix. Then<br/>affix the column [-x -y]&apos; to the above matrix, noting the coordinates<br/>are negated</p><p>[1 1 0 -3 ; -x]<br/>[0 1 4 10 ; -y]</p><p>So for instance, if we want the generator for the above matrix, which<br/>is |0 1&gt;, we affix [0 -1]&apos; to the mapping</p><p>[1 1 0 -3 ; 0]<br/>[0 1 4 10 ; -1]</p><p>Now, we simply take the null space of this matrix, and we get (in normal form)</p><p>[-1 13 4]<br/>[1 -10 -4]<br/>[0 0 1]<br/>[0 1 0]<br/>[1 0 0]</p><p>The column space of this matrix is the null space of the augmented<br/>mapping matrix; note the bottom row is the augmented coordinate. To<br/>interpret this as an affine subspace and get our preimage, first take<br/>the intersection of this column space and the affine subspace of<br/>R^(n+1) in which A^n is embedded (e.g. the subspace in which the<br/>augmented coordinate is 1).</p><p>The above matrix makes it easy to see that this intersection will<br/>consist of the affine span |-1 1 0 0) + k*|13 -10 0 1&gt; + l*|4 -4 1&gt;,<br/>which is indeed the preimage of |0 1&gt; given the interval we started<br/>with.</p><p>I can go deeper into why the paradigm shift from affine space<br/>embedding to ordinary augmented matrix and back produces such a nice<br/>consistent result if anyone wants more detail on that.</p><p>Additionally, it&apos;s useful to do the same process in reverse and get<br/>the left null space of a matrix in which the column vectors are<br/>monzos, which I&apos;ll talk about next. There are some random useful<br/>applications for this too, like finding the generator for a<br/>temperament which has the lowest-complexity interval in its preimage.</p><p>-Mike on a bus</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/26/2012 7:59:14 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; A useful application of all this is to find the JI preimage of some<br/>&gt; tempered interval, where the tempered interval could be the period,<br/>&gt; the generator, or something else.</p><p>This seems to have the same problem as the methods I already know about, namely that you can get fractional monzos for your answer.</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/26/2012 10:43:29 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>You only get fractional monzos if you consider the domain of the mapping to<br/>be R^n or Q^n instead of Z^n. If the nullspace matrix is in hermite form,<br/>it&apos;ll be an integer matrix by definition, you can always just consider all<br/>integral combinations of the column vectors instead of all linear<br/>combinations, and consider the lattice coset formed by the columns instead<br/>of the affine subspace spanned by them.</p><p>I&apos;m aware that fractional monzos are indeed trivially in the null space of<br/>the matrix, as would be things like irrational and even uncomputable monzos<br/>if you&apos;re working in R^n, but you can just consider integral monzos if<br/>that&apos;s all you care about. The only time I can think of when fractional<br/>monzos are truly necessary in this process is if you&apos;re trying to find the<br/>preimage of some unmapped interval in a contorted temperament.</p><p>I also think that they can be more of a feature than a bug, but that&apos;s just<br/>me.</p><p>-Mike</p><p>On May 26, 2012, at 10:59 PM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:</p><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; A useful application of all this is to find the JI preimage of some<br/>&gt; tempered interval, where the tempered interval could be the period,<br/>&gt; the generator, or something else.</p><p>This seems to have the same problem as the methods I already know about,<br/>namely that you can get fractional monzos for your answer.</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/27/2012 12:16:30 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; You only get fractional monzos if you consider the domain of the mapping to<br/>&gt; be R^n or Q^n instead of Z^n. If the nullspace matrix is in hermite form,<br/>&gt; it&apos;ll be an integer matrix by definition</p><p>The question is, how do I get the nullspace matrix to be in HNF? For example, the nullspace of</p><p>[&lt;1 1 3 3 2; 0|, &lt;0 6 -7 -2 15; -1]]</p><p>is</p><p>[[-1/6 1/6 0 0 0 1] [1/2 -5/2 0 0 1 0] [-10/3 1/3 0 1 0 0] [-25/6 7/6 1 0 0 0]]</p><p>Now what?</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/28/2012 12:34:09 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>We can represent affine lattices in the same way that we represented affine<br/>subspaces: treat lattices in A^n as lattices in A^(n+1), and then take the<br/>resulting intersection with the subspace with augmented coordinate of 1.</p><p>In our embedded representation, what this means is that you really want is<br/>the intersection of the null space with the lattice coset generated by all<br/>Z-affine combinations of |1 0 0 0 ... ;1&gt;, |0 1 0 0 ... ; 1&gt;, |0 0 1 0 ...<br/>; 1&gt;, etc. Since we&apos;re going to take the intersection afterwards, this<br/>means we can simply look at the intersection of the null space and the set<br/>all Z-linear combinations of |1 0 0 0 ... ; 0&gt;, |0 1 0 0 ... ; 0&gt;, ... , |0<br/>0 0 0 ... ; 1&gt;, of which our lattice coset will be a coset.</p><p>We can accomplish this task in two parts:<br/>1) Find any lattice with augmented vectors of integral coordinates whose<br/>spanning subspace is the null space of our matrix<br/>2) Find the saturation of the lattice.</p><p>The first step can be done by taking your null space matrix and multiplying<br/>every entry by the lowest common denominator of the entries in the matrix.</p><p>If the resulting matrix is M, then it can be written M=USV, where S is in<br/>Smith normal form. If S is nxm, then you can replace S with the first n<br/>rows of the mxm identity matrix. If this matrix is called I, then the matrix<br/>L representing the associated saturated lattice for your null space will be<br/>L=UIV.</p><p>Using your example and putting back into hermite form, we get</p><p>|-21 6 5 0 0), |-12 1 3 0 1&gt;, |-20 5 4 1 0&gt;, |-25 7 6 0 0&gt;</p><p>This is indeed the correct lattice coset representing the miracle generator.</p><p>-Mike</p><p>On May 27, 2012, at 3:16 AM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:</p><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; You only get fractional monzos if you consider the domain of the mapping<br/>to<br/>&gt; be R^n or Q^n instead of Z^n. If the nullspace matrix is in hermite form,<br/>&gt; it&apos;ll be an integer matrix by definition</p><p>The question is, how do I get the nullspace matrix to be in HNF? For<br/>example, the nullspace of</p><p>[&lt;1 1 3 3 2; 0|, &lt;0 6 -7 -2 15; -1]]</p><p>is</p><p>[[-1/6 1/6 0 0 0 1] [1/2 -5/2 0 0 1 0] [-10/3 1/3 0 1 0 0] [-25/6 7/6 1 0 0<br/>0]]</p><p>Now what?</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/28/2012 9:53:21 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; Using your example and putting back into hermite form, we get<br/>&gt;<br/>&gt; |-21 6 5 0 0), |-12 1 3 0 1&gt;, |-20 5 4 1 0&gt;, |-25 7 6 0 0&gt;</p><p>From my example, your saturation procedure gave me</p><p>[[-1 0 0 0 1 6], [-2 0 1 1 2 13], [1 1 -2 -4 -2 -6], [-3 0 2 2 4 20]]</p><p>HNF of that is</p><p>[[1 0 0 0 0 -6], [0 1 0 -2 0 2], [0 0 1 1 0 1], [0 0 0 0 1 0]]</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/28/2012 3:10:14 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On May 28, 2012, at 12:53 PM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:</p><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; Using your example and putting back into hermite form, we get<br/>&gt;<br/>&gt; |-21 6 5 0 0), |-12 1 3 0 1&gt;, |-20 5 4 1 0&gt;, |-25 7 6 0 0&gt;</p><p>From my example, your saturation procedure gave me</p><p>[[-1 0 0 0 1 6], [-2 0 1 1 2 13], [1 1 -2 -4 -2 -6], [-3 0 2 2 4 20]]</p><p>HNF of that is</p><p>[[1 0 0 0 0 -6], [0 1 0 -2 0 2], [0 0 1 1 0 1], [0 0 0 0 1 0]]</p><p>I&apos;m not getting that at all. Are you sure there&apos;s not a bug in your code?<br/>Did you multiply the matrix by 6, take the Smith form, then multiply<br/>inv(U)*I*inv(V)?</p><p>Could I see your Maple code?</p><p>-Mike</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/28/2012 10:09:27 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; I&apos;m not getting that at all. Are you sure there&apos;s not a bug in your code?<br/>&gt; Did you multiply the matrix by 6, take the Smith form, then multiply<br/>&gt; inv(U)*I*inv(V)?</p><p>Before you said U*I*V, not inv(U)*I*inv(V). But it still doesn&apos;t check your result.</p><p>&gt; Could I see your Maple code?</p><p>I&apos;m just calling LinearAlgebra[SmithForm].</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/28/2012 10:28:57 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, &quot;genewardsmith&quot; &lt;genewardsmith@...&gt; wrote:</p><p>&gt; &gt; Could I see your Maple code?<br/>&gt;<br/>&gt; I&apos;m just calling LinearAlgebra[SmithForm].</p><p>What would be far more useful than trying to debug a computation which gave the wrong result would be you showing how you got a correct result, giving each step.</p></div><h3>battaglia01 &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/28/2012 10:56:44 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Tue, May 29, 2012 at 1:09 AM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:<br/>&gt;<br/>&gt; --- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt;<br/>&gt; wrote:<br/>&gt;<br/>&gt; &gt; I&apos;m not getting that at all. Are you sure there&apos;s not a bug in your<br/>&gt; &gt; code?<br/>&gt; &gt; Did you multiply the matrix by 6, take the Smith form, then multiply<br/>&gt; &gt; inv(U)*I*inv(V)?<br/>&gt;<br/>&gt; Before you said U*I*V, not inv(U)*I*inv(V). But it still doesn&apos;t check<br/>&gt; your result.</p><p>I said</p><p>&gt; If the resulting matrix is M, then it can be written M=USV, where S is in<br/>&gt; Smith normal form.</p><p>Maple&apos;s Smith Form routine also can output variables called U and V, but they instead satisfy the equation S = UMV. So if you do LinearAlgebra[SmithForm](M, output=[&apos;U&apos;,&apos;S&apos;,&apos;V&apos;]), you need to take the inverse of U and V to do what I said. But I knew this wasn&apos;t the problem by itself because I tested this out in Maple, among other things, and I saw it didn&apos;t produce the matrix you wrote.</p><p>&gt; &gt; Could I see your Maple code?<br/>&gt;<br/>&gt; I&apos;m just calling LinearAlgebra[SmithForm].</p><p>It works for me and I can&apos;t figure out why you&apos;re getting a different result. I can&apos;t find the magic bullet to reproduce the matrix you&apos;re getting; it keeps spitting out the right answer for me. Here&apos;s what I&apos;m doing (view fixed width)</p><p>&gt; M := Matrix([[-1/6, 1/6, 0, 0, 0, 1], [1/2, -5/2, 0, 0, 1, 0], [-10/3, 1/3, 0, 1, 0, 0], [-25/6, 7/6, 1, 0, 0, 0]]);<br/>%;<br/>                              [ -1   1            ]<br/>                              [ --   -  0  0  0  1]<br/>                              [ 6    6            ]<br/>                              [                   ]<br/>                              [  1  -5            ]<br/>                              [  -  --  0  0  1  0]<br/>                              [  2  2             ]<br/>                         M := [                   ]<br/>                              [-10   1            ]<br/>                              [---   -  0  1  0  0]<br/>                              [ 3    3            ]<br/>                              [                   ]<br/>                              [-25   7            ]<br/>                              [---   -  1  0  0  0]<br/>                              [ 6    6            ]</p><p>print(??); # input placeholder<br/>&gt; M := 6*M;<br/>%;<br/>                              [ -1    1  0  0  0  6]<br/>                              [                    ]<br/>                              [  3  -15  0  0  6  0]<br/>                         M := [                    ]<br/>                              [-20    2  0  6  0  0]<br/>                              [                    ]<br/>                              [-25    7  6  0  0  0]</p><p>&gt; out := LinearAlgebra[SmithForm](M, output = [&apos;U&apos;, &apos;S&apos;, &apos;V&apos;]);<br/>%;<br/>                                                 [-1  0   0   0  1   6]<br/>                                                 [                    ]<br/>            [ 1   0   0  0]  [1  0  0  0  0  0]  [ 0  0   0   0  1   0]<br/>            [             ]  [                ]  [                    ]<br/>            [-6   1   1  1]  [0  6  0  0  0  0]  [-4  1   1   1  3  25]<br/>     out := [             ], [                ], [                    ]<br/>            [ 8  -2  -1  0]  [0  0  6  0  0  0]  [-3  0  -1  -2  3  20]<br/>            [             ]  [                ]  [                    ]<br/>            [-3   1   0  0]  [0  0  0  6  0  0]  [ 1  0   0   1  2  -3]<br/>                                                 [                    ]<br/>                                                 [ 0  0   0   0  0   1]</p><p>&gt; U := out[1];<br/>%;<br/>                                 [ 1   0   0  0]<br/>                                 [             ]<br/>                                 [-6   1   1  1]<br/>                            U := [             ]<br/>                                 [ 8  -2  -1  0]<br/>                                 [             ]<br/>                                 [-3   1   0  0]</p><p>&gt; S := out[2];<br/>%;<br/>                                [1  0  0  0  0  0]<br/>                                [                ]<br/>                                [0  6  0  0  0  0]<br/>                           S := [                ]<br/>                                [0  0  6  0  0  0]<br/>                                [                ]<br/>                                [0  0  0  6  0  0]</p><p>&gt; V := out[3];<br/>%;<br/>                              [-1  0   0   0  1   6]<br/>                              [                    ]<br/>                              [ 0  0   0   0  1   0]<br/>                              [                    ]<br/>                              [-4  1   1   1  3  25]<br/>                         V := [                    ]<br/>                              [-3  0  -1  -2  3  20]<br/>                              [                    ]<br/>                              [ 1  0   0   1  2  -3]<br/>                              [                    ]<br/>                              [ 0  0   0   0  0   1]</p><p>&gt; Iden := LinearAlgebra[IdentityMatrix](ArrayTools[Size](S)[1], ArrayTools[Size](S)[2]);<br/>%;<br/>                                 [1  0  0  0  0  0]<br/>                                 [                ]<br/>                                 [0  1  0  0  0  0]<br/>                         Iden := [                ]<br/>                                 [0  0  1  0  0  0]<br/>                                 [                ]<br/>                                 [0  0  0  1  0  0]</p><p>&gt; result := LinearAlgebra[MatrixInverse](U).Iden.LinearAlgebra[MatrixInverse](V);<br/>%;<br/>                                 [-1  1  0  0  0   6]<br/>                                 [                  ]<br/>                                 [-2  0  0  0  1  15]<br/>                       result := [                  ]<br/>                                 [-5  2  0  1  0  10]<br/>                                 [                  ]<br/>                                 [-5  2  1  0  0   5]</p><p>&gt; result := ArrayTools[FlipDimension](LinearAlgebra[HermiteForm](ArrayTools[FlipDimension](result, 2)), 2);<br/>%;<br/>                                 [-21  6  5  0  0  1]<br/>                                 [                  ]<br/>                                 [-12  1  3  0  1  0]<br/>                       result := [                  ]<br/>                                 [-20  5  4  1  0  0]<br/>                                 [                  ]<br/>                                 [-25  7  6  0  0  0]</p><p>-Mike</p></div><h3>battaglia01 &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/28/2012 11:01:19 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, &quot;battaglia01&quot; &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; print(??); # input placeholder</p><p>I dunno wtf this is, Maple just added a bunch of random crap for no reason. If I remove the outputs I get this (comments added)</p><p>&gt; M := Matrix([[-1/6, 1/6, 0, 0, 0, 1], [1/2, -5/2, 0, 0, 1, 0], [-10/3, 1/3, 0, 1, 0, 0], [-25/6, 7/6, 1, 0, 0, 0]]); #Gene&apos;s test null space matrix<br/>&gt; M := 6*M; #We&apos;re manually multiplying by the GCD here, but you can automate this<br/>&gt; out := LinearAlgebra[SmithForm](M, output = [&apos;U&apos;, &apos;S&apos;, &apos;V&apos;]); #get Smith form and save it in an expression sequence called &quot;out&quot;<br/>&gt; U := out[1];<br/>&gt; S := out[2];<br/>&gt; V := out[3];<br/>&gt; Iden := LinearAlgebra[IdentityMatrix](ArrayTools[Size](S)[1], ArrayTools[Size](S)[2]); #create an identity matrix of the same size as S<br/>&gt; result := LinearAlgebra[MatrixInverse](U).Iden.LinearAlgebra[MatrixInverse](V); #do U^-1 * Iden * V^-1<br/>&gt; result := ArrayTools[FlipDimension](LinearAlgebra[HermiteForm](ArrayTools[FlipDimension](result, 2)), 2); #put in column-reversed hermite form</p><p>                                 [-21  6  5  0  0  1]<br/>                                 [                  ]<br/>                                 [-12  1  3  0  1  0]<br/>                       result := [                  ]<br/>                                 [-20  5  4  1  0  0]<br/>                                 [                  ]<br/>                                 [-25  7  6  0  0  0]</p><p>There it is.</p><p>-Mike</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/28/2012 11:20:23 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Tue, May 29, 2012 at 2:01 AM, battaglia01 &lt;<a href="mailto:battaglia01@gmail.com">battaglia01@gmail.com</a>&gt; wrote:<br/>&gt;<br/>&gt; [insert complicated thing about Smith form here]</p><p>Actually, it seems like you already figured this out here</p><p><a href="http://tech.groups.yahoo.com/group/tuning-math/message/18021">http://tech.groups.yahoo.com/group/tuning-math/message/18021</a></p><p>Seems simple enough - if I has size nxm, and you take UIV, then IV by<br/>itself just gives you the first n rows of the mxm matrix. Then UIV<br/>just shifts the basis around. There&apos;s no difference between putting IV<br/>in hermite form vs putting UIV in hermite form.</p><p>-Mike</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/30/2012 11:24:27 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Gene wrote this on XA:<br/>&gt;<br/>&gt; The step creating the identity matrix didn&apos;t work, and anyway you don&apos;t want<br/>&gt; to create an identity matrix.</p><p>If the mapping is of size nxm, then I want to take the first n rows of<br/>the mxm identity matrix.</p><p>So this line didn&apos;t work then?</p><p>&gt; Iden := LinearAlgebra[IdentityMatrix](ArrayTools[Size](S)[1], ArrayTools[Size](S)[2]);</p><p>That works fine for me and gives [[1 0 0 0 0 0] [0 1 0 0 0 0] [0 0 1 0<br/>0 0] [0 0 0 1 0 0]]. Maybe we&apos;re using different versions of Maple or<br/>something.</p><p>Gene wrote on XA:<br/>&gt; If I understand right, the next thing should have<br/>&gt; been I * V^(-1) = [[-1 1 0 0 0 6] [-6 -2 1 1 1 -6] [1 6 0 -1 -2 8] [1 -3 0 0 1 -3]].<br/>&gt; If that&apos;s right we can go on from there.</p><p>I don&apos;t get how this is different from what I wrote above, especially<br/>if the thing you&apos;re calling &quot;I&quot; is the truncated identity matrix you<br/>just said I don&apos;t want. But yes, that&apos;s right. If the above matrix is<br/>called &quot;M&quot;, then putting that in column-reversed Hermite form yields</p><p>&gt; ArrayTools[FlipDimension](LinearAlgebra[HermiteForm](ArrayTools[FlipDimension](M, 2)), 2);<br/>                            [-21  6  5  0  0  1]<br/>                            [-12  1  3  0  1  0]<br/>                            [-20  5  4  1  0  0]<br/>                            [-25  7  6  0  0  0]</p><p>Which is the right answer.</p><p>-Mike</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>5/30/2012 11:54:55 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt;                             [-21  6  5  0  0  1]<br/>&gt;                             [-12  1  3  0  1  0]<br/>&gt;                             [-20  5  4  1  0  0]<br/>&gt;                             [-25  7  6  0  0  0]</p><p>For some reason before when I did the reverse HNF I got something different, but now I check with you! So I guess it was just a mistake on my part.</p><p>The convoluted procedure I have coded for doing this stuff gives me 15/14. If I take the monzo for that and tack 1 on the end and add the monzos for what the procedure I use for commas gives, which is [441/440, 539/540, 1375/1372], I can do the reverse HNF thing and come to the same result, everything checks. Equivalently, multiply (15/14)*13, tack on the commas and find the normal interval list. So the real question for me is still what&apos;s a good way to take your result, and find the least complex possibility?</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>5/30/2012 5:43:52 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Wed, May 30, 2012 at 2:54 PM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:<br/>&gt;<br/>&gt; --- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt;<br/>&gt; wrote:<br/>&gt;<br/>&gt; &gt; [-21 6 5 0 0 1]<br/>&gt; &gt; [-12 1 3 0 1 0]<br/>&gt; &gt; [-20 5 4 1 0 0]<br/>&gt; &gt; [-25 7 6 0 0 0]<br/>&gt;<br/>&gt; For some reason before when I did the reverse HNF I got something<br/>&gt; different, but now I check with you! So I guess it was just a mistake on my<br/>&gt; part.</p><p>Success then!</p><p>&gt; The convoluted procedure I have coded for doing this stuff gives me 15/14.<br/>&gt; If I take the monzo for that and tack 1 on the end and add the monzos for<br/>&gt; what the procedure I use for commas gives, which is [441/440, 539/540,<br/>&gt; 1375/1372], I can do the reverse HNF thing and come to the same result,<br/>&gt; everything checks.</p><p>There it is.</p><p>&gt; Equivalently, multiply (15/14)*13, tack on the commas and<br/>&gt; find the normal interval list.</p><p>Normal interval list = reverse HNF?</p><p>&gt; So the real question for me is still what&apos;s a<br/>&gt; good way to take your result, and find the least complex possibility?</p><p>Well, I was most interested in just finding the right representation<br/>for the affine space in general. It&apos;s become painfully clear to me at<br/>this point that all of these normal forms I&apos;ve put out there are<br/>pretty inadequate one way or another.</p><p>As for finding the simplest representation - seems like you guys have<br/>a whole host of ways to do that for the vector part of the matrix;<br/>just TM-reduce it or whatever (PS - I wish TM reduction were on the<br/>Wiki!).</p><p>But to get the simplest representation of the note, seems like we just<br/>need to find the point in the affine span which has the closest<br/>weighted Lp distance to the origin, right? I don&apos;t have an exact<br/>method and I&apos;ll give it some thought, but it seems like you could do<br/>it by using the pseudoinverse to get a rough starting point and then<br/>poking around a bit from there.</p><p>How are you finding the generator now and getting 15/14?</p><p>-Mike</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>6/1/2012 1:37:17 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Wed, May 30, 2012 at 8:43 PM, Mike Battaglia &lt;<a href="mailto:battaglia01@gmail.com">battaglia01@gmail.com</a>&gt; wrote:<br/>&gt;<br/>&gt; How are you finding the generator now and getting 15/14?</p><p>How how how?</p><p>-Mike</p></div><h3>genewardsmith &#x3C;genewardsmith@sbcglobal.net&#x3E;</h3><span>6/1/2012 3:09:55 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning-math@yahoogroups.com">tuning-math@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; On Wed, May 30, 2012 at 8:43 PM, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt; &gt;<br/>&gt; &gt; How are you finding the generator now and getting 15/14?<br/>&gt;<br/>&gt; How how how?</p><p>Geez. Do you want the code? It takes the transpose of the pseudoinverse of the mapping, clears denominators, tacks on commas one by one, saturates that, and goes on from there; I&apos;d need to analyze it to find out what the hell I did.</p></div><h3>Mike Battaglia &#x3C;battaglia01@gmail.com&#x3E;</h3><span>6/1/2012 3:14:31 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Fri, Jun 1, 2012 at 6:09 PM, genewardsmith &lt;<a href="mailto:genewardsmith@sbcglobal.net">genewardsmith@sbcglobal.net</a>&gt;<br/>wrote:<br/>&gt;<br/>&gt; Geez. Do you want the code? It takes the transpose of the pseudoinverse of<br/>&gt; the mapping, clears denominators, tacks on commas one by one, saturates<br/>&gt; that, and goes on from there; I&apos;d need to analyze it to find out what the<br/>&gt; hell I did.</p><p>Yeah, would you mind posting it? Were you using augmented matrices<br/>like I was too?</p><p>-Mike</p></div>