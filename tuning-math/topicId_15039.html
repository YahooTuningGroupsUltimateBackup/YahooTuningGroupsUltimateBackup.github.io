<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup tuning-math Ministry of Funny Kludges</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/tuning-math">back to list</a><h1>Ministry of Funny Kludges</h1><h3><a id=15039 href="#15039">ðŸ”—</a>Gene Ward Smith &#x3C;genewardsmith@coolgoose.com&#x3E;</h3><span>6/3/2006 2:45:12 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Conway rediscovered the Minkowski ?(x) function, and in typical Conway<br/>style he went Minkowski one better by denoting the inverse function by<br/>drawing a box around the x. I&apos;m just calling it box(x), and I call the<br/>? function quest(x) because Maple won&apos;t let me call it ?(x). I give<br/>routines below for quest and box, and if all is well then these should<br/>be inverses, with x =  quest(box(x)) = box(quest(x)). However, testing<br/>my box routine out I found an anomaly, where box(n+1/8) returned (for<br/>any integer n) n+1/16, whereas it was supposed to give n+1/4. I can&apos;t<br/>find any other anomalous values! This seems a little strange, but<br/>below I just patch the one anomaly I did find. If anyone can another<br/>anomaly, I&apos;d be interested, because I&apos;ve never seen anything quite<br/>like this one--why 1/8??</p><p>Here&apos;s the Maple code:</p><p>invcon := proc(l)<br/># inverse continued fraction<br/>local d, i, h, k;<br/>h[-2] := 0;<br/>h[-1] := 1;<br/>k[-2] := 1;<br/>k[-1] := 0;<br/>for i from 0 to nops(l)-1 do<br/>h[i] := l[i+1]*h[i-1] + h[i-2];<br/>k[i] := l[i+1]*k[i-1] + k[i-2];<br/>d[i+1] := h[i]/k[i] od;<br/>convert(convert(d, array), list) end:</p><p>quest := proc(x)<br/># Minkowski ? function<br/>local i, j, d, l, s, t;<br/>l := convert(x, confrac);<br/>d := nops(l);<br/>s := l[1];<br/>for i from 2 to d do<br/>t := 1;<br/>for j from 2 to i do<br/>t := t - l[j] od;<br/>s := s + (-1)^i * 2^t od;<br/>if type(x, float) then s := evalf(s) fi;<br/>s end:</p><p>box := proc(x)<br/># inverse ? function<br/>local d, e, i, n, w, y;<br/>if type(x, integer) then RETURN(x) fi;<br/>y := x-floor(x);<br/>if y = 1/8 then RETURN(floor(x)+1/4) fi;<br/>w := round(l2(10)*Digits)-5;<br/>n := round(2^w * y);<br/>i :=0;<br/>while n&gt;0 do<br/>i := i+1;<br/>if modp(n,2)=0 then<br/>d[i] := ordp(n, 2);<br/>n := n/2^d[i];<br/>else<br/>d[i] := ordp(n+1, 2);<br/>n := (n-2^d[i]+1)/2^d[i] fi od;<br/>e := convert(convert(d, array), list);<br/>e := subsop(1=NULL,e);<br/>w := ceil(-l2(y));<br/>e := [op(e), w];<br/>e := [op(e), floor(x)];<br/>e := rev(e);<br/>n := invcon(e);<br/>w := n[nops(n)];<br/>if type(x, rational) and modp(denom(x), 2)=0 then RETURN(w) fi;<br/>evalf(w) end:</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            