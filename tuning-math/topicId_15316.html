<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup tuning-math Linear Programming</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/tuning-math">back to list</a><h1>Linear Programming</h1><h3><a id=15316 href="#15316">ðŸ”—</a>Graham Breed &#x3C;gbreed@gmail.com&#x3E;</h3><span>7/15/2006 3:23:30 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>I&apos;ve already been using a linear programming library to do TOP-max optimizations.  But I didn&apos;t know the background and happened to find some references recently.  Mainly, this FAQ:</p><p><a href="http://www-unix.mcs.anl.gov/otc/Guide/faq/linear-programming-faq.html">http://www-unix.mcs.anl.gov/otc/Guide/faq/linear-programming-faq.html</a></p><p>but also this online book about optimization:</p><p><a href="http://www.sce.carleton.ca/faculty/chinneck/po.html">http://www.sce.carleton.ca/faculty/chinneck/po.html</a></p><p>A linear program is either a minimization or maximization problem of a linear function with linear constraints.  The FAQ gives the Standard Form as</p><p>    minimize   cx<br/>    subject to Ax  = b<br/>                x &gt;= 0</p><p>where x is a vector of variables and so on.  The way I&apos;ve been solving TOP-max is that I tell it to minimize the error, and constrain the error to be no smaller than the error in each prime for a given pair of generator sizes.  This may be more efficient as an unconstrained optimization of a piecewize linear function, but it works as a linear program.</p><p>It&apos;s also possible to constrain some of the variables to be integers. This is called, among other things, mixed integer linear programming. Provided you keep the period fixed you can find the period mapping as part of the program.  I&apos;ve appended an example Python script that does this using PuLP and my regular temperament library.  It&apos;s responsive but I haven&apos;t profiled it for a large number of optimizations.</p><p>You can&apos;t optimize for the period mapping and the period size with the same linear program because the period is multiplied by each element of the mapping.  Linear programming doesn&apos;t allow for one variable being multiplied by another.  This would, however, work as a quadratic program.  It turns out that quadratic problems are quite common as well but I don&apos;t know of free libraries to solve them with integers.  If you can find one, you could try doing the whole regular temperament search with it.  Set the full mapping and generator sizes as variables and constrain it to have a low error and complexity.</p><p>There are other problems linear programming might help us with. Adaptive temperament is an optimization problem and, as I mentioned on the main list, it can probably be described as a linear program.  I haven&apos;t worked out the details to be sure there are no nonlinearities though.  Linear programs are routinely solved with thousands of variables.  That standard simplex algorithm is non-polynomial but still efficient for such simple problems.</p><p>Here&apos;s that Python code.  Hopefully Yahoo don&apos;t mangle the indentation any more.</p><p>&quot;&quot;&quot;Solve a regular temperament using mixed integer linear programming&quot;&quot;&quot;</p><p>import regular, pulp</p><p>def LinearTemperament(mapping, primes):<br/>    &quot;&quot;&quot;Return a temperament from an octave-equivalent mapping&quot;&quot;&quot;</p><p>    prob = pulp.LpProblem(&quot;kees&quot;, pulp.LpMinimize)</p><p>    # extract information from the mapping<br/>    octave = regular.hcf(mapping)<br/>    generatorMapping = [m/octave for m in mapping]</p><p>    # set three variables: the generator and the error limits<br/>    generator = pulp.LpVariable(&quot;generator&quot;, 0, 1.0/octave)<br/>    maxError = pulp.LpVariable(&quot;maxError&quot;, 0, None)<br/>    minError = pulp.LpVariable(&quot;minError&quot;, None, 0)</p><p>    # construct a period mapping including some parameters<br/>    period = 1.0/octave<br/>    periodMapping = [<br/>                pulp.LpVariable(&quot;M0%i&quot;%i, None, None, pulp.LpInteger)<br/>                for i in range(1, len(primes))]</p><p>    # specify that it&apos;s the error range we want to minimize<br/>    prob += maxError - minError, &quot;obj&quot;</p><p>    # now set the errors of the temperament as constraints<br/>    for i in range(len(primes)-1):<br/>        weightedPrime = (periodMapping[i]*period +<br/>                generator*generatorMapping[i])/primes[i+1]<br/>        error = weightedPrime - 1<br/>        prob += maxError &gt;= error<br/>        prob += minError &lt;= error</p><p>    prob.solve(pulp.GLPK(msg=0))</p><p>    mapping = ([octave]+[e.varValue for e in periodMapping],<br/>            [0]+generatorMapping)<br/>    melody = [(a, a+b) for a, b in zip(mapping[0], mapping[1])]<br/>    result = regular.Rank2Temperament(primes, 1,<br/>            mapping[0], mapping[1], melody)<br/>    result.basis = (period, generator.varValue)<br/>    return result</p><p>if __name__==&apos;__main__&apos;:<br/>    print LinearTemperament((1, 4), regular.limit5)<br/>    print LinearTemperament((0, 29, 29, 29, 29), regular.limit13)</p></div><h3><a id=15318 href="#15318">ðŸ”—</a>Carl Lumma &#x3C;ekin@lumma.org&#x3E;</h3><span>7/15/2006 11:36:50 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;TOP-max</p><p>You&apos;ve been saying this lately.  Does it refer to Paul&apos;s TOP,<br/>or your primes-only TOP?</p><p>-Carl</p></div><h3><a id=15319 href="#15319">ðŸ”—</a>Graham Breed &#x3C;gbreed@gmail.com&#x3E;</h3><span>7/15/2006 11:59:12 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Carl Lumma wrote:<br/>&gt;&gt;TOP-max<br/>&gt; &gt; &gt; You&apos;ve been saying this lately.  Does it refer to Paul&apos;s TOP,<br/>&gt; or your primes-only TOP?</p><p>They&apos;re both the same.</p><p>            Graham</p></div><h3><a id=15320 href="#15320">ðŸ”—</a>Carl Lumma &#x3C;ekin@lumma.org&#x3E;</h3><span>7/15/2006 12:55:34 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;&gt;&gt;TOP-max<br/>&gt;&gt;<br/>&gt;&gt; You&apos;ve been saying this lately.  Does it refer to Paul&apos;s TOP,<br/>&gt;&gt; or your primes-only TOP?<br/>&gt;<br/>&gt;They&apos;re both the same.</p><p>Do you show this in your paper, and if so can you tell me<br/>roughly where?</p><p>-Carl</p></div><h3><a id=15321 href="#15321">ðŸ”—</a>Graham Breed &#x3C;gbreed@gmail.com&#x3E;</h3><span>7/15/2006 1:36:30 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Carl Lumma wrote:<br/>&gt;&gt;&gt;&gt;TOP-max<br/>&gt;&gt;&gt;<br/>&gt;&gt;&gt;You&apos;ve been saying this lately.  Does it refer to Paul&apos;s TOP,<br/>&gt;&gt;&gt;or your primes-only TOP?<br/>&gt;&gt;<br/>&gt;&gt;They&apos;re both the same.<br/>&gt; &gt; &gt; Do you show this in your paper, and if so can you tell me<br/>&gt; roughly where?</p><p>Paul shows it in his paper, one of the footnotes, and I give a citation.   I mention it in &quot;Weighted Worst Errors&quot;.</p><p>             Graham</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            