<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup tuning Tuning accuracy - Digital synthesis engines</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/tuning">back to list</a><h1>Tuning accuracy - Digital synthesis engines</h1><h3><a id=3072 href="#3072">ðŸ”—</a>J. Scott &#x3C;cgscott@xxxxxxx.xxxx&#x3E;</h3><span>5/16/1999 12:14:49 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Howdy all,</p><p>There have been periodic comments about the tuning resolution of<br/>digital hardware.</p><p>I was an engineer on three digital synthesis engines,<br/>each of comparable complexity (in terms of transistor<br/>count) to the 486. In addition to a little IC design and<br/>verification, I also wrote (with another guy) hardware drivers<br/>for the chips, designed and laid out a couple of multi-channel,<br/>low noise (100dB S/N) soundcards, wrote several Win95 applications<br/>using the chips, implemented a scriptable, programmable,<br/>multichannel effects system, and ported one of my interactive,<br/>real-time, 3-D positional audio algorithms to work on the chips<br/>(supporting up to 128 simultaneous 3D streams - in 1996!)<br/>Oh and I also threw in a dynamic stereo widening &apos;3D&apos; effect<br/>for good measure and wrote and illustrated all the manuals.</p><p>So I know a little bit about digital synthesis.</p><p>  SIDEBAR<br/>  --------------------------------------------------------------<br/>  | The main reason I got involved in engineering was because I<br/>  | needed more control, in terms of being able to design my<br/>  | own instruments, as a composer. Quick summary: particular<br/>  | fields of interest are spatialization of sound and nonoctave<br/>  | tunings; I&apos;m a get-your-hands-dirty,<br/>  | see-what-sounds-good-to-me composer, but not a<br/>  | castles-in-the-sky numerologist.<br/>  --------------------------------------------------------------</p><p>These comments describe tuning on a typical digital synth. They apply<br/>to wavetable based instruments. FM instruments and physically modelled<br/>instruments and analog synths with digital oscillators all use<br/>wavetables at some point to generate waveforms.</p><p>There are some simplifications and generalizations but you should get<br/>the general idea.</p><p>------------------------------------------------------------------------------------------------------------<br/>Notes:   * This post contains a wide table which may present<br/>           problews in viewing, depending on your email software.<br/>           Turn off word-wrap, widen the window, or save and<br/>           view in a text editor if you have problems. Be sure<br/>           to use a monospaced font to see it lined up properly.</p><p>         * There are two common audio uses of the noun &quot;sample&quot;.<br/>           I distinguish between them by using the following terms:<br/>           1. I use the term &quot;wave recording&quot; to mean what is<br/>              often called &quot;sample&quot;. Example: &quot;A wave recording<br/>              of a saxophone.&quot;<br/>           2. I use the term &quot;sample&quot; to mean a single number<br/>              within a wave recording. Example: &quot;Sample number<br/>              1,983,780 in this AIFF file was clipped.&quot;<br/>------------------------------------------------------------------------------------------------------------</p><p>There are two places where tuning is a factor on a digital synth:</p><p>  1. The tuning tables. Usually in log-of-frequency format with<br/>     a resolution of cents, 1024ths of an octave, or 64ths of a<br/>     semitone. This is what you have access to from the front<br/>     panel if the tuning is editable. But even if not editable,<br/>     a tuning table still exists. The code that handles this is<br/>     in the instrument&apos;s firmware in the case of standalone<br/>     instruments and some soundcards, or software driver in the<br/>     case of other soundcards.</p><p>     These numbers are mixed with the patch settings and the details<br/>     of the wavetables being used in order to generate a number<br/>     that is given to the synthesis hardware to read the wavetables<br/>     and generate the frequency you want.</p><p>  2. The digital synthesis hardware. This is where the actual<br/>     frequency resolution is determined. It is not the same as<br/>     the resolution which is available through the tuning tables.<br/>     The digital synthesis engine is usually either an ASIC<br/>     (Application Specific Integrated Circuit) or a general<br/>     purpose DSP chip. The chip that produces the digital waveforms<br/>     doesn&apos;t use cents when addressing the waveform samples. It<br/>     specifies tuning through the use of a phase increment<br/>     register which I&apos;ll call &quot;dPhase&quot;. dPhase is typically<br/>     a 24-bit fixed point number, 16 bits of which are the<br/>     fraction. Thus dPhase ranges from  0.000000000000 to<br/>     255.999984741211 in 0.000015258789 step increments.<br/>     Every sample period, dPhase is added to the wave pointer -<br/>     the pointer to the wavetable where the samples are. Wrap<br/>     around occurs at some point where the end of the wavetable<br/>     is in the sample RAM or ROM. So if dPhase is 1.0 then<br/>     every sample is read in the table and the output pitch<br/>     is equal to the pitch at which the wave recording was<br/>     originally recorded. If dPhase is 2.0, then every other<br/>     sample is skipped and so the pitch is an exact just<br/>     octave above the original pitch. If dPhase is 1.5,<br/>     then the pitch is a exact just fifth above the original<br/>     pitch. And so forth. When the sample address is fractional,<br/>     then the synthesis engine will usually interpolate<br/>     between the samples on either side according to<br/>     some interpolation scheme.</p><p>     Example:</p><p>     The output sampling rate is 48000 kHz. We are playing<br/>     a sine wave that is in a 256-sample-long wavetable in<br/>     the sample ROM starting at address 1024. We want to play<br/>     at a frequency of 600 Hz.</p><p>     dPhase = CycleLengthInSamples * FrequencyInHz / SampleRateInHz<br/>            = 256 * 600 / 48000<br/>            = 3.2</p><p>     So to generate the output samples we would start by getting a sample<br/>     at location 1024. After 1/48000 of a second we would advance the<br/>     wave pointer to 1024 + 3.2 = 1027.2. We&apos;d grab samples from locations<br/>     1024 and 1025 and output 0.2 times the value at location 1024 plus<br/>     0.8 times the value at location 1025 (assuming linear interpolation).<br/>     And 1/48000 of a second later we&apos;d do it again, advancing to 1030.4 ...<br/>     until we go past the end of the table at location 1024+256 = 1280,<br/>     where we would subtract 256 to get back towards the beginning of<br/>     the wave table.</p><p>------------------------------------------------------------------------------------------------------------<br/>Next I will present tables showing the native tuning resolution<br/>of a typical synthesis engine. You can sometimes bypass the<br/>tuning tables and access this directly if you write your own<br/>soundcard driver.</p><p>Note in particular that the pitch accuracy you get is not fixed -<br/>it depends on the the frequency you are shooting for, which is<br/>related to the cycle length in samples of the wavetable you are<br/>using.</p><p>------------------------------------------------------------------------------------------------------------</p><p>Column Headings<br/>---------------</p><p>CycleLength  =  for some particular wave recording, the<br/>                number of samples per cycle at the fundamental<br/>                pitch of the wave recording</p><p>dPhase       =  internal representation of pitch to the<br/>                hardware - how many samples to skip per<br/>                sample period. Sometimes called the &quot;Phase<br/>                Increment&quot;.</p><p>Freq. A (Hz) =  SampleRate/CycleLength * dPhase<br/>                For the given TableLength and dPhase, the resulting pitch.</p><p>epsilon is the smallest amount by which dPhase can be changed, in this<br/>  case 1/65536 since there are 16 fractional bits.</p><p>Freq. B (Hz) =  SampleRate/CycleLength * dPhase<br/>                The next higher frequency above Freq. A at which<br/>                this wave recording can be played.</p><p>Freq. B/Freq. A<br/>             =  Smallest Pitch difference that can be played for this<br/>                CycleLength and dPhase, as a ratio.</p><p>cents resolution<br/>             = 100*log(Freq. B/Freq. A)/log(2^(1/12))<br/>               Smallest Pitch difference that can be played for this<br/>               CycleLength and dPhase, in cents.<br/>------------------------------------------------------------------------------------------------------------</p><p>SampleRate = 44100 Hz</p><p>CycleLength dPhase      Freq. A (Hz)     dPhase+epsilon    Freq. B (Hz)<br/>Freq. B/Freq. A  cents resolution<br/>----------- ------      --------------   --------------  ----------------<br/>---------------  ----------------<br/>   128       0.25        86.1328125      0.250015258789    86.13806962967<br/>1.000061035156    0.105662916146<br/>   128       0.5        172.265625       0.500015258789   172.2708821297<br/>1.000030517578    0.052832264192<br/>   128       1          344.53125        1.000015258789   344.5365071297<br/>1.000015258789    0.026416333632<br/>   128       2          689.0625         2.000015258789   689.0677571297<br/>1.000007629395    0.013208217201<br/>   128       4         1378.125          4.000015258789  1378.13025713<br/>1.000003814697    0.006604121196<br/>   128       8         2756.25           8.000015258789  2756.25525713<br/>1.000001907349    0.003302063747<br/>   256       0.25        43.06640625     0.250015258789    43.06903481483<br/>1.000061035156    0.105662916146<br/>   256       0.5         86.1328125      0.500015258789    86.13544106483<br/>1.000030517578    0.052832264192<br/>   256       1          172.265625       1.000015258789   172.2682535648<br/>1.000015258789    0.026416333632<br/>   256       2          344.53125        2.000015258789   344.5338785648<br/>1.000007629395    0.013208217201<br/>   256       4          689.0625         4.000015258789   689.0651285648<br/>1.000003814697    0.006604121196<br/>   256       8         1378.125          8.000015258789  1378.127628565<br/>1.000001907349    0.003302063747<br/>   512       0.25        21.533203125    0.250015258789    21.53451740742<br/>1.000061035156    0.105662916146<br/>   512       0.5         43.06640625     0.500015258789    43.06772053242<br/>1.000030517578    0.052832264192<br/>   512       1           86.1328125      1.000015258789    86.13412678242<br/>1.000015258789    0.026416333632<br/>   512       2          172.265625       2.000015258789   172.2669392824<br/>1.000007629395    0.013208217201<br/>   512       4          344.53125        4.000015258789   344.5325642824<br/>1.000003814697    0.006604121196<br/>   512       8          689.0625         8.000015258789   689.0638142824<br/>1.000001907349    0.003302063747<br/>   1024      0.25        10.7666015625   0.250015258789    10.76725870371<br/>1.000061035156    0.105662916146<br/>   1024      0.5         21.533203125    0.500015258789    21.53386026621<br/>1.000030517578    0.052832264192<br/>   1024      1           43.06640625     1.000015258789    43.06706339121<br/>1.000015258789    0.026416333632<br/>   1024      2           86.1328125      2.000015258789    86.13346964121<br/>1.000007629395    0.013208217201<br/>   1024      4          172.265625       4.000015258789   172.2662821412<br/>1.000003814697    0.006604121196<br/>   1024      8          344.53125        8.000015258789   344.5319071412<br/>1.000001907349    0.003302063747<br/>   2048      0.25         5.38330078125  0.250015258789     5.383629351854<br/>1.000061035156    0.105662916146<br/>   2048      0.5         10.7666015625   0.500015258789    10.7669301331<br/>1.000030517578    0.052832264192<br/>   2048      1           21.533203125    1.000015258789    21.5335316956<br/>1.000015258789    0.026416333632<br/>   2048      2           43.06640625     2.000015258789    43.0667348206<br/>1.000007629395    0.013208217201<br/>   2048      4           86.1328125      4.000015258789    86.1331410706<br/>1.000003814697    0.006604121196<br/>   2048      8          172.265625       8.000015258789   172.2659535706<br/>1.000001907349    0.003302063747<br/>   4096      0.25         2.691650390625 0.250015258789     2.691814675927<br/>1.000061035156    0.105662916146<br/>   4096      0.5          5.38330078125  0.500015258789     5.383465066552<br/>1.000030517578    0.052832264192<br/>   4096      1           10.7666015625   1.000015258789    10.7667658478<br/>1.000015258789    0.026416333632<br/>   4096      2           21.533203125    2.000015258789    21.5333674103<br/>1.000007629395    0.013208217201<br/>   4096      4           43.06640625     4.000015258789    43.0665705353<br/>1.000003814697    0.006604121196<br/>   4096      8           86.1328125      8.000015258789    86.1329767853<br/>1.000001907349    0.003302063747<br/>------------------------------------------------------------------------------------------------------------<br/>The main points:</p><p>* Lower frequencies have less pitch resolution.</p><p>* The pitch resolution for a given fundamental frequency depends<br/>  on the wave table being used - in particular how many samples<br/>  are used to store one cycle at the fundamental pitch.</p><p>By the way, csound has better pitch resolution because you typically<br/>use (I think) 32 bit floating point numbers for your tuning tables<br/>AND for your phase increment and wave pointers/table indices. But<br/>the general idea is the same.</p><p>- Jeff</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            