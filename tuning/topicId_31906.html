<a href="/tuning">back to list</a><h1>Re: Happy Holidays, Paul and everyone -- a gift</h1><h3>M. Schulter &#x3C;MSCHULTER@VALUE.NET&#x3E;</h3><span>12/25/2001 3:46:50 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hello, there, Paul Erlich and everyone, and here&apos;s a small holiday<br/>present addressing one of my pet topics: &quot;virtually closed&quot; tunings,<br/>and how to find them.</p><p>Basically, a virtually closed tuning is something in a convention<br/>system with 1:2 octaves like 53-note Pythagorean, or a 31-note version<br/>of 1/4-comma meantone. The circle doesn&apos;t _precisely_ close from a<br/>mathematical point of view, but musically we have a nice circulating<br/>tuning, with one &quot;odd&quot; fifth slightly larger or smaller than the<br/>others. In contrast to 53-tET or 31-tET, we have a system with<br/>_slight_ &quot;asymmetries,&quot; but much the same &quot;circular&quot; qualities.</p><p>Thus explanations on why no number of pure 3:2 fifths can form an<br/>exact multiple of a pure 2:1 octave are quite correct -- but don&apos;t<br/>prevent Pythagorean from circulating admirably in 53 notes, let alone<br/>665, say.</p><p>What follows is a program taken a chosen size of generator, for<br/>example, 701.955 cents, and testing points at which a chain of such<br/>generators closely approximate an even 1200-cent octave.</p><p>This program can also be used to list _all_ the intervals generated<br/>from a chain of identical intervals, in the order they appear on the<br/>chain -- for example, the first 53 or 665 or 1024 notes along a chain<br/>of pure fifths, or 1/4-comma meantone fifths, or whatever generator<br/>you might be curious about. I&apos;ll explain this feature below.</p><p>I&apos;ve written it in PostScript, the programming language with which I&apos;m<br/>most familiar, although I&apos;m sure some people familiar with this area<br/>might comment that a compiled language like C would handle numerics<br/>more efficiently -- and also that PostScript&apos;s precisely is hardly the<br/>highest &lt;grin&gt;. For calculations in cents, however, where the first<br/>couple of decimal places may be the most musically significant, I hope<br/>that this routine may be useful as well as fun.</p><p>Here I have a bit to explain, and maybe should take things in this<br/>order:</p><p>              (1) What you&apos;ll need to use the program, mainly a<br/>                  PostScript language interpreter of some kind<br/>                  (for example the free Aladdin or GNU Ghostscript<br/>                  available on the Internet) to display the results<br/>                  on screen or print them out;</p><p>              (2) The actual PostScript program file, a plain ASCII<br/>                  text file</p><p>              (3) What the program does, the main Tuning List<br/>                  interest, whether it is done in PostScript<br/>                  or some other programming language, and how to<br/>                  choose a generator size and other options when<br/>                  using the program.</p><p>----------------------<br/>1. What is PostScript?<br/>----------------------</p><p>PostScript is a computer language which specializes in imaging font<br/>characters and other graphics objects on a page, while also including<br/>some generalized programming features including the mathematical<br/>operations necessary to make calculations in cents.</p><p>Often a PostScript file is simply an ASCII text file with appropriate<br/>programming instructions, much like source code in C or some other<br/>language. A PostScript interpreter is necessary in order to process<br/>the file, usually resulting in text characters or other shapes drawn<br/>on one or more output pages -- either printed, or displayed on a<br/>monitor.</p><p>Dedicated PostScript-compatible printers have their own PostScript<br/>interpreters, but another option is to use a computer-based<br/>interpreter such as the free Aladdin or GNU Ghostscript to translate a<br/>PostScript file into output either for displaying on screen, or for<br/>printing on any of a large number of supported printers which don&apos;t<br/>have their own dedicated PostScript interpreters.</p><p>For the &quot;virtual closure&quot; program which follows, <a href="http://virtcl09.ps">virtcl09.ps</a>, the<br/>screen display option might be very convenient, since you might often<br/>be curious about virtual closure points for this or that generator<br/>without necessarily wanting to expend paper (and ink or toner) to<br/>print hard copy for each generator size you casually test.</p><p>Also, if used to test points of virtual closure, typically the program<br/>produces only a few lines of output, one for each such point. For<br/>example, searching for virtually closed systems along a Pythagorean<br/>chain of up to 1024 notes with a &quot;tolerance&quot; of up to 5 cents from<br/>perfect closure turns up eight such possibilities (53, 306, 359, 612,<br/>665, 718, 971, or 1024 notes).</p><p>If you use the option to list _all_ the intervals in a large tuning<br/>set, of course, then you can generate _lots_ of output to screen or<br/>printer, and the program has a capability to produce multiple pages if<br/>necessary.</p><p>-------------------------------------------------------------------<br/>2. The PostScript program itself -- explanation immediately follows<br/>-------------------------------------------------------------------</p><p>Why don&apos;t I first give a listing of the program itself, and then an<br/>explanation of the part which specifies the generator size and the<br/>other options for calculating a listing of virtual closure points --<br/>or a listing of all intervals generated from the starting note of a<br/>tuning chain.</p><p>In looking over the code, you might find it somewhat reassuring that<br/>generally a user need deal with only three relevant choices specified<br/>near the end of the file: the generator size (here &apos;701.955&apos;); the<br/>maximum number of notes to test (here &apos;1024&apos;), and the &quot;tolerance&quot; in<br/>cents, or how close the system should come to perfect closure in order<br/>to be listed (here &apos;5&apos;).</p><p>--------- <a href="http://virtcl09.ps">virtcl09.ps</a>: PostScript file starts next line of text ----</p><p>%!PS</p><p>/50string 50 string def<br/>/StartCurLine 720 def<br/>/StartCurPos   72 def<br/>/LineSpace 12 def<br/>/ColumnSpace 150 def<br/>/PageWidth 612 def<br/>/RightMargin 120 def<br/>/LowerMargin 72 def<br/>/SetFont { /Palatino-Roman findfont 10 scalefont setfont } bind def</p><p>/StartNewPage<br/>    { showpage<br/>      SaveState restore<br/>      /SaveState save def<br/>      /CurPos StartCurPos def<br/>      /CurLin StartCurLine def<br/>} bind def</p><p>/RationalToCents  % usage: 3 2 RationalToCents<br/>&#x9;&#x9;  % this example would convert 3/2 to cents<br/>    { div log 2 log div 1200 mul }<br/>bind def</p><p>/VirtualClose<br/>   { /MaxSize exch def /Tolerance exch def /Fifth exch def<br/>     SetFont<br/>     /CurLine StartCurLine def<br/>     /CurPos StartCurPos def<br/>     /SaveState save def<br/>     1 1 MaxSize<br/>       { /Fifth# exch def<br/>         Fifth Fifth# mul dup /IntervalSize exch def<br/>         1000 mul cvi 1200000 mod 1000 div<br/>         dup dup /FifthCents exch def<br/>         Tolerance le exch<br/>         1200 sub abs Tolerance le or<br/>              { CurPos CurLine moveto<br/>                Fifth 50 string cvs show ( ) show<br/>                Fifth# 50 string cvs show ( ) show<br/>                IntervalSize 50 string cvs show ( ) show<br/>                FifthCents 50 string cvs show<br/>                /CurLine dup load LineSpace sub def<br/>                CurLine LowerMargin lt<br/>                  { /CurPos dup load ColumnSpace add def<br/>                    PageWidth CurPos sub RightMargin lt<br/>&#x9;&#x9;&#x9;{ StartNewPage<br/>&#x9;&#x9;    } if<br/>                    /CurLine StartCurLine def<br/>                } if<br/>         } if<br/>     } for<br/>} bind def</p><p>%%EndProlog<br/>save mark</p><p>% fifth or generator size</p><p>701.955</p><p>% tolerance in cents<br/>% (setting to 1200 will list all steps in tuning)</p><p>5</p><p>% number of generators to check</p><p>1024</p><p>VirtualClose</p><p>cleartomark restore<br/>showpage</p><p>%%Trailer</p><p>------------  PostScript file ended on line before this one  ---------</p><p>----------------------------------------------<br/>3. How to choose a generator and other options<br/>----------------------------------------------</p><p>For most purposes, the only lines calling for editing are the three<br/>near the end of the program marked by comments; in PostScript, any<br/>portion of a line preceded by a &quot;%&quot; is treated as a comment:</p><p>% fifth or generator size</p><p>701.955</p><p>% tolerance in cents<br/>% (setting to 1200 will list all steps in tuning)</p><p>5</p><p>% number of generators to check</p><p>1024</p><p>VirtualClose</p><p>Here &apos;VirtualClose&apos; is the command -- or, technically speaking, the<br/>&quot;PostScript procedure&quot; -- that runs the main program. If we omit the<br/>comment lines -- which I suggest keeping in the actual program as a<br/>user-friendly reference -- then the basic pattern for the program is<br/>as follows:</p><p>701.955 5 1024 VirtualClose</p><p>The first number gives the generator size in cents, here 701.955, the<br/>approximate size for a pure 3:2 fifth.</p><p>The second number gives the &quot;tolerance&quot; in cents, how far we are<br/>willing for a listed system to vary from perfect &quot;mathematical<br/>closure.&quot; Here the specified tolerance is five cents, so that we&apos;ll<br/>list any systems where the last fifth would produce an interval within<br/>5 cents in either direction of a pure 1200-cent octave from the<br/>starting note.</p><p>The third number gives the maximum number of notes to check, here<br/>1024.</p><p>Similarly we could do:</p><p>696.5784 6.5 830 VirtualClose</p><p>and check any points of virtual closure along a chain of 1/4-comma<br/>meantone fifths (about 696.5784 cents) within 6.5 cents of perfect<br/>closure, testing up to 830 notes.</p><p>You can get lots of interesting results just by playing around with<br/>these three numbers. However, two features provide some extra options:<br/>specifying a generator as an integer ratio, and listing _all_<br/>intervals of a tuning system in reference to the starting note.</p><p>-------------------------------------------------<br/>3.1. Fun and Games (1): Specifying integer ratios<br/>-------------------------------------------------</p><p>For our Pythagorean example, we could also have written:</p><p>3 2 RationalToCents 5 1024 VirtualClose</p><p>This option uses the &apos;RationalToCents&apos; procedure defined earlier in<br/>the program file to calculate the tuning chain based on an integer<br/>ratio of 3:2. Here there are two big cautions to avoid PostScript<br/>errors.</p><p>First, the numbers are written, larger term first, with a space<br/>between them and no other punctuation -- &apos;3 2 RationalToCents&apos;.</p><p>Secondly, _PostScript is a case-sensitive language_, meaning that<br/>&apos;RationalToCents&apos; needs to have exactly this form of capitalization;<br/>&apos;rationaltocents&apos; or &apos;RationaltoCents&apos;, for example, would not be<br/>recognized and would produce an &apos;undefined&apos; error from the<br/>interpreter. In the second incorrect example, only the lowercase &apos;t&apos;<br/>in &apos;To&apos; differs from the desired form, so this is something to watch.</p><p>While &apos;fifths&apos; are the most familiar types of generators, we&apos;re free<br/>to use any desired generator size, specified in cents or as an integer<br/>ratio, e.g.</p><p>266.871 5 1024 VirtualClose</p><p>or</p><p>7 6 RationalToCents 5 1024 VirtualClose</p><p>While this isn&apos;t Manuel Op de Coul&apos;s Scala, one PostScript refinment<br/>may make the &apos;RationalToCents&apos; option yet more entertaining. Suppose<br/>we want to calculate points of virtual closure for the &quot;Wonder Tuning&quot;<br/>defined in Scala&apos;s scale archive, with a generator equal to precisely<br/>1/3 of a pure fifth:</p><p>3 2 RationalToCents 3 div 5 1024 VirtualClose</p><p>Here &apos;3 2 RationalToCents&apos; gives the size in cents for a 3:2 fifth,<br/>while the PostScript &apos;3 div&apos; divides this result by 3 to find the size<br/>of the desired generator. Note that the &apos;3&apos; comes _before_ the &apos;div&apos;,<br/>a &quot;natural&quot; ordering for those of us who grew up on PostScript, but<br/>different from the order followed in some other languages like C.</p><p>Here&apos;s another example for a tuning of interest to this list:</p><p>18 5 RationalToCents 19 div 5 1024 VirtualClose</p><p>This defines the generator as 1/19 of a pure 18:5 -- or, as it might<br/>be written in Scala, 18/5^1/19. Can anyone recognize this tuning?</p><p>-----------------------------------------------------------<br/>3.2. Fun and Games (2): Listing _all_ intervals in a tuning<br/>-----------------------------------------------------------</p><p>Here there&apos;s a simple trick, involving the second or &quot;tolerance&quot;<br/>option -- set this option to &apos;1200&apos; in order to list all intervals<br/>along the chain as measured from the starting note. For example, for a<br/>53-note Pythagorean tuning, we could use either</p><p>701.955 1200 53 VirtualClose</p><p>or</p><p>3 2 RationalToCents 1200 53 VirtualClose</p><p>Sometimes we might first use the usual form of the program with a<br/>tolerance like &apos;3&apos; or &apos;5&apos; to look for some tuning sizes of interest<br/>with a given generator, and then set the tolerance to &apos;1200&apos; to list<br/>all the intervals of such a tuning set.</p><p>For example, consider Gary Morrison&apos;s 88-cET (88-cent equal<br/>temperament) with a repeated generator of 88 cents. Although this is<br/>a &quot;nonoctave&quot; tuning, we can try something like</p><p>88 5 1024 VirtualClose</p><p>and find out that 88-cET in fact closes, not only &quot;virtually&quot; but<br/>perfectly, every 150 notes. Then we can list all the intervals of a<br/>150-note set:</p><p>88 1200 150 VirtualClose</p><p>Running this version shows that the set closes at 13200 cents, where<br/>150 generators of 88 cents equal precisely 13 pure octaves above the<br/>starting note.</p><p>This listing, by the way, fits on one page -- but longer ones may go<br/>to multiple pages.</p><p>-------------------------------------------------<br/>4. A fine point: Counting by notes or generators?<br/>-------------------------------------------------</p><p>Looking over this article, I note a small point which shouldn&apos;t<br/>present any problem to a user, but might be worthy of note: I&apos;ve<br/>sometimes referred, for example, to a Pythagorean tuning set with<br/>either &quot;1024 notes&quot; or &quot;1024 generators.&quot; Actually, both are correct<br/>-- but from different viewpoints.</p><p>From the viewpoint of the program listing, we are actually testing<br/>virtual closure for a given number of _generators_: 31 fifths in<br/>1/4-comma meantone, or 53 in Pythagorean, or 150 in 88-cET, etc.<br/>We&apos;re checking to see how close the interval from the starting note<br/>formed by the given number of generators comes to an exact multiple of<br/>an octave at 2:1 or 1200 cents.</p><p>From the viewpoint of actually tuning a virtually closed system as a<br/>pure octave tuning, however, we&apos;re talking about the number of _notes_<br/>per octave: 53 for the smallest &quot;virtually closed&quot; Pythagorean system,<br/>or 31 for 1/4-comma meantone, etc.</p><p>What happens in 53-note Pythagorean, for example, is that we actually<br/>tune a chain of 52 pure fifths (53 notes), followed by other pure<br/>octaves of these notes -- for example, the octave of the starting<br/>note, which the 53rd fifth would exceed by about 3.62 cents. Thus this<br/>&quot;odd&quot; fifth is &quot;virtually tempered&quot; in the narrow direction by this<br/>amount.</p><p>Similarly, in 1/4-comma meantone, we tune a chain of 30 regular<br/>tempered fifths, with the &quot;odd&quot; 31st fifth about 6.07 cents larger<br/>than the others in order to obtain a pure octave to the starting<br/>note. Since the regular fifths are about 5.38 cents narrow, this<br/>produces an &quot;odd&quot; near-pure fifth slightly larger than 3:2.</p><p>Thus if a chain of 53 generators would _exceed_ a pure octave by some<br/>amount, for example, a virtually closed system of 53 notes will have the<br/>last odd &quot;generator-like&quot; interval _narrowed_ by the same amount by<br/>comparison to the other generators; if a chain of 31 generators would<br/>_fall short_ of a pure octave by a given amount, then the &quot;odd&quot; interval<br/>will be _widened_ by this amount.</p><p>This can have significant implications for the desired &quot;tolerance&quot;<br/>which the program doesn&apos;t attempt to address, but users might<br/>consider. For example, consider a 22-note chain of fifths tempered so<br/>as to generate regular major thirds at a pure 9:7 (~435.08 cents).<br/>Here our generator has a size of about 708.771 cents, slightly smaller<br/>than in 22-tET, where the regular third of about 436.36 cents is a bit<br/>larger than a pure 9:7 ratio:</p><p>708.771 8 500 VirtualClose</p><p>The listing tells us that a chain of 22 such fifths would yield an<br/>interval of 1192.96 cents, or about 7.04 cents short of a pure octave,<br/>and thus within our 8-cent tolerance.</p><p>However, since this chain falls short of a pure octave, we must<br/>therefore achieve &quot;virtual closure&quot; by stretching the &quot;odd&quot; fifth of a<br/>22-note tuning an extra 7.04 cents in the _wide_ direction. Since<br/>regular fifths are already about 6.82 cents wide, this means a total<br/>stretching of about 13.85 cents. Such an odd fifth at about 715.81<br/>cents goes beyond usual &quot;well-temperament&quot; standards, although the<br/>success of tunings like 20-tET (720 cents) shows that this option is<br/>quite practical in a suitable timbre. Jacky Ligon or I might relish<br/>this wide fifth, considering it a bit of &quot;local color.&quot;</p><p>The main practical lesson of this exercise is that the &quot;tolerance&quot;<br/>measures the amount by which the size of an &quot;odd&quot; interval used in a<br/>virtually closed system to complete the circle may differ from the<br/>size of the other generators in _either_ direction. Determining the<br/>musical consequences calls for attention to the direction of the<br/>adjustment, something left to the user.</p><p>May I conclude by offering technical support via e-mail, plus best<br/>wishes to all, including Paul and Pierre who have regaled the list<br/>with beautiful graphics to celebrate the season.</p><p>Peace, love, and joyous tidings,</p><p>Margo Schulter<br/><a href="mailto:mschulter@value.net">mschulter@value.net</a></p></div><h3>paulerlich &#x3C;paul@stretch-music.com&#x3E;</h3><span>12/26/2001 12:44:24 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Thank you Margo. I hope you&apos;re having a very happy holiday time, and<br/>I&apos;ll look at your gift when I get a chance. Cheers!</p></div>