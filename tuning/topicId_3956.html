<a href="/tuning">back to list</a><h1>To Mr Alves Just and C sound</h1><h3>patrick pagano &#x3C;ppagano@xxxxxxxxx.xxxx&#x3E;</h3><span>7/13/1999 11:32:43 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Dear Bill began fiddling with the table for Cps2</p><p>does this look correct and can you lucidify the table idea for me a bit<br/>Thanks Pat<br/>;just intonation C sound Instrument<br/>sr   =   44100<br/>kr   =   4410<br/>ksmps  =   10<br/>nchnls  =   2<br/>zakinit 50, 50</p><p>  instr   101<br/>ioutch  =       p5                                 ; Output channel<br/>ipanl   =       sqrt(p6)                           ; Pan left<br/>ipanr   =       sqrt(1-p6)                         ; Pan right<br/>k1      linen   5000,03,p3,.5<br/>aamp    linseg  0, .002, 1, p3-.004, 1, .002, 0  ; Declick envelope<br/>ifreg    cps2pch    p4,-1    ; refer to multiplier table #1<br/>asound  oscili       k1,ifreg,1<br/>aout    =       asound*aamp<br/>outs    aout*ipanl, aout*ipanr             ; Output stereo<br/>zawm    aout, ioutch                       ; Mix to the Zak channel<br/>        outs asound*aamp,asound*aamp<br/>  endin<br/>;sco<br/>;table # start  size    gen fn   C          C#         D          Eb<br/>etc.<br/>f 1      0      16      -2       1.000000   1.066667   1.125000<br/>1.200000<br/>1.250000   1.333333   1.440000   1.500000   1.600000   1.666667<br/>1.750000<br/>1.875000</p><p>; inst start duration       pitch     out<br/>i 101  0  3          8.00    1        0<br/>i 101  3  3          8.07     2       1<br/>i 101  6  3          8.10     1       0<br/>i 101  9  3          8.11     1        1<br/>i 101  12  3          8.03     2        0<br/>;    Sta  Dur  Amp  TimL  FdbkL XFdbkL TimR FdbkR XFdbkR InChL  InChR<br/>i15  0    15    .5   3   .4     .5     3   0.4     .6     1      2</p><p>; Clear Zak<br/>;    Sta  Dur<br/>i99  0    15</p></div><h3>alves@xxxxx.xx.xxx.xxxxxxxxxxxxxxx)</h3><span>7/16/1999 10:13:25 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;From: patrick pagano &lt;<a href="mailto:ppagano@bellsouth.net">ppagano@bellsouth.net</a>&gt;<br/>&gt;<br/>&gt;Dear Bill began fiddling with the table for Cps2<br/>&gt;<br/>&gt;does this look correct and can you lucidify the table idea for me a bit<br/>&gt;Thanks Pat</p><p>Pat,</p><p>Here&apos;s how I&apos;d do it:</p><p>sr      =   44100<br/>kr      =   4410<br/>ksmps   =   10<br/>nchnls  =   2</p><p>        instr   101<br/>        ;       p3      =       duration<br/>        ;       p4      =       loudness<br/>        ;       p5      =       pitch<br/>        ;       p6      =       pan<br/>ipanl   =               sqrt(p6)                ; Pan left<br/>ipanr   =               sqrt(1-p6)              ; Pan right<br/>imax    =               5000                    ; max amplitude<br/>ifreq   cps2pch         p5,-1                   ; refer to multiplier table #1<br/>aamp    linseg          0, .002, p4, p3-.004, p4, .002, 0  ; envelope<br/>aout    oscili          aamp*imax,ifreq,2       ; simple oscillator<br/>        outs            aout*ipanl, aout*ipanr  ; Output stereo<br/>        endin</p><p>;sco<br/>;table # start  size    gen fn   C          C#         D         Eb etc.<br/>f 1      0      16      -2       1.000000   1.066667   1.125000  1.200000<br/>1.250000   1.333333   1.440000   1.500000   1.600000   1.666667   1.750000<br/>1.875000<br/>f 2      0      8192    10      1</p><p>; inst  start   dur     loud    pitch   pan<br/>i 101   0       3          1    8.00    0<br/>i 101   3       3          1    8.07    1<br/>i 101   6       3          1    8.10    0<br/>i 101   9       3          1    8.11    1<br/>i 101   12      3          1    8.03    0</p><p>e</p><p>First, I simplified this example by not using zak, which is not really<br/>necessary here anyway. I changed the p-variables around because, while<br/>still a matter of personal taste, it is more &quot;standard&quot; to use p4 for<br/>loudness and p5 for pitch. I simplified the calculation of amplitude, which<br/>depends on four things: the envelope, p4, the maximum amplitude allowed in<br/>the instrument (assuming 0&lt;=p4&lt;=1), and the pan for each channel. These<br/>just need to be multiplied together at some point.</p><p>You were also using the tuning table as the waveform (the last parameter in<br/>the oscili statement), which does make a nice buzzy sound, but I inserted a<br/>new function table (#2) with a sine wave in it for the oscillator. For<br/>those of you following along, a point of clarification: the parameters in<br/>the tuning table (#1) are the decimal equivalents of the just ratios of<br/>your tuning system.</p><p>The way cps2pch then works is that it is given a pitch representation where<br/>the number to the left of the decimal point is the octave and the two<br/>numbers to the right of the decimal point are the step number, from 00 to<br/>however many steps there are minus 1. If the second parameter is negative,<br/>then it takes the 440 12TET tuning for C (261.6 hz) of the specified octave<br/>and multiplies it by the corresponding entry in the table whose number is<br/>the absolute value of the second parameter.</p><p>For example, let&apos;s take the second note above: 8.07. C of the 8th octave<br/>(in Csound terms) is 261.6 hz. Through the p5 variable, this note is passed<br/>to the statement ifreq cps2pch p5,-1. The -1 tells cps2pch to look up the<br/>pitch class in function table #1. The pitch class or step number is 7.<br/>Counting from zero, that corresponds to table entry 1.5. So, cps2pch<br/>returns 261.6*1.5 or 392.4 and puts it in the init-time variable ifreq.</p><p>If you don&apos;t want 261.6 as your 1/1, there are several things you can do.<br/>First, you could change your table entries so that another pitch was 1/1<br/>and the ratios before it were less than 1. For example, this table:</p><p>;table # start  size    gen fn   C          C#         D         Eb etc.<br/>f 1      0      16      -2       0.888889   .9481484   1.000000  1.066667<br/>1.111111   1.185185   1.280000   1.333333   1.422222   1.481482   1.555556<br/>1.666667</p><p>would produce the same scale, but with 1/1 transposed to D (9/8 above 261.6<br/>hz). It might be easier to just insert something like the following<br/>statement into your orchestra:</p><p>ifreq   =       ifreq*8/9       ; transpose 1/1 to D</p><p>I often use a global variable to set the pitch reference, so that it can be<br/>used in all instruments and even changed during the course of the piece if<br/>I want to modulate.</p><p>The above score and orchestra does render a sound file with the correct<br/>pitches on my machine. However, be careful about at least one thing when<br/>pasting the above code into your word processor. If some of the longer<br/>lines wrapped over and your email program put in hard carriage returns<br/>where they did, Csound will think a new line has started and evaluate it as<br/>a Csound statement, so be sure to take out those extra returns.</p><p>I hope this helps. Let me know if I&apos;m unclear about anything.</p><p>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br/>^ Bill Alves                                      email: <a href="mailto:alves@hmc.edu">alves@hmc.edu</a> ^<br/>^ Harvey Mudd College                 URL: <a href="http://www2.hmc.edu/~alves/">http://www2.hmc.edu/~alves/</a> ^<br/>^ 301 E. Twelfth St.                            (909)607-4170 (office) ^<br/>^ Claremont CA 91711 USA                           (909)607-7600 (fax) ^<br/>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p></div>