<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup tuning Re: Bassoon piano pitch bends</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/tuning">back to list</a><h1>Re: Bassoon piano pitch bends</h1><h3><a id=18654 href="#18654">ðŸ”—</a>Robert Walker &#x3C;robert_walker@rcwalker.freeserve.co.uk&#x3E;</h3><span>2/12/2001 11:36:01 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Just to say, I&apos;ve found the reason for the occasional stray &quot;partial&quot;</p><p>If you have several notes played simultaneously, and<br/>pitch bends applied before each one, Quicktime re-orders<br/>the messages so that all the pitch bends come first,<br/>and then all the notes are played.</p><p>Now suppose one of the notes is played in a channel<br/>that has a previously applied pitch bend in it, is immediately<br/>switched off with an all sound off, then another note is played in<br/>the same channel with a new pitch bend, all at the same moment of time.</p><p>Then Quicktime will apply the new pitch bend to the channel,<br/>then play both notes. It ignores the all sound offs in this<br/>case (don&apos;t know if it always does).</p><p>Result is, both notes are given a p.b. that should be applied<br/>to only one of them.</p><p>For instance, one of the partials was played at +43 cents instead<br/>of -9 cents.</p><p>Situation wouldn&apos;t normally occur, but is happening because<br/>the algorithm for finding the pitch bends needs a bit more work<br/>for the case of the custom voices.</p><p>I should do explicit note offs before the all sound off<br/>here, and also add a check to make sure that a note<br/>isn&apos;t switched off at the same instant that it is switched on.</p><p>There is a bug here too, as there are only ten bassoons<br/>playing for each note, so FTS should have been able to find enough<br/>free channels for them all to play in, and shouldn&apos;t have<br/>needed to use an all sound off.</p><p>I&apos;m not sure why Quicktime is re-ordering the messages,<br/>but may be connected with the fact that it also uses<br/>a pitch bend range of 24 semitones, and overrides<br/>the default pitch bend range of 2 semitones, even if<br/>you specify it explicitly in the midi file. At the<br/>same time, it divides all your pitch bends by 12.</p><p>The end result of this is that the pitch bends are the same, though<br/>one loses a tiny amount of precision as you then<br/>have a resolution of 0.3 cents instead of 0.02 cents<br/>for the midi file pitch bend data.</p><p>All I can find about this on the web is:</p><p><a href="http://devworld.apple.com/techpubs/quicktime/qtdevdocs/REF/tp_qtma_qtmaref.a.htm">http://devworld.apple.com/techpubs/quicktime/qtdevdocs/REF/tp_qtma_qtmaref.a.htm</a><br/>&quot;<br/>Pitch bend is specified in fractional semitones, which eliminates the restrictions of a<br/>pitch bend range. You can bend as far as you want, any time you want.<br/>&quot;<br/>I can&apos;t quite figure out why they have settled on a pitch bend range of +-24 semitones -<br/>why that particular figure.</p><p>Anyway, I&apos;ll fix it in the FTS beta.</p><p>Robert</p></div><h3><a id=18680 href="#18680">ðŸ”—</a>Graham Breed &#x3C;graham@microtonal.co.uk&#x3E;</h3><span>2/13/2001 3:30:18 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Tue, 13 Feb 2001, Robert Walker wrote:</p><p>&gt; I&apos;m not sure why Quicktime is re-ordering the messages,<br/>&gt; but may be connected with the fact that it also uses<br/>&gt; a pitch bend range of 24 semitones, and overrides<br/>&gt; the default pitch bend range of 2 semitones, even if<br/>&gt; you specify it explicitly in the midi file. At the<br/>&gt; same time, it divides all your pitch bends by 12.</p><p>The instructions for setting pitch bend range do depend on the order the<br/>messages get sent.  So that could be implicated.</p><p>But what does this mean?  Are pitch bends 24 semitones or 2?</p><p>&gt; The end result of this is that the pitch bends are the same, though<br/>&gt; one loses a tiny amount of precision as you then<br/>&gt; have a resolution of 0.3 cents instead of 0.02 cents<br/>&gt; for the midi file pitch bend data.</p><p>I thought the files I heard played through QuickTime were okay.</p><p>             Graham</p><p>&quot;I toss therefore I am&quot; -- Sartre</p></div><h3><a id=18681 href="#18681">ðŸ”—</a>Robert Walker &#x3C;robert_walker@rcwalker.freeserve.co.uk&#x3E;</h3><span>2/13/2001 6:44:52 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi  Graham,</p><p>Quicktime plays the pitch bends fine for a normal MIDI clip.</p><p>What it does is to reset the pitch bend range to +-24 semitones.</p><p>This in fact stays in effect after Quicktime exits, (it doesn&apos;t reset<br/>it to 2 semitones when finished) and you will hear<br/>the pitch bends are far too large, if you then play a normal<br/>midi clip on, say, media player, without resetting the pitch<br/>bend range.</p><p>Of course, this won&apos;t be a problem if you use the default<br/>Quicktime synth.</p><p>If you add pitch bend _range_ data to the midi clip, Quicktime<br/>passes that on unchanged (and with the messages in the correct<br/>sequence).</p><p>However, it then resets the pitch bend range to +-24 semitones<br/>later, before it plays any notes. So there is no way to get<br/>round that that I can see.</p><p>These messages<br/>:00 b0 65 00 ;channel 1 controller  - fine rpn 0 (pitch bend sensitivity)<br/>:00 b0 64 00 ;channel 1 controller  - coarse registered parameter number 0<br/>:00 b0 06 02 ;channel 1 controller Data Entry - coarse pitch bend range 2 semitones<br/>:00 b0 26 00 ;channel 1 controller Data Entry - fine pitch bend range 0 cents<br/>:00 b0 65 7f ;channel 1 controller  - fine rpn 127 (Null the active parameter numbre)<br/>:00 b0 64 7f ;channel 1 controller  - coarse registered parameter number 127<br/>from my MIDI file,</p><p>are followed by<br/>:00 b0 06 18 ;channel 1 controller Data Entry - coarse pitch bend range 24 semitones<br/>:00 b0 65 00 ;channel 1 controller  - fine rpn 0 (pitch bend sensitivity)<br/>:00 b0 06 18 ;channel 1 controller Data Entry - coarse pitch bend range 24 semitones<br/>:00 b0 26 00 ;channel 1 controller Data Entry - fine pitch bend range 0 cents<br/>:00 b0 64 7f ;channel 1 controller  - coarse registered parameter number 127<br/>:00 b0 65 7f ;channel 1 controller  - fine rpn 127 (Null the active parameter numbre)</p><p>which are inserted by Quicktime - none of this is in the MIDI file.</p><p>To compensate, Quicktime _rewrites_ all your pitch bend<br/>messages.</p><p>Each pitch bend you specify in the MIDI file is divided by<br/>12 in its effect before it is sent out. So for example, something like</p><p>:00 e0 32 35 ;ch. 1 pitch bend 6834 (-33.1543 cents)<br/>will be sent on as<br/>:00 e0 0f 3f ;ch. 1 pitch bend 8079 (-33.1055 cents)</p><p>Here 6834 =8192-1358 (8192 is the pitch bend zero pos.)<br/>Dividing by 12: 1358/12 = 113.16666..</p><p>So the new pitch bend is 8192-113 = 8079.</p><p>Pitch bend range is now +-24 semitones, so<br/>8079 = 8192-113 is  a pitch bend of -113*24/8192 semitones,<br/>i.e.-33.1055 cents.</p><p>Here one has lost only 0.05 cents of precision, but sometimes you<br/>lose more, up to 0.3 cents.</p><p>:00 ed 39 36 ;ch. 14 pitch bend 6969 (-29.8584 cents)<br/>-&gt;<br/>:00 ed 1b 3f ;ch. 14 pitch bend 8091 (-29.5898 cents)</p><p>End result : actual pitch bend is about the same, with slight<br/>loss of precision (only 0.3 cents, not enough to worry about!).</p><p>As well as doing this, it re-orders the pitch bends,<br/>placing them before all the note ons.</p><p>But on further reflection, that isn&apos;t the real reason for the<br/>stray partials, though it caused some puzzlement in debugging<br/>it.</p><p>The real reason is just that it leaves out the all sound off messages<br/>in the MIDI file altogether, and lets the preceding note continue to sound.</p><p>(if I had also had a note off at that point, it would have<br/>switched it off, I&apos;m sure)..</p><p>By removing the all sound off, I was able to duplicate the<br/>effect in FTS.</p><p>Have also now fixed it.</p><p>This clip should now play fine in Quicktime:</p><p>Here is a bassoon piano:<br/><a href="http://homepage.ntlworld.com/robertwalker/fts/bassoon_piano.mid">http://homepage.ntlworld.com/robertwalker/fts/bassoon_piano.mid</a></p><p>At some later stage (probably FTS 1.10) I will add decaying partials,<br/>following the decay of partials data from the bell analysis program.<br/>It should then sound more like a real piano.</p><p>Robert</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            