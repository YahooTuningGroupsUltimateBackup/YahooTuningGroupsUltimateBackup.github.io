<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup tuning Re: A mode room on line</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/tuning">back to list</a><h1>Re: A mode room on line</h1><h3><a id=15057 href="#15057">ðŸ”—</a>Robert Walker &#x3C;robert_walker@rcwalker.freeserve.co.uk&#x3E;</h3><span>10/25/2000 12:54:19 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Simon Sun,</p><p>&gt; We are still thinking about the design and operation. I agree that<br/>&gt; the<br/>&gt; file format is quite important, especially I have to include some<br/>&gt; discussions, reference information etc. So I am still thinking how<br/>&gt; should I put them - put into different files or can be in same file<br/>&gt; with proper enclosing on all the content. Robert&apos;s idea of the file<br/>&gt; types is quite useful to us and we&apos;ll take that into consideration.</p><p>Thanks, if there is any way I can help...</p><p>&gt;<br/>&gt; Actually, I&apos;m a bit curious about how the modes should be stored. Is<br/>&gt; it more useful if the ratios are in cents? If then, is it good for<br/>&gt; allowing users to enter cents only, or allow users to enter fraction?</p><p>Yes, this goes straight to one of the first questions one needs to<br/>ask as programmer during design stage.</p><p>The SCALA method is best, where a mode is stored as steps in<br/>an underlying scale.</p><p>Then you only need to define the mode once, and can use it for,<br/>e.g. any tempering of a 12 tone scale.</p><p>Now, some modes begin at other than first note of scale, e.g.<br/>some gamelan modes. Scala shows those using number in brackets<br/>[3] 1 1 2 1 2  Tembung<br/>(pelog mode)</p><p>In FTS, for data entry and showing mode, I require that first step<br/>is given, and it is 0 if mode starts at first note of scale</p><p>(I may add the [] notation as alternative format soon)</p><p>So then, assuming one uses that method, question is, are the scales entered in cents or ratios.</p><p>**************parsing of scale values***************************</p><p>It&apos;s no good just looking for the &apos;/&apos; symbol to tell which it is since<br/>one wants to be able to enter 2 on its own instead of 2/1 when typing the<br/>scale in as data, for speed - if user does that, don&apos;t want to call it<br/>2 cents!</p><p>Next idea is to have tick box to say if scale is in cents or ratios,<br/>but that is no good either as mixed notations are common.<br/>E.g. quarter comma mean-tone with the 5/4 in it, to take<br/>simple ex.<br/>Or 1/1 256/243 192.18 cents 32/27 390.225 cents 4/3 1024/729<br/>696.09 cents 128/81 888.27 cents 16/9 1092.18 cents 2/1<br/>for Werckmeister III.</p><p>So supposing one decides to accept mixed notation - best<br/>to do that - how does one know which is which.</p><p>One needs to be able to do it by checking if next token<br/>is the word &quot;cent&quot; or &quot;cents&quot;, since if the value is entered<br/>in that way, should be correct.</p><p>Also prog may show the word &quot;cents&quot; itself (or at least<br/>have option to do so), and the way<br/>edit boxes work in programs that use a Gui is that<br/>values displayed in them can be edited by the user<br/>and so must be acceptable values for input too.</p><p>So scale parsing is going to need look ahead,<br/>or something equivalent, though only<br/>by one token (I do it in FTS by reading value as ratio,<br/>then on reaching next token, if it says &quot;cents&quot;, re-interpret<br/>most recent value as in cents instead).</p><p>But it is too laborious to require user to type the<br/>entire word &quot;cents&quot; each time!</p><p>The way SCALA does it, values for scale defs<br/>can be in cents or as ratios. If the value has a decimal point in it,<br/>it is assumed to be in cents, which saves typing when entering<br/>values by hand.</p><p>FTS doesn&apos;t do that because of possibility, to<br/>display the ratio in decimal format, e.g. 1.25 for 5/4.<br/>Even though one will hardly ever choose to enter<br/>a scale in this format, one may want to choose to show<br/>it that way, and if one has that option, it has to be recognisable<br/>as input in a Gui.</p><p>So in FTS I added the abbreviation &apos;10 for 10 cents for data entry.</p><p>I.e prefix the number with the character &apos; or &grave;.</p><p>Here one could have a tick box - &quot;recognize cents by decimal pt&quot;<br/>which is automatically switched off, or better, disabled / hidden<br/>when one chooses to show ratios in decimal format. (I may add<br/>that as option to FTS come to think of it).</p><p>Clearly best to think over these issues really early on,<br/>prob. before one writes the first line of code!</p><p>If you want to be really sophisticated, do what Scala and FTS do,<br/>and build in a little equation parser into your program, so<br/>values can be entered using mathematical formulae.<br/>So you can use, e.g.</p><p>1/1 2^(1/31) for 31-tet</p><p>I could provide the c-source code for the FTS one - as I wrote it<br/>myself from scratch. It&apos;s quite small for such a thing (about 400<br/>or 500 lines of c-code), reasonably fast, and I could convert it to<br/>java and maybe include on my web site code snippets page as<br/>an ex. of how to do it.</p><p>At present it is limited to use of single character short cuts for<br/>mathematical functions, e.g. r3 for sqrt(3). But you could<br/>deal with that by a pre-parsing search and replace for<br/>mathematical functions, and maybe I&apos;ll do that too.</p><p>SCALA uses one generated by a compiler compiler<br/>type method, so you could do that too.</p><p>Then whenever you parse a number, you just need to pass<br/>the token to the equation parser, and use its return value<br/>as the parsed value for the token.</p><p>Like this:</p><p>c declaration of equ. parser:<br/>double parse_equation(char *token, BOOL value_is_in_cents);</p><p>Use of it:<br/>value = parse_equation( token, value_is_in_cents)</p><p>You will have to tell the parser whether the equation is for a value in cents, or for a pure ratio<br/>so it knows what to return.</p><p>You can just use it as a &quot;black box&quot;.</p><p>Another thing one needs to think about at the beginning, one doesn&apos;t want to assume, and hard code in, that scale repeats at octave.</p><p>That&apos;s because of, e.g. Bohlen-Pierce scale that repeats at 3/1</p><p>However another reason is that one will want to be able to define<br/>a scale that has repeating blocks using just one block,<br/>e.g.<br/>0 cents 38.709677 cents for 31-tet.</p><p>Rather than work out all the values for i = 1 to 31, if you<br/>allow scales that repeat at any interval, you can simply define<br/>the scale internally as<br/>1 1.0226114 (2 entries)</p><p>Another thing one needs to think about, one may well<br/>at some stage want to be able to enter scales<br/>as harmonics:<br/>4 5 6 for 1/1 5/4 3/2</p><p>*****************harmonic series as a scale*********************</p><p>In FTS, I include a method of defining a harmonic series<br/>using an additive definition, which may poss. be of<br/>interest?-</p><p>here it is<br/>---------------------------------------------------</p><p>In FTS, you need to enter the 1/1 - or 1 for short - that begins the scale<br/>(in SCALA it is left out, and scale is assumed to start at 1/1),</p><p>If first entry is anything other than 1, scale is taken as giving an additive<br/>definition.</p><p>For instance you can define the harmonic series as:</p><p>2</p><p>The number 2 is the frequency of the first harmonic, as a multiple of the frequency of the<br/>fundamental.</p><p>The harmonic series is then found by repeatedly adding the frequency difference between the<br/>fundamental and the first harmonic.</p><p>For instance, the harmonic series starting at A is</p><p>440, 2*440, 3*440, 4*440, 5*440, ... adding 440 each time.</p><p>I define negative numbers for the mode in harmonic series scale as an upside down harmonic series:</p><p>1 1/2 1/3 1/4 1/5 1/6 ....</p><p>In the same notation, 1+1/5 would be short for a first &quot;harmonic&quot; of 1+1/5, i.e. a generalised<br/>harmonic series of</p><p>1, 1+1/5, 1+2/5, 1+3/5, ...</p><p>or starting at 440,</p><p>440, 440+(440/5), 440+(2*440/5), 440+(3*440/5),...</p><p>Since 6/5 is the ratio of the sixth to the fifth harmonic, this gives the harmonic series from the fifth<br/>harmonic of fundamental at 88 hz upwards.</p><p>The upside down series will be</p><p>1 1/(1+1/5), 1/(1+2/5),....</p><p>Any ratios of the form (n+1)/n will give successive members of the harmonic series from the nth<br/>harmonic upwards.</p><p>Other ratios like 5/3 or 11/9 also pick out members of the harmonic series, with gaps. For instance<br/>5/3 picks out every other harmonic from the 3rd upwards.</p><p>----------------------end of additive scale def-----------------------------</p><p>Anyway, however one does it, one will prob. at some point in the future want<br/>to have a way of using the harmonic series itself as the underlying scale for use in &quot;mode&quot;<br/>definitions.</p><p>Could just be a tick box, &quot;scale is harmonic series&quot; - much easier to program prob..</p><p>Then major chord is<br/>4 1 1 (step notation - 4 5 6 in degree notation)</p><p>in harmonic series scale,</p><p>or<br/>0 1 1 (step notation)<br/>in the harmonic series defined as</p><p>4/3<br/>in my additive def.</p><p>(could also be defined as 4 = 1st harmonic + 1 = step in harmonic series scale def, and<br/>enter the values 4, and 1 into suitable boxes)</p><p>5  6 7 8 9 10<br/>is David Canright&apos;s equal frequency differences pentatonic scale,<br/>or</p><p>0 1 1 1 1 1 (step notation)<br/>0 1 2 3 4 5<br/>in scale<br/>5/4 (additive def)</p><p>...<br/>Can prob. leave the harmonic series def till late in project, but good<br/>to bear in mind that it might be needed at some point in the<br/>future when working on the basic design.</p><p>I implement the harmonic series internally as a scale def like all the<br/>others, and only go up to some large number in the series.<br/>(at present, use array of 1000 values for scale defs, which has been fine<br/>for all the ones encountered so far)</p><p>Another consideration is, how to internally store the numbers for the scale<br/>def.</p><p>*********internal storage of ratios and cents values**************</p><p>I don&apos;t know how SCALA does it. In FTS, I just store them as doubles<br/>(= c prog. language high precision floating point)<br/>e.g. as 1.25 for 5/4.</p><p>Then for display, I use the (v. fast) continued fraction algorithm<br/>which by a number theory theorem gives a closer ratio to<br/>any floating point number than any other ratio with same size<br/>quotient or smaller.</p><p>So it uses this algorithm on 1.25 and comes up with 5/4 as factorisation.</p><p>Even for a difficult case like<br/>1.1494390589260</p><p>it reaches the ratio v. quickly:<br/>7/6 8/7 23/20 923/803 1946/1693 2869/2496 7684/6685 10553/9181</p><p>However if you do it that way, you have to bear in mind that<br/>some et scale steps happen to be rather close to pure ratios:</p><p>Ex.<br/>419914/404871 happens to be within 1e-12 of 2^(1/19) - step for 19-tet.</p><p>FTS deals with this by restricting the max factor to use<br/>in the denominator / denumerator (requires them to be<br/>at most 50 limit, with option to change that value)</p><p>419914/404871= 2*11*19087/(3*19*7103)<br/>which is decidedly _not_ 50 limit, so shows value in<br/>cents.</p><p>Similarly,<br/>2^2*3*7*7789/(31*20639)<br/>is within 1e-12 of step for 31-tet.</p><p>In practice, this hasn&apos;t turned up any stray pure ratios<br/>for et scales, so it works.</p><p>Does need a limit on size of denominator as well or you<br/>will eventually get some ratios close to et degrees.</p><p>I use<br/>100,000,000<br/>as max denominator in FTS and that hasn&apos;t turned up any<br/>stray pure ratios to date.</p><p>Other way round, it always finds the ratio if it _is_ a pure ratio, by the<br/>theorem that continued fractions method finds the optimal ratio<br/>for its size of quotient mentioned above.</p><p>Would be nice if one could prove some theorem<br/>to show that it will always work:</p><p>---------theorem it would be nice to prove-----------</p><p>Objective - to find values of epsilon, k, N and n such that<br/>there are no k-limit ratios with max quotient N within epsilon<br/>of any et scale degree in any m-tet for m less than n.</p><p>However such results are likely to be extremely hard<br/>to prove, as some simple questions about irrationality<br/>remain unsolved in Number theory, though many general<br/>cases have been cracked.</p><p>For instance I&apos;ve just done a web search for e and pi,<br/>and found that it is known that e*pi is irrational, but it is still not<br/>known if e+pi is is rational or irrational.</p><p><a href="http://www.math.niu.edu/~rusin/known-math/98/pi_e">http://www.math.niu.edu/~rusin/known-math/98/pi_e</a><br/>(author&apos;s web site <a href="http://www.seanet.com/~ksbrown/">http://www.seanet.com/~ksbrown/</a>)</p><p>Interesting situation:<br/>&gt;THEOREM. e + pi is irrational or e - pi is irrational.<br/>&gt;<br/>&gt;Proof: Suppose e + pi and e - pi are rational. Then by addition, 2e is<br/>&gt;rational. Contradiction.<br/>&gt;<br/>- that&apos;s from<br/><a href="http://www.math.psu.edu/simpson/fom/postings/0006/msg00101.html">http://www.math.psu.edu/simpson/fom/postings/0006/msg00101.html</a></p><p>Unless we are lucky. Sometimes you find someone has proved a theorem<br/>that just gives you what you want.</p><p>------------end of theorem wish list---------------------</p><p>Could do computer search of all et scales up to 183 (largest<br/>number in SCALA mode names file) however, and<br/>I think I might do that, having thought of it.</p><p>If you want to use the continued fractions method to find ratio from<br/>double, again you are welcome to use my subroutine converted to<br/>java, and I could add it to my Windows C snippets page.</p><p>Alternative would be to store ratios internally as a pair of integers,<br/>and that may be something to consider at design stage.</p><p>Anyway, sure that&apos;s given lots to think over, good luck with the design<br/>stage.</p><p>I often spend a long time on the design stage - sign of some maturity<br/>in programming I hope.</p><p>So often happens that by waiting a few more days, you get an idea<br/>for the design that is going to save maybe weeks of work when you<br/>get down to the coding.</p><p>And once you&apos;ve got a reasonable body of code written, it can be<br/>pretty difficult to change the basic design, should it become necessary.</p><p>Robert</p></div><h3><a id=15068 href="#15068">ðŸ”—</a>Joseph Pehrson &#x3C;josephpehrson@compuserve.com&#x3E;</h3><span>10/25/2000 6:25:20 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning@egroups.com">tuning@egroups.com</a>, &quot;Robert Walker&quot; &lt;robert_walker@r...&gt; wrote</p><p><a href="http://www.egroups.com/message/tuning/15057">http://www.egroups.com/message/tuning/15057</a></p><p>&gt;<br/>&gt; The way SCALA does it, values for scale defs<br/>&gt; can be in cents or as ratios. If the value has a decimal point in<br/>it, it is assumed to be in cents, which saves typing when entering<br/>&gt; values by hand.<br/>&gt;</p><p>Hello Robert!</p><p>I believe EVERY &quot;cents&quot; input for SCALA *MUST* have a period, called<br/>a &quot;full stop&quot; in the manual (by Manuel), correct??</p><p>&gt; FTS doesn&apos;t do that because of possibility, to<br/>&gt; display the ratio in decimal format, e.g. 1.25 for 5/4.<br/>&gt; Even though one will hardly ever choose to enter<br/>&gt; a scale in this format, one may want to choose to show<br/>&gt; it that way, and if one has that option, it has to be recognisable<br/>&gt; as input in a Gui.<br/>&gt;</p><p>I guess I&apos;m missing something very obvious, but I don&apos;t really<br/>understand why it would be so important to enter or show 5/4 as 1.25.<br/>It surely makes all the rest of things MUCH more complicated.</p><p>It it really worth it, given the fact that, generally speaking, a<br/>scale will either be entered in fractions or in cents (??)</p><p>Am I missing something obvious??</p><p>_____________ ____ _ __<br/>Joseph Pehrson</p></div><h3><a id=15080 href="#15080">ðŸ”—</a>Robert Walker &#x3C;robert_walker@rcwalker.freeserve.co.uk&#x3E;</h3><span>10/25/2000 9:13:15 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Joseph,</p><p>&gt;I guess I&apos;m missing something very obvious, but I don&apos;t really<br/>&gt;understand why it would be so important to enter or show 5/4 as 1.25.<br/>&gt;It surely makes all the rest of things MUCH more complicated.</p><p>&gt;It it really worth it, given the fact that, generally speaking, a<br/>&gt;scale will either be entered in fractions or in cents (??)</p><p>Yes, I agree that one will hardly ever use it to enter scales.</p><p>It is v. useful for showing scales while debugging since internally<br/>all the values are shown as decimals.</p><p>Also as mathematician, I like to be able to see them in that<br/>format on occasion.</p><p>Another ex., though one mightn&apos;t want to use decimal format<br/>on it&apos;s own, maybe one might want to be able to use it in a<br/>formula, e.g. for golden section. I have used it that way<br/>to enter a scale I read about constructed from golden section.</p><p>One could use (1+r5)/2 for golden section of course.</p><p>I may also add in a special abbrev. for golden section.</p><p>Generally, allowing for decimal point makes it a bit open ended<br/>if anyone wants to use one ever.</p><p>I&apos;ll certainly retain it in FractalTS, but I could make option to<br/>recognise values in decimal format something one can switch on / off from<br/>File | Number Options, and default it to off.</p><p>Since I&apos;ve already done the coding, and it is sometimes useful,<br/>may as well leave it in, but with option to switch it off.</p><p>Then when switched off, you can use Scala convention to<br/>enter value in cents by including period.</p><p>I&apos;ll prob. do that.</p><p>On the whole, prob. best regarded as an eccentricity of mine, not nec.<br/>to be copied.</p><p>Would simplify scale parsing since one wouldn&apos;t need to look ahead<br/>for the cents token, just ignore it if found.</p><p>I&apos;m not sure if I would do it the way I have if starting from scratch again<br/>now. Actually, I think I probably would, - the maths, and the debugging<br/>advantages are both pretty good reasons for including it</p><p>But it is certainly not really worth it if one feels it will add much complexity to the program design or the user interface.</p><p>Robert</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            