<a href="/tuning">back to list</a><h1>Brain shifters [was: Infinitely recursive perverts....]</h1><h3>J. Scott &#x3C;cgscott@xxxxxxx.xxxx&#x3E;</h3><span>5/16/1999 12:57:43 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Ray Tomes wrote:<br/>&gt; If the frequencies are to be multiplied by 50 to 100 and it is done in<br/>&gt; real time, then clearly the speed up factor cannot be applied (as it is<br/>&gt; real time) and so in effect each little moment is played 100 times<br/>&gt; before moving onto the next.  I say in effect because the phases of the<br/>&gt; waveforms must keep on developing correctly which is not trivial.  This<br/>&gt; requires understanding how to use FFT software and a fair bit of<br/>&gt; programming, although there may be alternative approaches.<br/>                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br/>FFT is only necessary if you want to do fancy stuff like formant<br/>correction (to un-chipmunkize). That&apos;s not necessary for this<br/>application.</p><p>The easy way to do it in real time is just use a standard<br/>pitch shift algorithm. Let&apos;s say you need to shift the brainwaves<br/>up by 3 octaves - a factor of 8. So we grab snippets and<br/>each snippet will get played 8 times at a rate of 8 times the<br/>original.</p><p>Here&apos;s 4 &quot;100ms&quot; segments from the original sound<br/>(segment length depends on application - experiment to find out):</p><p>Original sound:</p><p>1.......2.......3.......4.......</p><p>0      0.8      1.6     2.4  seconds</p><p>so shifted 3 octaves up it would go:</p><p>11111111222222223333333344444444</p><p>0      0.8      1.6     2.4  seconds</p><p>(the stuff in the original where the dots are is tossed out)</p><p>But the end of segment 1 and its beginning don&apos;t line<br/>up - giving distortion! Same for segment&apos;s 2, 3, and 4.</p><p>Solution - play each segment back with another copy<br/>of itself, delayed 50ms. Use two envelopes to window<br/>these two copies so that most of the time only one is playing<br/>back, and they quickly fade in and out near the end<br/>of the sound.</p><p>This whole gizmo can be easily implemented with a<br/>delay line written to by the input. Two delay taps<br/>read the delay line from different locations (180<br/>degrees out of phase with respect to the delay line<br/>length). The delay line readers read at a different<br/>frequency frem the delay line writer. As the<br/>output pointer is about to cross the input<br/>pointer, it is ramped out and the other wave<br/>reader is ramped in.</p><p>The craft is in picking the shape of the ramping<br/>envelope (also called the &quot;overlap-add window&quot;)<br/>and deciding how big to make the delay line.<br/>Experimentation is the key here.</p><p>- Jeff</p></div>