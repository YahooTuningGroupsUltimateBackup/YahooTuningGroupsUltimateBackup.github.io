<a href="/tuning">back to list</a><h1>MIDI engine spec, FTS, lists rock</h1><h3><a id=1054 href="#1054">ðŸ”—</a>Carl Lumma &#x3C;carl@...&#x3E;</h3><span>8/27/2001 5:33:27 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Howdy, all-</p><p>Just dropping by to post the spec for the &apos;root control&apos;<br/>program Robert Walker and I were discussing here a few<br/>weeks ago.  I&apos;ve been milling over this since 1996, when<br/>Denny Genovese and I were discussing it.  Finally, I have<br/>in writing a reasonably-specific idea of what I want, and<br/>I thought I&apos;d share it with y&apos;all.</p><p>The good news is that the next version of Robert&apos;s Fractal<br/>Tune Smithy software, together with your favorite sequencer,<br/>will support almost all the behavior described in this<br/>spec... in addition to a bunch of cool stuff Robert&apos;s<br/>cooked up, inspired by CPS&apos;s.  But I don&apos;t want to spoil<br/>all the surprises... Let&apos;s just say that if everything works<br/>out, for the first time ever you won&apos;t have to pay $$$ for<br/>a Kurzweil synth to do this.  Look out, Wendy Carlos!</p><p>I&apos;m also going to post about this on the Tuning List.  I&apos;m<br/>un-subscribing from this list as soon as this post goes<br/>through, so please respond over there.  Or, send mail<br/>directly -- carl_lumma.org ... Just swap the _ for an @.</p><p>Cheers!</p><p>------------------------------------------------------------------------<br/>Xenharmonic Moving Windows                              26 August, 2001<br/>  MIDI engine spec</p><p>Introduction:</p><p> This document describes a procedure for applying tunings with more than<br/>twelve pitches per octave to MIDI instruments.  In particular, it aims<br/>to present these tunings twelve pitches at a time, in order to<br/>facilitate their use by composers and instrumentalists having access to<br/>and experience with the tools of traditional 12-note music... such as<br/>notation and ear training, keyboards and fingering, staff paper and<br/>sight-reading, and so on.</p><p> The procedure defines two different types of MIDI channels -- &quot;control&quot;<br/>channels and &quot;window&quot; channels.  Window channels make up the musician&apos;s<br/>12-note view of the larger virtual tuning, while control channels allow<br/>him to move this window around in the virtual tuning.  The procedure is<br/>described in the context of a software implementation for Microsoft<br/>Windows.</p><p> The software uses both Pitch bend and MTS Sysex for tuning MIDI<br/>instruments.  Pitch bend is supported by nearly all MIDI instruments,<br/>but requires twelve window channels on a single instrument for mono-<br/>timbral performance.^1  MTS Sysex is supported by a smaller variety of<br/>MIDI instruments, but requires only a single window channel for mono-<br/>timbral performance.  In either case, multitimbral performance may be<br/>achieved by using more than one MIDI instrument.^2</p><p> This document distinguishes between pitches and intervals.  Pitches are<br/>written as octave-equivalent ratios with a slash, relative to a given<br/>reference frequency.  Intervals are written as octave-equivalent ratios<br/>with a colon, measured from a given reference pitch.  So &quot;5/4&quot; refers to<br/>a particular frequency, while &quot;5:4&quot; refers to a distance from a given<br/>pitch... &quot;25/16 is found a 5:4 above 5/4&quot;.</p><p>Output:</p><p> (1) MIDI stream.<br/>&#x9;The software should present itself to Windows as a MIDI device,<br/>&#x9;taking MIDI-in from other Windows MIDI devices and sending<br/>&#x9;Windows-friendly MIDI-out in real time.  The total turn-around<br/>&#x9;time (&quot;latency&quot;) should be less than 10 ms.</p><p> (2) Save-to-file. (.mid)<br/>&#x9;The software has a MIDI stream buffer, which may be dumped to a<br/>&#x9;General MIDI file using standard MFC &quot;save-as&quot; dialogs.</p><p> (3) Save-to-file. (.txt)<br/>&#x9;The software generates a standard text file from the MIDI<br/>&#x9;buffer, showing the final tuning of each event on the window<br/>&#x9;channel(s) as cents deviation from 12-tET, on a tick-by-tick<br/>&#x9;basis.</p><p> (4) Save-to-file. (.scl)<br/>&#x9;The window intervals may saved as a Scala file.</p><p>Input:</p><p> (1) Tuning reference. (1-128)<br/>&#x9;The given MIDI note and its default pitch are taken as a<br/>&#x9;reference point.</p><p> (2) Window intervals. (.scl)<br/>&#x9;A size-ordered list of twelve octave-equivalent intervals, given<br/>&#x9;in cents 1 -&gt; 1199 and/or proper fractions 99:98 -&gt; 99:50.<br/>&#x9;These intervals and their octave equivalents are applied to the<br/>&#x9;reference pitch in (1) and mapped to consecutive MIDI notes to<br/>&#x9;create the initial scale for the window channel(s).  The window<br/>&#x9;intervals may be populated from standard Scala files (.scl) when<br/>&#x9;they define exactly 12 notes (else they should return an error).</p><p> (3) Retune type. (Pitch bend/MTS)<br/>&#x9;For each Windows MIDI instrument, the user selects either Pitch<br/>&#x9;bend or MTS.</p><p> (4) MIDI channel setup.<br/>&#x9;The software displays two empty sequencer-style track sheets,<br/>&#x9;one for window channels and one for control channels.  The user<br/>&#x9;populates these with MIDI channels from the devices defined in<br/>&#x9;(3).  A given MIDI channel can only appear in one sheet.  For<br/>&#x9;pitch-bend devices, twelve channels at a time are acquired by<br/>&#x9;the window channel sheet, where a bracket displays them as a<br/>&#x9;group and gangs their settings together.</p><p> (5) MIDI channel settings.<br/>&#x9;The window-channels sheet contains the following settings:<br/>&#x9;mute, volume, pan, patch.  They function as they would in a<br/>&#x9;standard MIDI sequencer, and default to: off, 63, 63, and<br/>&#x9;patch 001, respectively.</p><p>&#x9;The control-channels sheet contains the following settings:<br/>&#x9;mute, &quot;window channel #&quot;, and &quot;control type&quot;, which default to:<br/>&#x9;on, &quot;none&quot;, and &quot;none&quot;, respectively.</p><p>&#x9;When mute for a control channel is switched off, events sent on<br/>&#x9;the channel are copied into the channel specified in its &quot;window<br/>&#x9;channel #&quot; field, immediately after having the control effect<br/>&#x9;specified in its &quot;control type&quot; field.  A &quot;window channel #&quot;<br/>&#x9;must be specified to enable the mute field.</p><p>&#x9;The &quot;control type&quot; field has the following possible values:<br/>&#x9;&quot;none&quot;, &quot;diamond&quot;, &quot;diamondrel&quot;, &quot;cross&quot;, and &quot;crossfree&quot;.</p><p>&#x9;If &quot;none&quot;, events on the control channel do nothing to the<br/>&#x9;window pitches.</p><p>&#x9;If &quot;diamond&quot;, the choice of a note from the control channel is<br/>&#x9;the choice of a position in the original list of window<br/>&#x9;intervals.  The list is rotated to this position and applied to<br/>&#x9;the reference pitch in (1) to generate new window pitches.^3</p><p>&#x9;If &quot;diamondrel&quot;, the choice of a note from the control channel<br/>&#x9;is the choice of a position in the current list of window<br/>&#x9;intervals.  The list is rotated to this position and applied to<br/>&#x9;the reference pitch in (1) to generate new window pitches.^4</p><p>&#x9;If &quot;cross&quot;, the choice of a note from the control set is the<br/>&#x9;choice of a pitch -- the pitch found on that note in the initial<br/>&#x9;window mapping created in (2).  This pitch is placed into (1),<br/>&#x9;and the window pitches are rebuilt accordingly.^5</p><p>&#x9;If &quot;crossfree&quot;, things happen as in &quot;cross&quot;, except the new<br/>&#x9;reference pitch for (1) is taken from the current -- as opposed<br/>&#x9;to the initial -- window mapping.^6</p><p> (6) Retune sounding notes? (Yes/No)<br/>&#x9;When =Yes, tuning changes are applied to notes only at note-on.<br/>&#x9;Implementation must support the issue of multiple tuning changes<br/>&#x9;while a note is sounding, and apply only the last (most recent)<br/>&#x9;tuning when the note finally gets a new note-on.^7</p><p>Final Thoughts:</p><p> It is natural to imagine using this software with an organ, where the<br/>pedal is assigned to a control channel... with score entry software,<br/>where a particular staff may be assigned to a control channel...  We<br/>suggest supporting a maximum of two simultaneous control channels; up to<br/>one each from the &quot;cros_&quot; and &quot;diam_&quot; types.</p><p> The author would like to recognize Denny Genovese&apos;s contribution to the<br/>ideas presented here, and note that a similar strategy has been used by<br/>Wendy Carlos and was implemented on Kurzweil K2000 series MIDI equipment<br/>at her request.</p><p> This document was inspired by a discussion with Robert Walker on the<br/>crazy_music mailing list (<a href="http://groups.yahoo.com/">http://groups.yahoo.com/</a>), and a version of<br/>the procedure described here is implemented in his Fractal Tune Smithy<br/>software (<a href="http://go.to/tunesmithy/">http://go.to/tunesmithy/</a>).</p><p>Footnotes:</p><p> ^1  Sequential window events are sent to the &quot;least busy&quot; of these<br/>channels.</p><p> ^2  Or by using a single multitimbral instrument with MTS, or pitch<br/>bend when at least 24 channels are available.</p><p> ^3  The total tuning available to the musician with a single &quot;diamond&quot;<br/>control channel is the Partchian tonality diamond of the original window<br/>intervals.  The reference note in (1) will always be the diamond&apos;s 1/1.</p><p> ^4  This variant gives access to the same total tuning as &quot;diamond&quot;,<br/>but offers a different way to think about the roots -- they are given<br/>relative to the window set currently in use, rather than to the original<br/>window set.</p><p> ^5  This option confines the total tuning to the Cartesian cross<br/>product of the window intervals, with a maximum of 78 pitches (because<br/>the Cartesian cross product has a plane of mirror symmetry, the maximum<br/>number of pitches needed to play in every key of a scale with n notes is<br/>not n^2 but n(n+1)/2 -- the classic formula for the sum of natural<br/>numbers up to n).</p><p> ^6  The result is similar to that of &quot;cross&quot;, except the total tuning<br/>is unbounded, and the pitch at the chosen note will never change as a<br/>result of the choice.</p><p> ^7  When the window intervals are in just intonation, =No facilitates<br/>&quot;crunchy&quot; (Keenan Pepper&apos;s term) suspended chords.</p><p>-=Carl Lumma<br/>Berkeley, California</p><p>------------------------------------------------------------------------</p></div><h3><a id=1055 href="#1055">ðŸ”—</a>Robert Walker &#x3C;robertwalker@...&#x3E;</h3><span>8/27/2001 6:54:57 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>HI there,</p><p>just to say, I&apos;ll be doing it as the FTS preview first, so you can all have an<br/>advance look at it and give it a try; thought it might be poss. by today, but<br/>seems it will be more like tomorrow.</p><p>I&apos;ll say more about what exactly you can do then by way of root control options<br/>and some CPS set things.</p><p>Robert</p></div>