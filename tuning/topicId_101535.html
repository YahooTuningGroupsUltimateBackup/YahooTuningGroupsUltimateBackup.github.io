<a href="/tuning">back to list</a><h1>Making a javascript tuning theory library</h1><h3><a id=101535 href="#101535">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/3/2011 7:42:11 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Preliminary consideration: Javascript allows you to create arrays<br/>using [] literals. For example:</p><p>var syntonic = [-4, 4, -1];<br/>var meantone = [[1, 1, 0], [0, 1, 4]];</p><p>A question: which of the following programming conventions would you<br/>find to be most sensible?</p><p>Convention 1 (object-oriented, strongly typed):<br/>var twelveequal = new Val([12, 19, 28]);<br/>var nineteenequal = new Val([19, 30, 44]);<br/>var meantone = new Temperament(twelveequal, nineteenequal);<br/>var syntonic = new Monzo([-4, 4, -1]);<br/>alert(<a href="http://meantone.map">meantone.map</a>(syntonic)); //should alert &quot;(0, 0)&quot;</p><p>Convention 2 (procedural, loosely typed):<br/>var twelveequal = [12, 19, 28];<br/>var nineteenequal = [19, 30, 44];<br/>var meantone = [twelveequal, nineteenequal];<br/>var syntonic = [-4, 4, -1];<br/>alert(map(meantone, syntonic));</p><p>I&apos;m leaning towards convention #1. Any thoughts?</p><p>-Mike</p></div><h3><a id=101543 href="#101543">ðŸ”—</a>Wolf Peuker &#x3C;wolfpeuker@...&#x3E;</h3><span>9/5/2011 3:04:47 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Mike,<br/>great idea, really!</p><p>Am 04.09.2011 04:42, schrieb Mike Battaglia:<br/>&gt;<br/>&gt; A question: which of the following programming conventions would you<br/>&gt; find to be most sensible?<br/>&gt;<br/>&gt; Convention 1 (object-oriented, strongly typed):<br/>&gt; var twelveequal = new Val([12, 19, 28]);<br/>&gt; var nineteenequal = new Val([19, 30, 44]);<br/>&gt; var meantone = new Temperament(twelveequal, nineteenequal);<br/>&gt; var syntonic = new Monzo([-4, 4, -1]);<br/>&gt; alert(<a href="http://meantone.map">meantone.map</a>(syntonic)); //should alert &quot;(0, 0)&quot;<br/>&gt;<br/>&gt; Convention 2 (procedural, loosely typed):<br/>&gt; var twelveequal = [12, 19, 28];<br/>&gt; var nineteenequal = [19, 30, 44];<br/>&gt; var meantone = [twelveequal, nineteenequal];<br/>&gt; var syntonic = [-4, 4, -1];<br/>&gt; alert(map(meantone, syntonic));<br/>&gt;<br/>&gt; I&apos;m leaning towards convention #1. Any thoughts?<br/>&gt;<br/>&gt; -Mike<br/>&gt;<br/>I&apos;d prefer #1, because its naming capabilities are richer.</p><p>Where do want to &quot;host&quot; it? Can I help you here anyway?<br/>I hope to find all in the source that I don&apos;t get in the xenwiki. :)</p><p>--Wolf</p></div><h3><a id=101544 href="#101544">ðŸ”—</a>genewardsmith &#x3C;genewardsmith@...&#x3E;</h3><span>9/5/2011 3:26:48 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Wolf Peuker &lt;wolfpeuker@...&gt; wrote:</p><p>&gt; I hope to find all in the source that I don&apos;t get in the xenwiki. :)</p><p>All? There&apos;s a hell of a lot involved in programming &quot;all&quot;. How ambitious is this project?</p></div><h3><a id=101545 href="#101545">ðŸ”—</a>Wolf Peuker &#x3C;wolfpeuker@...&#x3E;</h3><span>9/5/2011 5:14:13 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Am 05.09.2011 12:26, schrieb genewardsmith:<br/>&gt;<br/>&gt;<br/>&gt; --- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Wolf Peuker &lt;wolfpeuker@...&gt; wrote:<br/>&gt;<br/>&gt;&gt; I hope to find all in the source that I don&apos;t get in the xenwiki. :)<br/>&gt;<br/>&gt; All? There&apos;s a hell of a lot involved in programming &quot;all&quot;. How ambitious is this project?<br/>&gt;<br/>Ok &quot;some&quot; I would have probably written better. Let&apos;s see - I believe,<br/>it will grow over time (if it runs once).</p><p>Admittedly, I find it very difficult to understand the mathematical<br/>notation, but using the source code I can go back to Adam and Eve if<br/>necessary.</p><p>--Wolf</p></div><h3><a id=101547 href="#101547">ðŸ”—</a>genewardsmith &#x3C;genewardsmith@...&#x3E;</h3><span>9/5/2011 8:32:03 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Wolf Peuker &lt;wolfpeuker@...&gt; wrote:<br/>&gt;<br/>&gt; Am 05.09.2011 12:26, schrieb genewardsmith:<br/>&gt; &gt;<br/>&gt; &gt;<br/>&gt; &gt; --- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Wolf Peuker &lt;wolfpeuker@&gt; wrote:<br/>&gt; &gt;<br/>&gt; &gt;&gt; I hope to find all in the source that I don&apos;t get in the xenwiki. :)<br/>&gt; &gt;<br/>&gt; &gt; All? There&apos;s a hell of a lot involved in programming &quot;all&quot;. How ambitious is this project?<br/>&gt; &gt;<br/>&gt; Ok &quot;some&quot; I would have probably written better. Let&apos;s see - I believe,<br/>&gt; it will grow over time (if it runs once).<br/>&gt;<br/>&gt; Admittedly, I find it very difficult to understand the mathematical<br/>&gt; notation, but using the source code I can go back to Adam and Eve if<br/>&gt; necessary.</p><p>I&apos;ve got a lot of Maple code, and Graham has Python script.</p></div><h3><a id=101551 href="#101551">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/5/2011 10:54:17 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Mon, Sep 5, 2011 at 6:26 AM, genewardsmith<br/>&lt;genewardsmith@...&gt; wrote:<br/>&gt;<br/>&gt; --- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Wolf Peuker &lt;wolfpeuker@...&gt; wrote:<br/>&gt;<br/>&gt; &gt; I hope to find all in the source that I don&apos;t get in the xenwiki. :)<br/>&gt;<br/>&gt; All? There&apos;s a hell of a lot involved in programming &quot;all&quot;. How ambitious is this project?</p><p>It&apos;s not ambitious at all. Once I get vals and monzos coded up, which<br/>is pretty easy, it&apos;s obviously not too complicated to afterwards code<br/>up an &quot;apply homomorphism&quot; function, and a wedge product function, and<br/>a complement function, and a normal val list function, and a TE norm<br/>function, etc. It&apos;ll be pretty straightforward and I&apos;ll learn a lot by<br/>having to recode this stuff.</p><p>-Mike</p></div><h3><a id=101552 href="#101552">ðŸ”—</a>Carl Lumma &#x3C;carl@...&#x3E;</h3><span>9/5/2011 11:02:31 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>In my opinion, Convention 1 is a classic case of too<br/>much structure too soon and indeed, of OO (a good approach<br/>for writing simulations, but not particularly for anything<br/>else) gone wrong.  -Carl</p><p>--- In tuning@...m, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; Preliminary consideration: Javascript allows you to create arrays<br/>&gt; using [] literals. For example:<br/>&gt;<br/>&gt; var syntonic = [-4, 4, -1];<br/>&gt; var meantone = [[1, 1, 0], [0, 1, 4]];<br/>&gt;<br/>&gt; A question: which of the following programming conventions would you<br/>&gt; find to be most sensible?<br/>&gt;<br/>&gt; Convention 1 (object-oriented, strongly typed):<br/>&gt; var twelveequal = new Val([12, 19, 28]);<br/>&gt; var nineteenequal = new Val([19, 30, 44]);<br/>&gt; var meantone = new Temperament(twelveequal, nineteenequal);<br/>&gt; var syntonic = new Monzo([-4, 4, -1]);<br/>&gt; alert(<a href="http://meantone.map">meantone.map</a>(syntonic)); //should alert &quot;(0, 0)&quot;<br/>&gt;<br/>&gt; Convention 2 (procedural, loosely typed):<br/>&gt; var twelveequal = [12, 19, 28];<br/>&gt; var nineteenequal = [19, 30, 44];<br/>&gt; var meantone = [twelveequal, nineteenequal];<br/>&gt; var syntonic = [-4, 4, -1];<br/>&gt; alert(map(meantone, syntonic));<br/>&gt;<br/>&gt; I&apos;m leaning towards convention #1. Any thoughts?<br/>&gt;<br/>&gt; -Mike<br/>&gt;</p></div><h3><a id=101553 href="#101553">ðŸ”—</a>Graham Breed &#x3C;gbreed@...&#x3E;</h3><span>9/5/2011 12:35:38 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; Convention 1 (object-oriented, strongly typed):<br/>&gt; var twelveequal = new Val([12, 19, 28]);<br/>&gt; var nineteenequal = new Val([19, 30, 44]);<br/>&gt; var meantone = new Temperament(twelveequal,<br/>&gt; nineteenequal); var syntonic = new Monzo([-4, 4, -1]);<br/>&gt; alert(<a href="http://meantone.map">meantone.map</a>(syntonic)); //should alert &quot;(0, 0)&quot;</p><p>A Temperament object should involve a prime limit as well<br/>as a mapping.  You can then make error and complexity<br/>methods of the Temperament class.  Having a single<br/>Temperament object, instead of a different one for each<br/>rank, is also a good idea.  You might still need<br/>rank-specific subclasses for those measures that don&apos;t<br/>generalize.</p><p>As Carl said, there isn&apos;t much point in defining Val and<br/>Monzo classes that only take one object in their<br/>constructors and don&apos;t have any new methods.  It doesn&apos;t<br/>have to be all object oriented or all procedural.</p><p>Note: it&apos;s theoretically easy to retrofit Val and Monzo<br/>objects as subclasses of Array if you find you do need<br/>them.  Unfortunately there are problems in reality:</p><p><a href="http://dean.edwards.name/weblog/2006/11/hooray/">http://dean.edwards.name/weblog/2006/11/hooray/</a></p><p>                    Graham</p></div><h3><a id=101565 href="#101565">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/6/2011 2:52:43 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Mon, Sep 5, 2011 at 2:02 PM, Carl Lumma &lt;carl@...&gt; wrote:<br/>&gt;<br/>&gt; In my opinion, Convention 1 is a classic case of too<br/>&gt; much structure too soon and indeed, of OO (a good approach<br/>&gt; for writing simulations, but not particularly for anything<br/>&gt; else) gone wrong. -Carl</p><p>Can you give an example of a syntax you&apos;d like better? I really wish I<br/>could define literals, e.g. something like</p><p>var tet12 = &lt;12 19 28|<br/>var syntonic = |-4 4 -1&gt;<br/>alert(&lt;tet12|syntonic&gt;) //should spit out 0<br/>var tet19 = &lt;19 30 44|<br/>var meantone = tet12 /\ tet19 //creates, under the hood, a Temperament object</p><p>alert(meantone.wedgie()) //spits out &quot;&lt;&lt;1 4 4||&quot;<br/>alert(meantone.normalValList()) //spits out &quot;&lt;1 1 0| &lt;0 1 4|&quot;<br/>alert(meantone.normalCommaList()) //spits out &quot;|-4 4 -1&gt;&quot;<br/>alert(meantone.POTEGenerator()) //too lazy to look this up right now</p><p>That&apos;s what I really like, but since JS doesn&apos;t let you overload<br/>operators and define new literals, not much of an option. Maybe a<br/>suitable compromise would be something like</p><p>var tet12 = V([12, 19, 28])<br/>var syntonic = M([-4, 4, -1])</p><p>That&apos;s at least a bit more syntactically palatable.</p><p>You know, there is this -</p><p><a href="http://nixtu.blogspot.com/2011/05/using-jsshaper-to-provide-operator.html">http://nixtu.blogspot.com/2011/05/using-jsshaper-to-provide-operator.html</a></p><p>If any of you real hip compsci people know of any sort of AST -&gt; JS<br/>and also AST -&gt; Python type things, or some alternate but equally hip<br/>solution, that would be a godsend in this case.</p><p>-Mike</p></div><h3><a id=101566 href="#101566">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/6/2011 4:06:04 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Tue, Sep 6, 2011 at 5:52 PM, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; <a href="http://nixtu.blogspot.com/2011/05/using-jsshaper-to-provide-operator.html">http://nixtu.blogspot.com/2011/05/using-jsshaper-to-provide-operator.html</a><br/>&gt;<br/>&gt; If any of you real hip compsci people know of any sort of AST -&gt; JS<br/>&gt; and also AST -&gt; Python type things, or some alternate but equally hip<br/>&gt; solution, that would be a godsend in this case.</p><p>Actually, as much as I hate Microsoft, JScript-based ASP (not <a href="http://ASP.NET">ASP.NET</a>)<br/>might be applicable in this case. The ultimate holy grail for all of<br/>this would be to come up with a both client- and server-side library,<br/>so I can have both crazy real time interactive Web 2.0 temperament<br/>widgets, but also so we can make it so that the Wiki can support<br/>something like this</p><p>[temperament name=meantone comma=81/80 limit=5]</p><p>or some more suitable variant, and it would then autogenerate a huge<br/>template for meantone. Then, if we decide we want to start including<br/>TOP generators as well, a simple library change changes the output for<br/>every temperament on the site simultaneously. And if we want to have<br/>an icon that, when you click on it, plays an autogenerated minimal<br/>comma pump using Gene&apos;s algorithm and data: URIs, that&apos;s a day or two<br/>to code up.</p><p>This would be rather easy to do in JavaScript after developing<br/>something like the aforementioned library, but I&apos;m worried that there<br/>are enough people around here with browsers that don&apos;t support JS that<br/>the Wiki would be rendered entirely incomprehensible for them.<br/>Although one could always just put the manual printout in &lt;noscript&gt;<br/>tags, as a first pass for all of this.</p><p>-Mike</p></div><h3><a id=101568 href="#101568">ðŸ”—</a>Carl Lumma &#x3C;carl@...&#x3E;</h3><span>9/7/2011 12:59:54 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; &gt; In my opinion, Convention 1 is a classic case of too<br/>&gt; &gt; much structure too soon and indeed, of OO (a good approach<br/>&gt; &gt; for writing simulations, but not particularly for anything<br/>&gt; &gt; else) gone wrong. -Carl<br/>&gt;<br/>&gt; Can you give an example of a syntax you&apos;d like better?</p><p>I liked Convention 2 better...  :)  -Carl</p></div><h3><a id=101570 href="#101570">ðŸ”—</a>Graham Breed &#x3C;gbreed@...&#x3E;</h3><span>9/7/2011 4:28:25 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; That&apos;s what I really like, but since JS doesn&apos;t let you<br/>&gt; overload operators and define new literals, not much of<br/>&gt; an option. Maybe a suitable compromise would be something<br/>&gt; like<br/>&gt;<br/>&gt; var tet12 = V([12, 19, 28])<br/>&gt; var syntonic = M([-4, 4, -1])</p><p>How about</p><p>var tet12 = [12, 19, 28]<br/>var syntonic = [-4, 4, -1]</p><p>?</p><p>                            Graham</p></div><h3><a id=101571 href="#101571">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/7/2011 5:00:09 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Sep 7, 2011, at 7:28 AM, Graham Breed &lt;gbreed@...&gt; wrote:</p><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; That&apos;s what I really like, but since JS doesn&apos;t let you<br/>&gt; overload operators and define new literals, not much of<br/>&gt; an option. Maybe a suitable compromise would be something<br/>&gt; like<br/>&gt;<br/>&gt; var tet12 = V([12, 19, 28])<br/>&gt; var syntonic = M([-4, 4, -1])</p><p>How about</p><p>var tet12 = [12, 19, 28]<br/>var syntonic = [-4, 4, -1]</p><p>?</p><p>How does this vibe with your suggestion that every Temperament object have a<br/>prime limit, and also that there be just one Temperament class for all<br/>ranks? JS supports multidimensional arrays, but I can&apos;t give them properties<br/>like limit.</p><p>Maybe the bsest solution is to use Javascript Object Notation, or JSON. Then<br/>we can be like</p><p>var tet12 = {limit: 5, val: [12, 19, 28]};<br/>var syntonic = {monzo: [-4, 4, -1]}</p><p>So that might be a decent start.</p><p>Mike</p></div><h3><a id=101572 href="#101572">ðŸ”—</a>Graham Breed &#x3C;gbreed@...&#x3E;</h3><span>9/7/2011 5:25:29 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt; On Sep 7, 2011, at 7:28 AM, Graham Breed<br/>&gt; &lt;gbreed@...&gt; wrote:<br/>&gt;<br/>&gt; Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; &gt; That&apos;s what I really like, but since JS doesn&apos;t let you<br/>&gt; &gt; overload operators and define new literals, not much of<br/>&gt; &gt; an option. Maybe a suitable compromise would be<br/>&gt; &gt; something like<br/>&gt; &gt;<br/>&gt; &gt; var tet12 = V([12, 19, 28])<br/>&gt; &gt; var syntonic = M([-4, 4, -1])<br/>&gt;<br/>&gt; How about<br/>&gt;<br/>&gt; var tet12 = [12, 19, 28]<br/>&gt; var syntonic = [-4, 4, -1]<br/>&gt;<br/>&gt; ?<br/>&gt;<br/>&gt; How does this vibe with your suggestion that every<br/>&gt; Temperament object have a prime limit, and also that<br/>&gt; there be just one Temperament class for all ranks? JS<br/>&gt; supports multidimensional arrays, but I can&apos;t give them<br/>&gt; properties like limit.</p><p>If you want tet12 to actually be a temperament, you write</p><p>tet12 = Temperament([[12,19,28]], plimit(5))</p><p>or maybe</p><p>tet12 = Temperament([[12,19,28]], consecutivePrimes)</p><p>or even</p><p>tet12 = Temperament([[12,19,28]])</p><p>where you know to default to consecutive primes as a<br/>default argument.  (I don&apos;t know how this works with<br/>JavaScript.)  You can also say</p><p>tet12 = EqualTemperament([12,19,28], plimit(5))</p><p>where EqualTemperament could return a Temperament or a<br/>subclass of Temperament. The great thing is that you don&apos;t<br/>need to decide right now.  (Unless JavaScript requires the<br/>&quot;new&quot; keyword, in which case it has to be a factory<br/>function either way.)</p><p>There are also things like</p><p>var tet12 = BestEqualTemperament(12, plimit(5))</p><p>or</p><p>var tet12 = BestTemperament([12], plimit(5))</p><p>or</p><p>var tet12 = NamedTemperament(&quot;12p&quot;, plimit(5))</p><p>or</p><p>var tet12 = BestTemperament(plimit(5), 12)</p><p>where you could extend this to higher ranks by adding more<br/>arguments.  It&apos;s important to put the prime limit first in<br/>this case.  So the decision you have to make is whether to<br/>have the prime limit as the first, compulsory argument or<br/>second, optional argument with the mapping specified as an<br/>array.</p><p>For the dual approach, maybe</p><p>var meantone = Temperament(UnisonVectors([[-4,4,-1]]))</p><p>or, more explicitly</p><p>var meantone = Temperament(<br/>    UnisonVectors([[-4,4,-1]]).mapping(),<br/>    plimit(5))</p><p>The difficult part is getting the mapping() method to<br/>work, not worrying about the syntax.</p><p>You may want to replace plimit() (a function that returns<br/>an array) with Plimit (a class that includes the sizes of<br/>each prime and strings to represent them).  You could even<br/>make the different temperament factories methods of Plimit,<br/>I suppose.</p><p>&gt; Maybe the bsest solution is to use Javascript Object<br/>&gt; Notation, or JSON. Then we can be like<br/>&gt;<br/>&gt; var tet12 = {limit: 5, val: [12, 19, 28]};<br/>&gt; var syntonic = {monzo: [-4, 4, -1]}<br/>&gt;<br/>&gt; So that might be a decent start.</p><p>Why, what problem does it solve?</p><p>                     Graham</p></div><h3><a id=101589 href="#101589">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/8/2011 12:27:36 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>I&apos;ve liked your ideas so far and agree that too much encapsulation is<br/>a bad thing. I think JSON will make this a lot simpler, and I&apos;ll<br/>explain below.</p><p>On Wed, Sep 7, 2011 at 8:25 AM, Graham Breed &lt;gbreed@...&gt; wrote:<br/>&gt;<br/>&gt; The difficult part is getting the mapping() method to<br/>&gt; work, not worrying about the syntax.</p><p>I think a dot product function is easy, I&apos;m just OCD about this stuff :)</p><p>&gt; &gt; Maybe the bsest solution is to use Javascript Object<br/>&gt; &gt; Notation, or JSON. Then we can be like<br/>&gt; &gt;<br/>&gt; &gt; var tet12 = {limit: 5, val: [12, 19, 28]};<br/>&gt; &gt; var syntonic = {monzo: [-4, 4, -1]}<br/>&gt; &gt;<br/>&gt; &gt; So that might be a decent start.<br/>&gt;<br/>&gt; Why, what problem does it solve?</p><p>Well, for starters, vals and monzos are dual to one another. This<br/>approach will enable us to have just one type of object, which could<br/>represent a val or set of vals, a monzo or set of monzos, etc, by<br/>simply autocalculating the vals when you enter in the monzo and prime<br/>limit, or by autocalculating the monzos when you enter a val and prime<br/>limit, etc. So we can do this</p><p>var syntonic = {monzo: [-4, 4, -1]} // automatically puts in a limit<br/>of [2, 3, 5]<br/>alert(syntonic.val) //spits out [[1, 1, 0], [0, 1, 4]]<br/>alert(syntonic.rank) //spits out 1<br/>alert(syntonic.monzo) //spits out [-4, 4, -1]<br/>alert(syntonic.limit) //spits out [2, 3, 5]<br/>alert(syntonic.POTE) //spits out 697 or whatever it is</p><p>But we could also have done this:</p><p>var meantone = {val: [[1, 1, 0], [0, 1, 4]]} // automatically puts in<br/>a limit of [2, 3, 5]<br/>alert(meantone.val) // spits out [[1, 1, 0], [0, 1, 4]]<br/>alert(meantone.rank) //spits out 1<br/>alert(meantone.monzo) //spits out [-4, 4, -1]<br/>alert(meantone.limit) //spits out [2, 3, 5]<br/>alert(meantone.POTE) //spits out 697 or whatever it is</p><p>And then we can also do this with the same exact code:</p><p>var tet12 = {val: [12, 19, 28], limit: 5}<br/>alert(tet12.val) //spits out [12, 19, 28]<br/>alert(tet12.monzo) //spits out [[-4, 4, -1], [7, 0, -3]]<br/>alert(tet12.limit) // spits out [2, 3, 5]<br/>alert(tet12.POTE) // spits out 98 cents or whatever it is</p><p>And then, if we want to deal with subgroups, we can do this</p><p>var supra = {comma: [64, 63], limit: [2, 3, 7]}<br/>alert(supra.val) //spits out [[1, 2, 2], [0, -1, 2]], keeping in mind<br/>this is the 2.3.7 subgroup<br/>alert(supra.monzo) //spits out [[5, -2, -1]]<br/>alert(supra.limit) //spits out [2, 3, 7]<br/>alert(supra.POTE) //I don&apos;t feel like looking this up</p><p>We can even do shorthand things like</p><p>var tet22 = {val: [22], limit: 5} //autogenerates the 22-tet patent val<br/>var diaschismic = tet22.wedge(tet12)</p><p>And now we have a diaschismic object and can do whatever we want with it.</p><p>I think that this is a pretty ideal setup and I&apos;m rather happy with<br/>it. It&apos;s object oriented, yes, but there&apos;s only one object, and why<br/>should there be any others, given the nature of what we&apos;re working on?</p><p>-Mike</p></div><h3><a id=101590 href="#101590">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/8/2011 1:54:16 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Thu, Sep 8, 2011 at 3:27 AM, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; var syntonic = {monzo: [-4, 4, -1]} // automatically puts in a limit<br/>&gt; of [2, 3, 5]<br/>&gt; alert(syntonic.val) //spits out [[1, 1, 0], [0, 1, 4]]<br/>&gt; alert(syntonic.rank) //spits out 1<br/>&gt; alert(syntonic.monzo) //spits out [-4, 4, -1]<br/>&gt; alert(syntonic.limit) //spits out [2, 3, 5]<br/>&gt; alert(syntonic.POTE) //spits out 697 or whatever it is</p><p>I omitted this from the last message because I wanted to keep it<br/>shorter, but I predict I&apos;ll get a wave of people pointing out the<br/>obvious, so I might as well address it first. Yes, I&apos;ve simplified<br/>things a bit. Obviously just creating an object with &quot;comma&quot; and<br/>&quot;limit&quot; members won&apos;t automatically create &quot;monzo&quot; and &quot;val&quot; members<br/>as well. There are a few ways to get the desired behavior, all of<br/>which aren&apos;t mutually exclusive</p><p>1) Do some fun stuff overriding Object.prototype, although I&apos;m worried<br/>about the legacy compatibility of this, so more ideally<br/>2) Just create a factory method similar to jQuery&apos;s $() function.<br/>Let&apos;s say T(), for temperament and tuning<br/>3) Use accessor functions, which will be a necessity no matter what we do<br/>4) If {} object literals aren&apos;t cross-platform, then just create<br/>val(), monzo(), etc functions, the syntax of which will be made clear<br/>below</p><p>I think #2 and #3 will be what happens. So the syntax will be like this:</p><p> //T() is a factory method that autogenerates all of the internal parameters<br/>var supra = T({<br/>     comma: [64, 63],<br/>     limit: [2, 3, 7]<br/>})<br/>alert(supra.getVal());</p><p>or, alternatively, on one line</p><p>var supra = T({comma: [64, 63], limit: [2, 3, 7]})</p><p>and with the accessor functions</p><p>alert(supra.getVal());<br/>supra.setLimit([2, 3, 5]);<br/>supra.setComma([[81, 80], [25, 24]]); //note I specified two commas here<br/>alert(supra.getVal()); //should say [7, 11, 16]</p><p>This is great because it gives you the syntax of Objective-C in<br/>Javascript, and won&apos;t require that you memorize which parameters go<br/>there. I don&apos;t want to do #4 because I think it&apos;s less elegant, but if<br/>legacy browser compatibility turns out to be an issue with the {}<br/>literals, we have this as a fallback:</p><p>var supra = T(<br/>     comma([64, 63]),<br/>     limit([2, 3, 7])<br/>)</p><p>I don&apos;t want to do this though because it&apos;ll be more tedious to code<br/>up. But there you go.</p><p>-Mike</p></div><h3><a id=101594 href="#101594">ðŸ”—</a>Graham Breed &#x3C;gbreed@...&#x3E;</h3><span>9/8/2011 12:12:18 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; On Wed, Sep 7, 2011 at 8:25 AM, Graham Breed<br/>&gt; &lt;gbreed@...&gt; wrote:<br/>&gt; &gt;<br/>&gt; &gt; The difficult part is getting the mapping() method to<br/>&gt; &gt; work, not worrying about the syntax.<br/>&gt;<br/>&gt; I think a dot product function is easy, I&apos;m just OCD<br/>&gt; about this stuff :)</p><p>Converting a set of unison vectors to a mapping isn&apos;t about<br/>a dot product.  It means finding a null space basis, and<br/>saturating it.  How difficult that is depends on what<br/>library you&apos;re going to use, and you haven&apos;t enlightened us<br/>about that yet.</p><p>&gt; &gt; &gt; Maybe the bsest solution is to use Javascript Object<br/>&gt; &gt; &gt; Notation, or JSON. Then we can be like<br/>&gt; &gt; &gt;<br/>&gt; &gt; &gt; var tet12 = {limit: 5, val: [12, 19, 28]};<br/>&gt; &gt; &gt; var syntonic = {monzo: [-4, 4, -1]}<br/>&gt; &gt; &gt;<br/>&gt; &gt; &gt; So that might be a decent start.<br/>&gt; &gt;<br/>&gt; &gt; Why, what problem does it solve?<br/>&gt;<br/>&gt; Well, for starters, vals and monzos are dual to one<br/>&gt; another. This approach will enable us to have just one<br/>&gt; type of object, which could represent a val or set of<br/>&gt; vals, a monzo or set of monzos, etc, by simply<br/>&gt; autocalculating the vals when you enter in the monzo and<br/>&gt; prime limit, or by autocalculating the monzos when you<br/>&gt; enter a val and prime limit, etc. So we can do this</p><p>If you want one object to represent all these different<br/>things, doesn&apos;t an array fit the bill?  Where they&apos;re<br/>different, they should be different objects.</p><p>&gt; var syntonic = {monzo: [-4, 4, -1]} // automatically puts<br/>&gt; in a limit of [2, 3, 5]<br/>&gt; alert(syntonic.val) //spits out [[1, 1, 0], [0, 1, 4]]<br/>&gt; alert(syntonic.rank) //spits out 1<br/>&gt; alert(syntonic.monzo) //spits out [-4, 4, -1]<br/>&gt; alert(syntonic.limit) //spits out [2, 3, 5]<br/>&gt; alert(syntonic.POTE) //spits out 697 or whatever it is</p><p>How does this work?  You&apos;re assuming something from JSON I<br/>haven&apos;t seen.  What was wrong with JavaScript objects<br/>anyway?  After that, what you need is a temperament object<br/>with a magic constructor.</p><p>&lt;snip&gt;<br/>&gt; And then we can also do this with the same exact code:<br/>&gt;<br/>&gt; var tet12 = {val: [12, 19, 28], limit: 5}<br/>&gt; alert(tet12.val) //spits out [12, 19, 28]<br/>&lt;snip&gt;</p><p>If this mysterious JSON implementation allows different<br/>constructor signatures, yes.</p><p>&gt; I think that this is a pretty ideal setup and I&apos;m rather<br/>&gt; happy with it. It&apos;s object oriented, yes, but there&apos;s<br/>&gt; only one object, and why should there be any others,<br/>&gt; given the nature of what we&apos;re working on?</p><p>There shouldn&apos;t be any other classes for temperaments.<br/>There should be a different object for each temperament you<br/>look at, depending on what you think a temperament is.<br/>That&apos;s what your message seems to be about: let&apos;s have a<br/>class for temperaments (a good idea, I already do that in<br/>Python) and let&apos;s use a strange syntax, for some reason.</p><p>From the other message: why are you defining these<br/>dictionaries instead of using the normal function and method<br/>signatures?  I can&apos;t find my JavaScript reference so I&apos;m<br/>not sure what the restrictions are.  But it&apos;s best write<br/>the language the way it&apos;s supposed to be written instead of<br/>trying to work around it, especially while you&apos;re building<br/>up your experience.  In Python, you&apos;re only allowed one<br/>constructor, so the idiomatic way is to have a canonical<br/>constructor taking parameters that match the internal state<br/>and factory functions to help you with simpler signatures.<br/>I find that works very well because it makes the interface<br/>clear and takes complexity out of the constructor.</p><p>It&apos;s great that your examples magically include a &quot;factory<br/>method that autogenerates all of the internal parameters&quot;.<br/>In practice, that method&apos;s going to be a complete mess and<br/>take up a large part of the implementation.</p><p>You talk about getting the syntax of Objective C in<br/>JavaScript.  I&apos;m not sure you are, but anyway it&apos;s a bad<br/>idea.  JavaScript is perfectly capable (if a little<br/>idiosyncratic) as an object oriented language of the C++<br/>family.</p><p>As a style point: terse, let alone single letter method<br/>names are usually a bad idea.  It&apos;s explained, with data,<br/>in Code Complete.</p><p>                   Graham</p></div><h3><a id=101599 href="#101599">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/9/2011 2:04:14 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Thu, Sep 8, 2011 at 3:12 PM, Graham Breed &lt;gbreed@...&gt; wrote:<br/>&gt;<br/>&gt; Converting a set of unison vectors to a mapping isn&apos;t about<br/>&gt; a dot product. It means finding a null space basis, and<br/>&gt; saturating it. How difficult that is depends on what<br/>&gt; library you&apos;re going to use, and you haven&apos;t enlightened us<br/>&gt; about that yet.</p><p>Oh, I thought you meant mapping() as applying a homomorphism or<br/>something like that.</p><p>&gt; If this mysterious JSON implementation allows different<br/>&gt; constructor signatures, yes.</p><p>I hope these points are now addressed that you&apos;ve seen the message<br/>after, so I&apos;ll skip them. I was going to try messing around with<br/>Object.prototype to provide the magic constructor, but I&apos;m not sure<br/>how I thought it was going to work at 5 AM when I typed that and an<br/>explicit T(...) or Temperament(...) constructor/factory method will be<br/>a lot better. I keep realizing that there&apos;s a very blurry distinction<br/>between constructors and factory methods in JS.</p><p>&gt; That&apos;s what your message seems to be about: let&apos;s have a<br/>&gt; class for temperaments (a good idea, I already do that in<br/>&gt; Python) and let&apos;s use a strange syntax, for some reason.<br/>//<br/>&gt; From the other message: why are you defining these<br/>&gt; dictionaries instead of using the normal function and method<br/>&gt; signatures? I can&apos;t find my JavaScript reference so I&apos;m<br/>&gt; not sure what the restrictions are.</p><p>I&apos;m using the strange syntax as a way of getting around the rough<br/>edges of the normal JS syntax.</p><p>In this case, there&apos;s more than one way to create a Temperament, and<br/>JavaScript doesn&apos;t allow you to define a few different overridden<br/>constructors like you&apos;d hope. So I&apos;d have to have to have factory<br/>methods for Monzo/Val/Wedgie/Comma, and then one canonical<br/>super-constructor that&apos;s called by all of those.</p><p>That wouldn&apos;t be too bad, and it&apos;d look something like this:</p><p>function Temperament(val, monzo, wedgie, comma, limit);</p><p>function Monzo(m, plimit) {<br/>     return new Temperament(null, m, null, null, plimit);<br/>}</p><p>function Val(v, plimit) {<br/>     return new Temperament(v, null, null, null, plimit);<br/>}</p><p>var syntonic = Monzo([-4, 4, -1], 5) //returns a Temperament object<br/>var meantone = Val([[1, 1, 0], [0, 1, 4]], 5)</p><p>The reason I suggested doing JSON is that the syntax is going to suck<br/>when we do something like this:</p><p>var RandomSubgroupTemperament = Val([[4, 3, 2, 6], [1, 1, 0, 7], [9,<br/>0, 19, 5], [6, 7, 5, 4]], [2, 3, 5, 11])</p><p>If you grab your reading glasses and an electron microscope, you&apos;ll<br/>see that this function actually takes two parameters - the first is a<br/>4x4 multidimensional array, and the second is a 1x4 array that<br/>specifies the prime limit. This is going to make the code a nightmare<br/>to read. I feel it&apos;s rather easily resolved by just passing an object<br/>where you explicitly type the names in, aka Temperament({val: [[4, 3,<br/>2, 6], [1, 1, 0, 7], [9, 0, 19, 5], [6, 7, 5, 4]], limit: [2, 3, 5,<br/>11]}). Or you can lay it out on more than one line, like</p><p>var RandomSubgroupTemperament = Temperament({<br/>     val: [[4, 3, 2, 6],<br/>            [1, 1, 0, 7],<br/>            [9, 0, 19, 5],<br/>            [6, 7, 5, 4]],<br/>     limit: [2, 3, 5, 11]<br/>})</p><p>The tradeoff is that you have to remember to put {} in (), leading to<br/>the ({ .... }) syntax for Temperament. This isn&apos;t uncommon in modern<br/>JS programming, as I&apos;ll address below. And at any rate, no, it isn&apos;t<br/>perfect, but I think it&apos;s much better than<br/>[3,24[,[24[2,[,42[24,[2,42,[42,, which is what the other one looked<br/>like.</p><p>Of course, since things in {.......} are objects, you could also do it<br/>like this:</p><p>var params = new Object;<br/>params[&quot;val&quot;] = [[4, 3, 2, 6], [1, 1, 0, 7], [9, 0, 19, 5], [6, 7, 5, 4]];<br/>params[&quot;limit&quot;] = [2, 3, 5, 11];<br/>var RandomSubgroupTemperament = Temperament(params)</p><p>That&apos;s just more typing so I don&apos;t think it&apos;ll happen too much.</p><p>If you grab your reading glasses and an electron microscope, you&apos;ll<br/>see that this function actually takes two parameters - the first is a<br/>4x4 multidimensional array, and the second is a 1x4 array that<br/>specifies the prime limit. It would be better if you could do<br/>something like Val([[1 0 0 0][0 1 0 0][0 0 1 0][0 0 0 1]], [2 3 5<br/>11]), although I don&apos;t even like that, but anyway it&apos;s off the table.<br/>This is a particularly irritating fact in the JS syntax, but</p><p>It would be better if you could do something like Val([[1 0 0 0][0 1 0<br/>0][0 0 1 0][0 0 0 1]], [2 3 5 11]), although I don&apos;t even like that,<br/>but anyway it&apos;s off the table. This is a particularly irritating fact<br/>in the JS syntax, but I feel it&apos;s rather easily resolved by just<br/>passing an object where you explicitly type the names in, aka<br/>Temperament({val: [........], limit: [........]}).</p><p>One solution is just to do it both ways, e.g. like this:</p><p>function Temperament(JSONobject) {<br/>     ... //actually makes the Temperament by using the JSON notation I<br/>laid out before<br/>}</p><p>function Monzo(m, plimit) {<br/>     return new Temperament({monzo: m, limit: plimit});<br/>}</p><p>function Val(v, plimit) {<br/>     return new Temperament({val: v, limit: plimit});<br/>}</p><p>var syntonic = Monzo([-4, 4, -1], 5) //returns a Temperament object<br/>var alsosyntonic = Temperament({monzo: [-4, 4, -1], limit:5}) //this<br/>is the same as the above, in fact Monzo() simply calls this explicitly</p><p>var meantone = Val([[1, 1, 0], [0, 1, 4]], 5)<br/>var alsomeantone = Temperament({val: [[1, 1, 0], [0,1, 4]], limit:5})</p><p>&gt; But it&apos;s best write<br/>&gt; the language the way it&apos;s supposed to be written instead of<br/>&gt; trying to work around it, especially while you&apos;re building<br/>&gt; up your experience.</p><p>The problem is that JS programming conventions have evolved somewhat<br/>since way back a decade ago when I started programming in it. I didn&apos;t<br/>even know that {} object literals existed back then, but they&apos;re all<br/>the rage nowadays.</p><p>The T(...) method in my original post should have been<br/>Temperament(...), and I mistakenly called it a &quot;factory method,&quot; but<br/>it&apos;s probably better thought of as a constructor in which you just<br/>don&apos;t use the &quot;new&quot; keyword. The distinction is slightly blurred in a<br/>weakly-typed language like Javascript that doesn&apos;t really have<br/>classes. But I used the T(...) syntax as a nod to Prototype&apos;s and<br/>jQuery&apos;s $() function, which leads to syntax like this (taken from the<br/>jQuery FAQ)</p><p> $(&quot;div&quot;).click(function(){<br/>   if ( $(this).hasClass(&quot;protected&quot;) )<br/>     $(this)<br/>       .animate({ left: -10 })<br/>       .animate({ left: 10 })<br/>       .animate({ left: -10 })<br/>       .animate({ left: 10 })<br/>       .animate({ left: 0 });<br/> });</p><p>This code makes it so that any time you click on a DIV element, it<br/>moves back and forth 10 pixels at a time. I just realized that they&apos;re<br/>passing objects in methods as well - look at animate({left: -10})<br/>above, although this function takes an object as only its first<br/>parameter (specifying the CSS settings you&apos;re animating towards), with<br/>three other normal parameters after. But at any rate, I guess I&apos;m not<br/>the only person to resolve JS&apos;s silly constructor overriding issues<br/>like this.</p><p>However, despite that method-chaining, object-passing, and $trange<br/>$yntax is all the rage these days in our brave new Web 2.9 world, it<br/>might be more intuitive for a lot of us to deal with something closer<br/>to standard C-syntax.</p><p>&gt; As a style point: terse, let alone single letter method<br/>&gt; names are usually a bad idea. It&apos;s explained, with data,<br/>&gt; in Code Complete.</p><p>I&apos;m not sure what &quot;terse&quot; means in this context, but I&apos;m pretty sure<br/>Code Complete won&apos;t like $ in Prototype and jQuery then, since $ is<br/>both an object (like $.each(...)) and a function (like<br/>$(&quot;#anchor&quot;).animate(....)). But to me, these conventions are a<br/>godsend, and go a long way in making the sometimes idiosyncrasies of<br/>JS coding far more palatable.</p><p>-Mike</p></div><h3><a id=101600 href="#101600">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/9/2011 4:09:13 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Fri, Sep 9, 2011 at 5:04 AM, Mike Battaglia &lt;battaglia01@...&gt; wrote:<br/>&gt;<br/>&gt; If you grab your reading glasses and an electron microscope, you&apos;ll<br/>&gt; see that this function actually takes two parameters - the first is a<br/>&gt; 4x4 multidimensional array, and the second is a 1x4 array that<br/>&gt; specifies the prime limit. It would be better if you could do<br/>&gt; something like Val([[1 0 0 0][0 1 0 0][0 0 1 0][0 0 0 1]], [2 3 5<br/>&gt; 11]), although I don&apos;t even like that, but anyway it&apos;s off the table.<br/>&gt; This is a particularly irritating fact in the JS syntax, but</p><p>If you grab your reading glasses and an electron microscope, you&apos;ll<br/>see that I typed this paragraph like three times. Looks like I didn&apos;t<br/>even both to finish the paragraph this time.</p><p>-Mike</p></div><h3><a id=101603 href="#101603">ðŸ”—</a>Graham Breed &#x3C;gbreed@...&#x3E;</h3><span>9/9/2011 2:21:19 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; In this case, there&apos;s more than one way to create a<br/>&gt; Temperament, and JavaScript doesn&apos;t allow you to define a<br/>&gt; few different overridden constructors like you&apos;d hope. So<br/>&gt; I&apos;d have to have to have factory methods for<br/>&gt; Monzo/Val/Wedgie/Comma, and then one canonical<br/>&gt; super-constructor that&apos;s called by all of those.</p><p>Factory functions are what you want, yes.  Maybe factory<br/>methods if PrimeLimit is the object they&apos;re methods of.</p><p>&gt; That wouldn&apos;t be too bad, and it&apos;d look something like<br/>&gt; this:<br/>&gt;<br/>&gt; function Temperament(val, monzo, wedgie, comma, limit);</p><p>That&apos;s a factory function.  Why do you need a wedgie?<br/>What&apos;s the difference between a monzo and a comma?</p><p>&gt; function Monzo(m, plimit) {<br/>&gt;      return new Temperament(null, m, null, null, plimit);<br/>&gt; }<br/>&gt;<br/>&gt; function Val(v, plimit) {<br/>&gt;      return new Temperament(v, null, null, null, plimit);<br/>&gt; }</p><p>You shouldn&apos;t call them Val or Monzo unless they return<br/>Vals or Monzos.  If you&apos;re getting a temperament from<br/>monzos, the function should be TemperamentFromMonzos. And<br/>calling the Temperament constructor with that many nulls is<br/>asking for trouble. You should calculate the other<br/>parameters in the factories.</p><p>You&apos;re going to need chained if statements, or maybe a<br/>switch, to decide how to fill in the blanks if you want<br/>random things to be null.  Object oriented design is<br/>supposed to avoid that.  By one rule of thumb, object<br/>orientated programing is about not using switch the same<br/>way procedural programming is about not using goto.</p><p>&gt; var syntonic = Monzo([-4, 4, -1], 5) //returns a<br/>&gt; Temperament object var meantone = Val([[1, 1, 0], [0, 1,<br/>&gt; 4]], 5)<br/>&gt;<br/>&gt; The reason I suggested doing JSON is that the syntax is<br/>&gt; going to suck when we do something like this:<br/>&gt;<br/>&gt; var RandomSubgroupTemperament = Val([[4, 3, 2, 6], [1, 1,<br/>&gt; 0, 7], [9, 0, 19, 5], [6, 7, 5, 4]], [2, 3, 5, 11])</p><p>Yes, so you should say</p><p>var randomMapping = [[4, 3, 2, 6],<br/>    [1, 1,0, 7],<br/>    [9, 0, 19, 5],<br/>    [6, 7, 5, 4]]<br/>var limit11no7 = [2, 3, 5, 11]</p><p>var random = TemperamentFromMapping(<br/>    randomMapping, limit11no7)</p><p>&gt; If you grab your reading glasses and an electron<br/>&gt; microscope, you&apos;ll see that this function actually takes<br/>&gt; two parameters - the first is a 4x4 multidimensional<br/>&gt; array, and the second is a 1x4 array that specifies the<br/>&gt; prime limit. This is going to make the code a nightmare<br/>&gt; to read. I feel it&apos;s rather easily resolved by just<br/>&gt; passing an object where you explicitly type the names in,<br/>&gt; aka Temperament({val: [[4, 3, 2, 6], [1, 1, 0, 7], [9, 0,<br/>&gt; 19, 5], [6, 7, 5, 4]], limit: [2, 3, 5, 11]}). Or you can<br/>&gt; lay it out on more than one line, like</p><p>You should give names to all your constants according to<br/>the general programming rule.  Code that&apos;s full of magic<br/>numbers is generally unreadable.</p><p>&gt; var RandomSubgroupTemperament = Temperament({<br/>&gt;      val: [[4, 3, 2, 6],<br/>&gt;             [1, 1, 0, 7],<br/>&gt;             [9, 0, 19, 5],<br/>&gt;             [6, 7, 5, 4]],<br/>&gt;      limit: [2, 3, 5, 11]<br/>&gt; })</p><p>That&apos;s not much better than</p><p>var RandomSubgroupTemperament = Temperament(<br/>     [[4, 3, 2, 6],<br/>            [1, 1, 0, 7],<br/>            [9, 0, 19, 5],<br/>            [6, 7, 5, 4]],<br/>     [2, 3, 5, 11]<br/>)</p><p>which avoids calling something a val when it isn&apos;t a val.</p><p>&gt; The problem is that JS programming conventions have<br/>&gt; evolved somewhat since way back a decade ago when I<br/>&gt; started programming in it. I didn&apos;t even know that {}<br/>&gt; object literals existed back then, but they&apos;re all the<br/>&gt; rage nowadays.</p><p>Right, I was out of date as well.  The curly brackets<br/>define an object, that may include methods.  You can<br/>promote that object to have the standard methods for a<br/>class.  And it&apos;s the standard way to implement named<br/>parameters.  No need to bring in JSON, which is for passing<br/>data between applications.</p><p>&gt; The T(...) method in my original post should have been<br/>&gt; Temperament(...), and I mistakenly called it a &quot;factory<br/>&gt; method,&quot; but it&apos;s probably better thought of as a<br/>&gt; constructor in which you just don&apos;t use the &quot;new&quot;<br/>&gt; keyword. The distinction is slightly blurred in a<br/>&gt; weakly-typed language like Javascript that doesn&apos;t really<br/>&gt; have classes. But I used the T(...) syntax as a nod to<br/>&gt; Prototype&apos;s and jQuery&apos;s $() function, which leads to<br/>&gt; syntax like this (taken from the jQuery FAQ)</p><p>It&apos;s a factory.  That&apos;s exactly what a factory does:<br/>construct an object and return it.</p><p>&gt; &gt; As a style point: terse, let alone single letter method<br/>&gt; &gt; names are usually a bad idea. It&apos;s explained, with data,<br/>&gt; &gt; in Code Complete.<br/>&gt;<br/>&gt; I&apos;m not sure what &quot;terse&quot; means in this context, but I&apos;m<br/>&gt; pretty sure Code Complete won&apos;t like $ in Prototype and<br/>&gt; jQuery then, since $ is both an object (like $.each(...))<br/>&gt; and a function (like $(&quot;#anchor&quot;).animate(....)). But to<br/>&gt; me, these conventions are a godsend, and go a long way in<br/>&gt; making the sometimes idiosyncrasies of JS coding far more<br/>&gt; palatable.</p><p>Terse means short.  I don&apos;t know where the $ came from.<br/>Short variable names are allowable if they&apos;re only used for<br/>a small piece of code.  Then you don&apos;t have to hunt around<br/>to see what they mean.  But I think McConnell (who wrote<br/>Code Complete) would still disapprove.  I don&apos;t have the<br/>book to check.</p><p>There&apos;s nothing wrong with an object being callable.</p><p>                         Graham</p></div><h3><a id=101605 href="#101605">ðŸ”—</a>Mike Battaglia &#x3C;battaglia01@...&#x3E;</h3><span>9/10/2011 1:50:07 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Fri, Sep 9, 2011 at 5:21 PM, Graham Breed &lt;gbreed@...&gt; wrote:<br/>&gt;<br/>&gt; You shouldn&apos;t call them Val or Monzo unless they return<br/>&gt; Vals or Monzos. If you&apos;re getting a temperament from<br/>&gt; monzos, the function should be TemperamentFromMonzos. And<br/>&gt; calling the Temperament constructor with that many nulls is<br/>&gt; asking for trouble. You should calculate the other<br/>&gt; parameters in the factories.</p><p>Much of your reply revolves around the central question is whether the<br/>Temperament(...) constructor should be a constructor that anyone ever<br/>calls directly. If so, then having it take a single object as a<br/>parameter is a good way to do it, at least if you want it to be<br/>constructible in more than one way (by Monzo, by Val, etc).</p><p>You seem to be advocating that no, people should just call the factory<br/>functions, as that&apos;s the most OOP-oriented solution after constructor<br/>overriding, which JS doesn&apos;t allow. This is another perfectly good<br/>paradigm, and it makes more sense from an OOP standpoint. It again<br/>boils down to differing expectations between C++/OOP developers and<br/>developers in modern scripting languages like JS, and differing views<br/>on what paradigm is best to use when developing a program.</p><p>By now it should be clear that OOP in JavaScript is more or less a<br/>hack job. As you saw yourself, there&apos;s always some kind of silly under<br/>the hood tweak you need to get some basic feature of OOP to work.<br/>Javascript is full of stuff like that. There don&apos;t really exist<br/>private variables, nor do there really exist constructors, but by<br/>doing clever things with local variables inside a function and using<br/>the &quot;this&quot; keyword, you can create the illusion that there are.</p><p>Hacks like these then become standard, because people are always<br/>trying to expand the scope of what the web can do, but they&apos;re<br/>syntactically messy and make it difficult for programmers to read one<br/>another&apos;s code. What I&apos;ve seen happen in the last half-decade or so is<br/>that industry leaders (like Google) are coming up with libraries to<br/>wrap the hacks (like jQuery), and in many cases innovating<br/>syntactically so as to give developers some consistency. Many of these<br/>innovations are &quot;weird&quot; at first, but often make things way easier in<br/>the long run. JSON is a great example, which damn near elevates the<br/>object literal syntax to fine art; I doubt anyone was seriously using<br/>either the {} syntax or using objects like that at all 10 years ago.<br/>These innovations draw programming conventions in bold new directions,<br/>sometimes appearing strange to a C/C++ or Java programmer, but I<br/>believe they&apos;ve overall made JavaScript much easier to program in.</p><p>A great example that&apos;s relevant to all this is the document object<br/>model and how it relates to Temperament object factory functions. The<br/>JS DOM has functions like document.getElementById(),<br/>document.getElementsByTagName(), document.getElementsByClassName(),<br/>etc, each of which return an Array of HTML elements that match what<br/>you put in. This is much like how you suggested having different<br/>functions like temperamentFromMapping(), temperamentFromMonzos(),<br/>temperamentFromWedgie(), etc, which from a procedural standpoint makes<br/>sense when you can&apos;t override a constructor and create separate<br/>Mapping objects.</p><p>I and many other programmers have found the DOM to be an unbelievable<br/>pain in the ass to deal with, and so libraries like jQuery and<br/>Prototype responded with the $(...) function, which takes a string<br/>representing a CSS selector that handles all of those. This is much<br/>like my generalized Temperament() of T() function which handles all of<br/>your suggested factory methods. In case that&apos;s not clear, $(&quot;DIV&quot;) is<br/>the same as document.getElementsByTagName(&quot;DIV&quot;), and $(&quot;.foo&quot;) is the<br/>same as document.getElementsByClassName(&quot;foo&quot;).</p><p>You&apos;ll really hate the way jQuery codes up event handlers. If you want<br/>to add an onclick event handler to all div with classnames of foo, you<br/>do it like this, passing an anonymous function to the click(...)<br/>method:</p><p>$(&apos;<a href="http://div.foo">div.foo</a>&apos;).click(function() {<br/>  $(&apos;span&apos;, this).addClass(&apos;bar&apos;);<br/>});</p><p>To you I assume that this is infinitely weirder than the syntax I<br/>suggested, but for web development it&apos;s a godsend. It makes things<br/>easy to do, and is quick to type, easy to understand, gives everyone<br/>just one syntax to use, is still more or less C-syntax, and is in<br/>general such a useful paradigm that I don&apos;t ever want to deal with<br/>getElementById() ever again. So likewise, I think a I&apos;d use a function<br/>like Temperament({val: [...], monzo: [...]}) more than having separate<br/>getTemperamentFromMonzos() and such functions, specifically because of<br/>my experience with how jQuery&apos;s improved the JavaScript DOM.</p><p>In short, the development of JS in the last 10 years has been a series<br/>of realizations that people are being limited by the usual C-style way<br/>of thinking. If JS lets you do dumb things like passing an object<br/>literal containing an anonymous function into another anonymous<br/>function, then you might as well develop new syntactic conventions<br/>around those features if they let us do things that we can&apos;t already<br/>do. I&apos;ve found it really interesting to watch the whole thing, because<br/>it&apos;s taught me how transient programming conventions can be, and how<br/>what&apos;s really important is clarity of thinking and communication.</p><p>But in this case, you may not like it. OK, maybe we can meet somewhere<br/>in the middle. What I could do is make factory functions for Monzo,<br/>Val, Wedgie, Comma, and whatever else, and then also make a factory<br/>function - NOT a constructor - called Tuning. Tuning takes an object<br/>as described above, simply figures out what type of data you&apos;ve passed<br/>in, and calls either Monzo, Val, Wedgie, or Comma, where a Temperament<br/>object is created, or something like that.</p><p>I think that Tuning is a good because it doesn&apos;t just have to refer to<br/>a particular temperament or tuning, but could also more generally<br/>pertain to objects that are related in some way to tuning, such as<br/>intervals. But then, underneath the hood, your Tuning function<br/>actually creates a Temperament object, signifying that all of these<br/>things are related and dual to one another in the theory of regular<br/>Temperament.</p><p>So Tuning is the class, and you have Monzo, Val, Wedgie, Comma, etc<br/>constructors. And then, for those who are more into modern<br/>Prototype/jQuery syntax, we have the master Tuning function, which<br/>does nothing but call one of the above. Maybe that would make everyone<br/>happy.</p><p>-Mike</p></div><h3><a id=101606 href="#101606">ðŸ”—</a>genewardsmith &#x3C;genewardsmith@...&#x3E;</h3><span>9/10/2011 8:30:27 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>--- In <a href="mailto:tuning@yahoogroups.com">tuning@yahoogroups.com</a>, Mike Battaglia &lt;battaglia01@...&gt; wrote:</p><p>&gt; What I could do is make factory functions for Monzo,<br/>&gt; Val, Wedgie, Comma, and whatever else, and then also make a factory<br/>&gt; function - NOT a constructor - called Tuning. Tuning takes an object<br/>&gt; as described above, simply figures out what type of data you&apos;ve passed<br/>&gt; in, and calls either Monzo, Val, Wedgie, or Comma, where a Temperament<br/>&gt; object is created, or something like that.</p><p>What might be relevant to this conversation are the various forms of denoting abstract regular temperaments and the notes thereof, to which a specific tuning could be applied:</p><p><a href="http://xenharmonic.wikispaces.com/Abstract+regular+temperament">http://xenharmonic.wikispaces.com/Abstract+regular+temperament</a></p></div>