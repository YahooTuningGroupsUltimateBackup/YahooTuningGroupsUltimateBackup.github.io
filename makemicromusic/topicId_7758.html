<a href="/makemicromusic">back to list</a><h1>Pitch bend retuning</h1><h3><a id=7758 href="#7758">ðŸ”—</a>Robert Walker &#x3C;robertwalker@...&#x3E;</h3><span>10/11/2004 5:23:28 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Jon,</p><p>&gt; Um, that wasn&apos;t completely clear - how can a program handle &gt; 12 note<br/>&gt; scales with pitch bends without artifacts showing up? (Not saying it can&apos;t<br/>&gt; be done at all, just curious).</p><p>If you get artefacts with pitch bends, then the thing to do is to<br/>make sure the pitch bends are sent early. When they occur they<br/>seem to be a result of sending a pitch bend immediately before<br/>the note on - if you give the synth a bit of time to adjust<br/>before you play the note then they don&apos;t happen any moer.</p><p>FTS sets up all 15 (16) midi channels with the necessary pitch bends<br/>as soon as you open Midi out or at the start of the saved midi file,<br/>using all the midi pitch bends that will be needed for the scale,<br/>if it requires no more than 16 such as is often the case. It seems<br/>to have been a satisfactory solution for dealing with pitch bend<br/>artefacts in the cases where they occur.</p><p>This will deal with all scales with up to 15 (16) notes.</p><p>To understand how it works, it is as if you are playing<br/>the scale on up to 16 pianos (or monotimbral synths).</p><p>Each is in twelve equal temperament<br/>but they can be adjusted in pitch relative to each other.<br/>For instance 24-et can be played on two pianos a quarter<br/>tone apart. So that requires just two midi channels.<br/>Send the quarter tone pitch bend right at the start when<br/>you open midi out to tune the quarter tone sharp piano.<br/>Now you don&apos;t need to send any more pitch<br/>bend messages, so don&apos;t get any glitches.</p><p>Same works with - e.g. 192 et - you can now have<br/>16 pianos each tuned a sixteenth of a semitone sharp<br/>relateive to the previous one. Now you can play any<br/>music in 192-et without any artefacts.</p><p>This could be done with actual pianos - it&apos;s just that<br/>in Midi it is much faster to retune them and more practical<br/>to play them once retuned.</p><p>For e.g. sixteen note octave scale (e.g. sixteen notes<br/>of 17-et or whatever) then you set up<br/>sixteen et pianos. Play e.g. all the Cs on the first one,<br/>all the C#s on the next one, Dbs on the next, and so on right the<br/>way along to the last one which plays Bs.<br/>In betwen you have to leave out one of the notes<br/>of 17-et.</p><p>But if you want to play a scale that only has<br/>16 or less notes in it, then just<br/>set the 16 pianos up and that&apos;s it, no need<br/>for any pitch bends after that, so no artefacts.</p><p>If you need more than 16 scale degrees, and<br/>find you get pitch bend artefacts,<br/>one may need to think about splitting the<br/>midi file either into sections in the various keys or<br/>into parts that require different pitch bend type<br/>microtonal accidentals or whatever.</p><p>Or of course, look for alternative equipment or software that<br/>can retune the notes instantly without artefacts.<br/>For instance of the soft synths, MidiCode works fine,<br/>also the Yamaha and Roland soft synths, also<br/>Giga, of the ones I&apos;ve tested. At least I&apos;ve had<br/>no problems. It could vary I suppose depending on<br/>computer speed or other things to do with the<br/>OS. Can&apos;t think why it should happen when rendering<br/>directly to audio at all unless it is done intentionally<br/>for some reason by the software..</p><p>I&apos;m sure there must be many more.</p><p>Robert</p></div><h3><a id=7760 href="#7760">ðŸ”—</a>Robert Walker &#x3C;robertwalker@...&#x3E;</h3><span>10/11/2004 5:34:54 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Jon,</p><p>BTW those pitch bend artefacts at the start of a note are one thing.<br/>There is another type that happens at teh end of a note.</p><p>You notice that if you play e.g. a note on a harp voice particularly<br/>or one wiht a lot of resonance after teh note has been switched off<br/>- and that problem is similar to the one about sustain that<br/>Graham mentioned - except that here the retuning software<br/>has no way of knowing how long a note will continue to sound<br/>after it is switched off via midi. If yo ubend it too soon<br/>for a following note then you get a pitch bend resonance,<br/>a kind of ghostly backgruond strange bending pitches type<br/>effect with the pitch bent quiet after effects of the notes<br/>that have been switched off.</p><p>You don&apos;t know how long you may need to wait. with a harp<br/>voice it may continue to sound for seconds after it has<br/>been switched off via midi, just gradually getting quieter.<br/>You can switch it off completely by using an all sound off<br/>if happy to switch off all notes in that channel -but that<br/>gives an ugly click like effect. The safest thing is<br/>to assume that all notes may do this and leave<br/>the channel free for as long as you possibly can<br/>before pitch bending it. So retuning software<br/>should do this. But early releases before the<br/>software authors are aware of these various problems<br/>may not do it.</p><p>It&apos;s helpful to know if one is talking about the<br/>start of note type glitches (at about the same<br/>pitch of the new note played) or these<br/>after note type glitches (at about the same pitch<br/>as the previous note played in the channel).</p><p>Robert</p></div><h3><a id=7761 href="#7761">ðŸ”—</a>Aaron K. Johnson &#x3C;akjmicro@...&#x3E;</h3><span>10/11/2004 7:18:37 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Monday 11 October 2004 07:23 pm, Robert Walker wrote:</p><p>&gt; If you get artefacts with pitch bends, then the thing to do is to<br/>&gt; make sure the pitch bends are sent early. When they occur they<br/>&gt; seem to be a result of sending a pitch bend immediately before<br/>&gt; the note on - if you give the synth a bit of time to adjust<br/>&gt; before you play the note then they don&apos;t happen any moer.</p><p>I can attest that this is true: I wrote a midi player in Python a while back,<br/>and had a nasty bug that took a while to figure out: the scheduler needed to<br/>give pitch bend a higher priority in the queue (i.e. it needed to be sent<br/>before the note on message). Otherewise I got those slippy sounds that Jeff<br/>describes.</p><p>Aaron Krister Johnson<br/><a href="http://www.akjmusic.com">http://www.akjmusic.com</a><br/><a href="http://www.dividebypi.com">http://www.dividebypi.com</a></p></div><h3><a id=7763 href="#7763">ðŸ”—</a>Aaron K. Johnson &#x3C;akjmicro@...&#x3E;</h3><span>10/11/2004 7:24:58 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>On Monday 11 October 2004 07:34 pm, Robert Walker wrote:<br/>&gt; Hi Jon,<br/>&gt;<br/>&gt; BTW those pitch bend artefacts at the start of a note are one thing.<br/>&gt; There is another type that happens at teh end of a note.<br/>&gt;<br/>&gt; You notice that if you play e.g. a note on a harp voice particularly<br/>&gt; or one wiht a lot of resonance after teh note has been switched off<br/>&gt; - and that problem is similar to the one about sustain that<br/>&gt; Graham mentioned - except that here the retuning software<br/>&gt; has no way of knowing how long a note will continue to sound<br/>&gt; after it is switched off via midi. If yo ubend it too soon<br/>&gt; for a following note then you get a pitch bend resonance,<br/>&gt; a kind of ghostly backgruond strange bending pitches type<br/>&gt; effect with the pitch bent quiet after effects of the notes<br/>&gt; that have been switched off.<br/>&gt;<br/>&gt; You don&apos;t know how long you may need to wait. with a harp<br/>&gt; voice it may continue to sound for seconds after it has<br/>&gt; been switched off via midi, just gradually getting quieter.<br/>&gt; You can switch it off completely by using an all sound off<br/>&gt; if happy to switch off all notes in that channel -but that<br/>&gt; gives an ugly click like effect. The safest thing is<br/>&gt; to assume that all notes may do this and leave<br/>&gt; the channel free for as long as you possibly can<br/>&gt; before pitch bending it. So retuning software<br/>&gt; should do this. But early releases before the<br/>&gt; software authors are aware of these various problems<br/>&gt; may not do it.</p><p>My solution in my microtonal composition scripting application &apos;et_compose&apos;<br/>was to do what I call &apos;channel hocketing&apos;--say I want a four voice texture<br/>for harps like you said here--to give each voice maximum time to sound, I<br/>make midi channels 1,2,3,4 assigned to voice 1, and each note one is rotated<br/>through those channels;  5,6,7,8 are assigned to voice 2 in like manner, etc.<br/>This way the bending for long release times is avoided with a &apos;channel<br/>hocket&apos;, which helps for such timbres where pitch bend artifacts might show<br/>up.</p><p>Audio multitracking is another (though non-realtime) solution.</p><p>Where there&apos;s a will, there&apos;s a way !</p><p>Aaron Krister Johnson<br/><a href="http://www.akjmusic.com">http://www.akjmusic.com</a><br/><a href="http://www.dividebypi.com">http://www.dividebypi.com</a></p></div>