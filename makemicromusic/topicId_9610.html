<a href="/makemicromusic">back to list</a><h1>Re: [MMM] Improvisation on pitches from a recording of a song thrush</h1><h3>Carl Lumma &#x3C;ekin@...&#x3E;</h3><span>4/13/2005 1:34:20 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;Hi there,<br/>&gt;<br/>&gt;<a href="http://www.robertinventor.com/improvisation_on_thrush_song_pitches.mp3">http://www.robertinventor.com/improvisation_on_thrush_song_pitches.mp3</a><br/>&gt;<br/>&gt;[4 Mb]<br/>&gt;<br/>&gt;Robert</p><p>Fascinating!  How&apos;d you do it?  -Carl</p></div><h3>Danny Wier &#x3C;dawiertx@...&#x3E;</h3><span>4/13/2005 7:20:30 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Robert Walker wrote:</p><p>&gt; Hi there,<br/>&gt;<br/>&gt; <a href="http://www.robertinventor.com/improvisation_on_thrush_song_pitches.mp3">http://www.robertinventor.com/improvisation_on_thrush_song_pitches.mp3</a></p><p>I liked it, and I intend to use it for ear training.</p><p>I know it&apos;s not a real violin, but it sounds pretty close. (I have got to start saving for a better synth.)</p></div><h3>Robert Walker &#x3C;robertwalker@...&#x3E;</h3><span>4/13/2005 11:06:55 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Carl,</p><p>&gt; Fascinating! How&apos;d you do it? -Carl</p><p>Used FTS 3.0 release candidate for the pitch recognition to make a scale<br/>out of the pitches in the song - it&apos;s a  development of the exact wave count<br/>+ interpolation of zero crossings method that I was working on a few years<br/>ago - do you remember the midi bird songs I did before?</p><p>It&apos;s speciality is to find the pitch very exactly for single melodic lines<br/>on suitable voices with easy to locate waveforms particularly.</p><p>So, it only works for single melodic lines and for suitable timbres. Bird<br/>song<br/>happens to be suitable apart from one thing - you get<br/>long slow and rather irregular undulations in the waveform.</p><p>Like this:<br/>         ,,        , ,<br/>       ,   ,     ,    ,      ,,<br/>,     ,      ,, ,       ,   ,    ,      ,,<br/>.,. .,....................,,.......,....,...,........<br/> ,,                                ,,,      ,    ,<br/>                                              ,,<br/>etc. The waveform itself is easy to follow, just a sine wave,<br/>apart from those superimposed undulations which naturally<br/>confuse a program which relies on counting<br/>the places where the waves cross the zero line - quite often the<br/>waveform actually misses the zero line altogether. You get the same<br/>thing with whistling. I&apos;m not quite sure what they are since<br/>if you remove them then it still sounds pretty much the same<br/>as it did before. They are very low frequency and I&apos;m not<br/>sure really what they are.</p><p>Here is an example:</p><p><a href="http://www.robertinventor.com/robin.png">http://www.robertinventor.com/robin.png</a></p><p>As you see the slow undulation is irregular, and at<br/>a frequency of about 20 Hz in this particular example.</p><p>It&apos;s an 8-bit recording which is why it is so spiky.</p><p>Anyway, I found a way to deal with those by an averaging process<br/>which brings the undulations all back down to the zero line<br/>(though this part of the programming can do with some more work<br/>still).</p><p>Here is what it can  do - but you have to select a kind of magic<br/>time interval by trial and error which copes best with the particular<br/>undulations found. That&apos;s where I may be able to improve it at some<br/>later point with some thought. Anyway this is the result:</p><p>Then with the undulations removed:</p><p><a href="http://www.robertinventor.com/robin_averaged.png">http://www.robertinventor.com/robin_averaged.png</a></p><p>Then FTS can order all the pitches found in ascending order<br/>to make a scale you can play in.</p><p>For the thrushes song, here is the scale it found:</p><p><a href="http://www.robertinventor.com/improvisation_on_thrush_song_pitches.txt">http://www.robertinventor.com/improvisation_on_thrush_song_pitches.txt</a></p><p>Then I used FTS to retune my playing to the scale, and improvised<br/>from a keyboard plugged into my laptop using the Dan Dean Solo strings<br/>violin voice in VSampler. Recorded it to midi as I played so that the midi<br/>file is vailable for use if I want to render it some other way later on,<br/>then to make he mp3 I just played the midi file  again and recorded it to<br/>audio as it played hrough VSampler. That is pretty much how I do all my<br/>improvised pieces.</p><p>The presets for  the next release of FTS 3.0 should be suitable already<br/>for many bird song recordings.</p><p>Here is its midi rendering of a robin&apos;s song made using the FTS 3.0 release<br/>candidate:<br/><a href="http://www.robertinventor.com/Robin.mid">http://www.robertinventor.com/Robin.mid</a></p><p>:-)</p><p>You can compare it with the original recording of a robin&apos;s song at<br/><a href="http://www.scricciolo.com">http://www.scricciolo.com</a><br/>on this page:</p><p><a href="http://www.scricciolo.com/eurosongs/canti.htm">http://www.scricciolo.com/eurosongs/canti.htm</a><br/>scroll down to European Robin Erithacus rubecula</p><p><a href="http://www.scricciolo.com/eurosongs/Erithacus.rubecula.wav">http://www.scricciolo.com/eurosongs/Erithacus.rubecula.wav</a></p><p>I know that it doesn&apos;t sound exactly the same particularly at the<br/>end. If you listen to short sections and compare them then<br/>you do hear the pitches that it finds (usually anyway),<br/>but the overall impression isn&apos;t quite the same, for instance<br/>it may play particular pitches a bit longer than they should<br/>or shorter. It probably picks out different pitches<br/>from the ones we notice most.</p><p>It does also sometimes find spurious pitches that aren&apos;t there<br/>at all, perhaps because of chance regular patterns in noise or inharmonic<br/>sections of the wave sometimes. But I&apos;m hopeful that with more<br/>work it will make midi clips that sound more and  more like<br/>what we hear.</p><p>I don&apos;t think it will ever be perfect in a completely<br/>automatic sense - at least it will have several presets, e.g. high pitched<br/>bird song, middle and low, and one will have to audition it and see which<br/>of those work best, and then perhaps there may be other bird song<br/>ones, and then one would probably still need to tweak it if the settings<br/>used give extra notes, but it is getting easier to use the more<br/>I work on it.</p><p>The original audio clips on that site btw are for<br/>non commercial use only. Surely it is all right to just<br/>use them like this to post an example of the technique here,<br/>to show how it works, but I&apos;ll need to contact the author or<br/>find other clips if I use them in the documentation for FTS.</p><p>Or who knows, maybe I&apos;ll have a go at<br/>doing my own recordings some time. I gather that for<br/>recording individual song birds, really you manage it best<br/>with a parabolic reflector type microphone. With my new laptop,<br/>if I get a decent sound USB card and a parabolic reflector<br/>at some point, I would have a reasonable bird song recording<br/>field station. Though maybe I don&apos;t want to splash out right<br/>away.</p><p>Robert</p></div><h3>Carl Lumma &#x3C;ekin@...&#x3E;</h3><span>4/14/2005 1:40:25 AM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;Hi Carl,<br/>&gt;<br/>&gt;&gt; Fascinating! How&apos;d you do it? -Carl<br/>&gt;<br/>&gt;Used FTS 3.0 release candidate for the pitch recognition to make a<br/>&gt;scale out of the pitches in the song - it&apos;s a  development of the exact<br/>&gt;wave count + interpolation of zero crossings method that I was working<br/>&gt;on a few years ago - do you remember the midi bird songs I did before?</p><p>Hi Robert,</p><p>Yes, I remember that, and thanks for the explanation.</p><p>This sort of thing could be useful not only for bird song, but for<br/>extracting scales from traditional music!</p><p>May I ask, how do you cope with note transitions?  How do you decide<br/>what discrete pitches to choose?  Surely the thrush does not sing in<br/>discrete pitches.</p><p>My suggestion for extracting scales from melodic performances is as<br/>follows.  Normal audio signals plot energy over time.  After continuous<br/>pitch extraction, we have pitch over time.  If we apply a time-domain<br/>transform to *that*, we have &apos;pitch frequencies&apos; -- the amount of time<br/>the performer spent playing each pitch in the entire performance (the<br/>duration of musical tones is typically great compared to the period of<br/>musical pitches, so I think we&apos;re OK here).  We can now slice the pitch<br/>continuum into octaves, and in each octave hopefully see a manageable<br/>number of Gaussian lumps (if not, we might say there is no discrete<br/>scale abstraction used in the performance).  When we superimpose these<br/>octave slices, a majority of lumps hopefully coincide.  Finally, the<br/>local maxima of this summed function are written to a Scala file.</p><p>Does this make sense?  Perhaps we should take this to the tuning<br/>list...</p><p>-Carl</p></div>