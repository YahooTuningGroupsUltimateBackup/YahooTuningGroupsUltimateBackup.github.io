<a href="/makemicromusic">back to list</a><h1>Csound improv with Arduino</h1><h3><a id=28141 href="#28141">ðŸ”—</a>Dave Seidel &#x3C;dave@...&#x3E;</h3><span>8/6/2011 2:45:41 PM</span><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Nothing profound, just messing around with my latest project:<br/>controlling Csound in real time using an Arduino box that my brother<br/>built for me. I&apos;m using Pure Data as the glue: the pduino package talks<br/>to the Arduino via the Firmata firmware, and I use csoundapi~ control<br/>Csound. The Csound instrument is a variant of one I&apos;ve used before that<br/>generates combination (i.e., difference and summation) tones based on<br/>intervals defined as ratios. Since there are separate controls for the<br/>numerators and denominators, and each one is defined as producing a<br/>range of integers from 1 to 256, this allows me to play with both<br/>overtone and undertone series. There&apos;s more explanation on the<br/>SoundCloud page.</p><p>I&apos;ve attached the Csound and Pd code if you&apos;re curious, though the Pd<br/>patch will not run without a few other files (write me if you want to<br/>see them). In the Pd path, the &quot;r&quot; (&quot;receive&quot;) objects are where the<br/>signals come in from the Arduino.</p><p><a href="http://soundcloud.com/mysterybear/difference-engine-study-1">http://soundcloud.com/mysterybear/difference-engine-study-1</a></p><p>- Dave</p><p><a href="http://mysterybear.net">http://mysterybear.net</a><br/><a href="http://soundcloud.com/mysterybear">http://soundcloud.com/mysterybear</a><br/><a href="http://mysterybear.bandcamp.com">http://mysterybear.bandcamp.com</a></p><p>  ----------</p><p>&lt;CsoundSynthesizer&gt;<br/>&lt;CsOptions&gt;<br/>&lt;/CsOptions&gt;<br/>&lt;CsInstruments&gt;</p><p>sr = 44100<br/>nchnls = 1<br/>0dbfs = 1<br/>ksmps = 4</p><p>giTblSz&#x9;init&#x9;1048576</p><p>; sine wave<br/>giFn1 &#x9;ftgen&#x9;1, 0, giTblSz, 10, 1</p><p>; &quot;Fibonacci&quot; wave (Mt. Meru A)<br/>giFn2&#x9;ftgen&#x9;2, 0, giTblSz, 9,  1,1,0,   2,.5,0,   3,.3333,0,  5,.2,0,  8,.125,0,  13,.0769,0,  21,.0476,0,  ;34,.0294,0,  ;55,.0182,0,  ;89,.0112,0  ;144,.0069,0</p><p>; harmonics in the Fibonacci series (smaller set)<br/>giFn3&#x9;ftgen&#x9;3, 0, giTblSz, 9,  1,1,0,   2,.5,0,   3,.3333,0;,  5,.2,0,  8,.125,0,  13,.0769,0,  21,.0476,0,  ;34,.0294,0,  ;55,.0182,0,  ;89,.0112,0  ;144,.0069,0</p><p>; prime wave<br/>giFn34&#x9;ftgen&#x9;4, 0, giTblSz, 9,  1,1,0,  2,.5,0,  3,.3333,0,  5,.2,0,    7,.143,0,  11,.0909,0,  13,.077,0,   17,.0588,0,  19,.0526,0, 23,.0435,0, ;27,.037,0</p><p>;---------------------------------------------------------------------------------------<br/>; combination tone chord organ: given a note and a ratio, produces the chord formed<br/>; by that interval plus the set of notes equivalent to the combination tones produced<br/>; by that interval<br/>;---------------------------------------------------------------------------------------</p><p>&#x9;instr   1</p><p>idur&#x9;=       p3                      ; duration<br/>iamp&#x9;=       ampdb(p4)/8             ; amplitude<br/>ipan&#x9;=&#x9;&#x9;p5&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;; pan<br/>ifn&#x9;&#x9;=       p6                      ; function table<br/>ichan&#x9;=&#x9;&#x9;p7&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;; invalue suffix</p><p>S1&#x9;&#x9;sprintf&#x9;&quot;pitch%d&quot;, ichan<br/>S2&#x9;&#x9;sprintf&#x9;&quot;numerator%d&quot;, ichan<br/>S3&#x9;&#x9;sprintf&#x9;&quot;denominator%d&quot;, ichan</p><p>kpch1&#x9;invalue&#x9;S1<br/>kmmm&#x9;invalue&#x9;S2<br/>knnn&#x9;invalue&#x9;S3</p><p>kpch2&#x9;=&#x9;&#x9;kpch1*(kmmm/knnn)&#x9;&#x9;; secondary pitch (primary * ratio)<br/>kdiff&#x9;=&#x9;&#x9;kpch2-kpch1&#x9;&#x9;&#x9;&#x9;; difference tone<br/>kdiff2&#x9;=&#x9;&#x9;(2*kpch2)-kpch1&#x9;&#x9;&#x9;; 2nd order difference tone<br/>kdiff3&#x9;=&#x9;&#x9;(3*kpch2)-(2*kpch1)&#x9;&#x9;; 3rd order difference tone<br/>kper&#x9;=&#x9;&#x9;kpch1/knnn&#x9;&#x9;&#x9;&#x9;; periodicity pitch, shifted up one 8ve<br/>ksum&#x9;=&#x9;&#x9;kpch1+kpch2&#x9;&#x9;&#x9;&#x9;; summation tone<br/>ksum2&#x9;=&#x9;&#x9;(2*kpch1)+kpch2&#x9;&#x9;&#x9;; 2nd order summation tone</p><p>kenv&#x9;linen   iamp, 2, idur, 3&#x9;&#x9;; envelope</p><p>asig1   oscili&#x9;kenv, kpch1,  ifn<br/>asig2&#x9;oscili&#x9;kenv, kpch2,  ifn<br/>adiff&#x9;oscili&#x9;kenv, kdiff,  ifn<br/>adiff2&#x9;oscili&#x9;kenv, kdiff2, ifn<br/>adiff3&#x9;oscili&#x9;kenv, kdiff3, ifn<br/>aper&#x9;oscili&#x9;kenv, kper,   ifn<br/>asum&#x9;oscili&#x9;kenv, ksum,   ifn<br/>asum2&#x9;oscili&#x9;kenv, ksum2,  ifn</p><p>aout&#x9;sum&#x9;&#x9;asig1,asig2,adiff,adiff2,adiff3,aper,asum,asum2<br/>&#x9;&#x9;out     aout</p><p>&#x9;endin</p><p>&lt;/CsInstruments&gt;<br/>&lt;CsScore&gt;</p><p>; top row (channel 1)<br/>i1 0 3600 -5  0 2 1<br/>i1 0 3600 -5  0 4 1</p><p>; bottom row (channel 2)<br/>i1 0 3600 -5  0 2 2<br/>i1 0 3600 -5  0 4 2</p><p>e</p><p>&lt;/CsScore&gt;<br/>&lt;/CsoundSynthesizer&gt;</p><p>  ----------</p><p>#N canvas 254 21 1000 650 10;<br/>#X floatatom 661 406 5 0 0 0 - - -;<br/>#X floatatom 514 399 5 0 0 0 - - -;<br/>#X obj 161 435 dac~;<br/>#X obj 143 374 csoundapi~ difference_engine.csd;<br/>#X obj 612 11 box-10;<br/>#X obj 13 552 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0<br/>1;<br/>#X obj 13 583 dsp;<br/>#X obj 114 234 loadbang;<br/>#X obj 12 516 r d13;<br/>#X msg 478 436 control pitch1 \$1;<br/>#X msg 624 437 control numerator1 \$1;<br/>#X floatatom 825 405 5 0 0 0 - - -;<br/>#X obj 518 308 r a0;<br/>#X obj 663 294 r a1;<br/>#X obj 829 297 r a2;<br/>#X msg 793 438 control denominator1 \$1;<br/>#X obj 519 367 + 30;<br/>#X obj 663 352 int;<br/>#X obj 823 350 int;<br/>#X obj 518 337 * 1200;<br/>#X obj 661 323 * 256;<br/>#X obj 827 324 * 256;<br/>#X floatatom 509 572 5 0 0 0 - - -;<br/>#X obj 511 521 + 30;<br/>#X obj 509 495 * 1200;<br/>#X floatatom 675 572 5 0 0 0 - - -;<br/>#X obj 670 516 int;<br/>#X obj 670 491 * 256;<br/>#X floatatom 823 573 5 0 0 0 - - -;<br/>#X obj 825 523 int;<br/>#X obj 825 499 * 256;<br/>#X msg 112 272 set pitch1 numerator1 denominator1 pitch2 numerator2<br/>denominator2;<br/>#X msg 480 601 control pitch2 \$1;<br/>#X msg 629 600 control numerator2 \$1;<br/>#X msg 785 601 control denominator2 \$1;<br/>#X obj 510 466 r a3;<br/>#X obj 670 463 r a4;<br/>#X obj 825 469 r a5;<br/>#X obj 63 551 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0<br/>1;<br/>#X msg 66 585 run \$1;<br/>#X msg 133 585 reset;<br/>#X obj 64 514 r d12;<br/>#X text 7 608 Sound;<br/>#X text 74 609 Run;<br/>#X text 123 609 Recompile;<br/>#X obj 827 376 + 1;<br/>#X obj 662 378 + 1;<br/>#X obj 671 544 + 1;<br/>#X obj 827 547 + 1;<br/>#X connect 0 0 10 0;<br/>#X connect 1 0 9 0;<br/>#X connect 3 0 2 0;<br/>#X connect 3 0 2 1;<br/>#X connect 5 0 6 0;<br/>#X connect 7 0 31 0;<br/>#X connect 8 0 5 0;<br/>#X connect 9 0 3 0;<br/>#X connect 10 0 3 0;<br/>#X connect 11 0 15 0;<br/>#X connect 12 0 19 0;<br/>#X connect 13 0 20 0;<br/>#X connect 14 0 21 0;<br/>#X connect 15 0 3 0;<br/>#X connect 16 0 1 0;<br/>#X connect 17 0 46 0;<br/>#X connect 18 0 45 0;<br/>#X connect 19 0 16 0;<br/>#X connect 20 0 17 0;<br/>#X connect 21 0 18 0;<br/>#X connect 22 0 32 0;<br/>#X connect 23 0 22 0;<br/>#X connect 24 0 23 0;<br/>#X connect 25 0 33 0;<br/>#X connect 26 0 47 0;<br/>#X connect 27 0 26 0;<br/>#X connect 28 0 34 0;<br/>#X connect 29 0 48 0;<br/>#X connect 30 0 29 0;<br/>#X connect 31 0 3 0;<br/>#X connect 32 0 3 0;<br/>#X connect 33 0 3 0;<br/>#X connect 34 0 3 0;<br/>#X connect 35 0 24 0;<br/>#X connect 36 0 27 0;<br/>#X connect 37 0 30 0;<br/>#X connect 38 0 39 0;<br/>#X connect 39 0 3 0;<br/>#X connect 40 0 3 0;<br/>#X connect 41 0 38 0;<br/>#X connect 45 0 11 0;<br/>#X connect 46 0 0 0;<br/>#X connect 47 0 25 0;<br/>#X connect 48 0 28 0;</p><p>[Non-text portions of this message have been removed]</p></div>