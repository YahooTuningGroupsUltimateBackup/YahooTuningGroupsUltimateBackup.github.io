<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8">
                <meta name="viewport"
            content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
                <meta http-equiv="x-ua-compatible" content="ie=edge">
                <title>Yahoo Tuning Groups Ultimate Backup harmonic_entropy Re: [harmonic_entropy] Digest Number 53</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            </head>
            <body>
            </body>
            </html>
        <a href="/harmonic_entropy">back to list</a><h1>Re: [harmonic_entropy] Digest Number 53</h1><h3><a id=351 href="#351">ðŸ”—</a>Robert Walker &#x3C;robert_walker@...&#x3E;</h3><span>2/1/2001 6:06:48 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Paul,</p><p>Sorry, need some context to understand it.</p><p>Can you work through some simple example, take an example diad,<br/>and show how it works?</p><p>Ex. of where you lose me:</p><p>&gt; OK. For the dyadic case, first you calculate all the ratios such that the<br/>&gt; product does not exceed a certain limit. Then either:</p><p>What is the scope of the &quot;all&quot; here? Product of what with what?</p><p>Probably some small detail that I&apos;m missing, after which it will<br/>make sense.</p><p>The thing is, I haven&apos;t really been following the discussion on<br/>this list in any detail yet, otherwise, maybe I would understand.</p><p>Robert</p><p>&gt; OK. For the dyadic case, first you calculate all the ratios such that the<br/>&gt; product does not exceed a certain limit. Then either:<br/>&gt;<br/>&gt; (a) calculate the mediants between the adjacent ratios, and assign each of<br/>&gt; the original ratios a &quot;width&quot; according to the distance between the mediants<br/>&gt;<br/>&gt; (b) assign a &quot;width&quot; to each ratio based on an approximate formula (this<br/>&gt; approach will have to be used for the triadic case since no one has figured<br/>&gt; out how to generalize mediants to 2-d).<br/>&gt;<br/>&gt; Now, for the interval in question (often, every cents value from 0 to 2400),<br/>&gt; construct a bell curve centered around that interval and with the particular<br/>&gt; standard deviation you&apos;ve assumed. Assign a probability to each of the<br/>&gt; original set of ratios: the probability is proportional to the product of<br/>&gt; the ratio&apos;s &quot;width&quot; times the height of the bell curve at that ratio.<br/>&gt; Finally, calculate the following sum over all the probabilities p:<br/>&gt;<br/>&gt; entropy = -sum(p*log(p))<br/>&gt;<br/>&gt; Does this make sense? If so, I&apos;ll proceed to explain the triadic case (which<br/>&gt; is virtually identical in concept).<br/>&gt;<br/>&gt;<br/>&gt; ________________________________________________________________________<br/>&gt; ________________________________________________________________________<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;</p></div><h3><a id=352 href="#352">ðŸ”—</a>manuel.op.de.coul@...</h3><span>2/1/2001 5:06:34 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Maybe my code will help. I hope the little bit of optimisation<br/>doesn&apos;t make it harder to understand.</p><p>Manuel</p><p>with Pitches;<br/>with Quick_Sort;<br/>with Rational_Math_Lib;<br/>with Scale_Math;</p><p>   subtype Pitch is Pitches.Pitch;<br/>   type Long_Floats is array(Positive range &lt;&gt;) of Long_Float;<br/>   type Subscale is array(Positive range &lt;&gt;) of Pitch;</p><p>   -- If Farey_Order &gt; 160 then make these arrays larger.<br/>   Farey  : Subscale(1 .. 16_000);<br/>   Bounds : Long_Floats(Farey&apos;Range);<br/>   Farey_Count : Natural := 0;<br/>   Farey_Order : Natural := 0;</p><p>   procedure Set_Entropy_Order (The_Order : in Natural) is<br/>      Numl, Numr, Denl, Denr : Integer;<br/>      Templ, Tempr : Rational;</p><p>      function Smaller_Than (Left, Right : in Pitch) return Boolean is<br/>      begin<br/>         return Pitches.To_Float(Left) &lt; Pitches.To_Float(Right);<br/>      end Smaller_Than;</p><p>      procedure Pitch_Sort is new Quick_Sort<br/>       (Item  =&gt; Pitch,<br/>        Index =&gt; Positive,<br/>        Items =&gt; Subscale,<br/>        &quot;&lt;&quot;   =&gt; Smaller_Than,<br/>        &quot;&lt;=&quot;  =&gt; Pitches.&quot;&lt;=&quot;);<br/>   begin<br/>      Farey_Count := 0;<br/>      Farey_Order := The_Order;<br/>      for Den in 1 .. The_Order loop<br/>         for Num in 1 .. The_Order loop<br/>            if Scale_Math.Greatest_Common_Divisor(Num, Den) = 1 then<br/>               Farey_Count := Farey_Count + 1;<br/>               Farey(Farey_Count) := Pitches.To_Pitch(<br/>                 Rational_Math_Lib.Construct_Unchecked(Num, Den));<br/>            end if;<br/>         end loop;<br/>      end loop;<br/>      Pitch_Sort(Farey(1 .. Farey_Count));<br/>      for Index in 2 .. Farey_Count loop<br/>         Templ := Pitches.To_Rational(Farey(Index - 1));<br/>         Tempr := Pitches.To_Rational(Farey(Index));<br/>         Rational_Math_Lib.Value_Of(Templ, Numl, Denl);<br/>         Rational_Math_Lib.Value_Of(Tempr, Numr, Denr);<br/>         Bounds(Index) := Scale_Math.Log2(Long_Float(Numl + Numr) /<br/>           Long_Float(Denl + Denr));<br/>      end loop;<br/>   exception<br/>      when Constraint_Error =&gt;<br/>         raise Argument_Error;<br/>   end Set_Entropy_Order;</p><p>   function Harmonic_Entropy (The_Pitch : in Pitch;<br/>                              Sigma     : in Long_Float := 0.01)<br/>     return Long_Float is<br/>      Log_Pitch, Log_Diff, Prob, Cur_Prob, Last_Prob : Long_Float;<br/>      Float_Pitch : constant Long_Float := Pitches.To_Float(The_Pitch);<br/>      Cin : constant Long_Float := 0.5 * Scale_Math.Square_Root(2.0) / Sigma;<br/>      First_Todo : Integer;<br/>      Result : Long_Float := 0.0;<br/>      Started_Adding : Boolean := False;<br/>   begin<br/>      if Float_Pitch = 0.0 then<br/>         raise Argument_Error;<br/>      end if;<br/>      -- Initialize Farey bounds if not done already.<br/>      if Farey_Count = 0 then<br/>         Set_Entropy_Order(80);<br/>      end if;<br/>      Log_Pitch := abs Scale_Math.Log2(Float_Pitch);<br/>      First_Todo := Farey_Count / 3;<br/>      Log_Diff := Bounds(First_Todo - 1) - Log_Pitch;<br/>      Last_Prob := Scale_Math.Erf(Cin * Log_Diff);<br/>      for Index in First_Todo .. Farey_Count loop<br/>         Log_Diff := Bounds(Index) - Log_Pitch;<br/>         Cur_Prob := Scale_Math.Erf(Cin * Log_Diff);<br/>         Prob := Cur_Prob - Last_Prob;<br/>         if Prob &gt;= 1.0E-9 then<br/>            Result := Result - Prob * Scale_Math.Log(Prob);<br/>            Started_Adding := True;<br/>         elsif Prob = 0.0 then<br/>            exit when Started_Adding;<br/>         end if;<br/>         Last_Prob := Cur_Prob;<br/>      end loop;<br/>      return Result;<br/>   end Harmonic_Entropy;</p></div><h3><a id=353 href="#353">ðŸ”—</a>Paul H. Erlich &#x3C;PERLICH@...&#x3E;</h3><span>2/1/2001 12:15:58 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Robert:</p><p>I went through a sample calculation before -- check the archives . . .</p></div><h3><a id=354 href="#354">ðŸ”—</a>Paul H. Erlich &#x3C;PERLICH@...&#x3E;</h3><span>2/1/2001 12:17:35 PM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>Hi Manuel:</p><p>I presume you&apos;re aware that I&apos;ve essentially moved completely from the Farey<br/>series to the &quot;Tenney series&quot; approach? The &quot;Tenney series&quot; is defined by a<br/>particular limit on the product of numerator and denominator.</p><p>-Paul</p></div><h3><a id=355 href="#355">ðŸ”—</a>manuel.op.de.coul@...</h3><span>2/5/2001 3:21:08 AM</span><button style="float: right; margin-right: 20px">toggle monospace</button><div style='margin: 0px 20px 20px; padding: 20px; background-color: #eee'><p>&gt;I presume you&apos;re aware that I&apos;ve essentially moved completely from the<br/>Farey<br/>&gt;series to the &quot;Tenney series&quot; approach? The &quot;Tenney series&quot; is defined by<br/>a<br/>&gt;particular limit on the product of numerator and denominator.</p><p>Yes, I agree too it&apos;s better. I&apos;ll change it, it&apos;s only a small change.</p><p>Manuel</p></div>
                <script>
                    let monospace = false
                    $('button').on('click', function () {
                      if (monospace) {
                        $('p').css("font-family", "")
                      } else {
                        $('p').css("font-family", "monospace")
                      }
                      monospace = !monospace
                    })
                </script>
            